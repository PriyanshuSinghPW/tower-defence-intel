var Uo=Object.defineProperty;var di=s=>{throw TypeError(s)};var No=(s,e,t)=>e in s?Uo(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var I=(s,e,t)=>No(s,typeof e!="symbol"?e+"":e,t),js=(s,e,t)=>e.has(s)||di("Cannot "+t);var r=(s,e,t)=>(js(s,e,"read from private field"),t?t.call(s):e.get(s)),c=(s,e,t)=>e.has(s)?di("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(s):e.set(s,t),Is=(s,e,t,i)=>(js(s,e,"write to private field"),i?i.call(s,t):e.set(s,t),t),hi=(s,e,t)=>(js(s,e,"access private method"),t);import{a as S,t as $,c as ie,n as Qs}from"../chunks/disclose-version.EAIaZf74.js";import{h as z,i as go,as as qo,at as Vo,au as Oo,G as Ys,ad as vo,U as Es,x as ce,a5 as Zo,y as ss,v as po,af as Go,z as zo,F as Qo,R as fo,aa as Yo,ab as ui,K as $s,N as Wo,C as wo,av as is,ac as Co,q as os,Y as Xo,a3 as mi,aw as Ws,ax as gi,ay as Jo,Q as Ko,az as er,aA as yo,aB as Xs,aC as tr,J as sr,o as ir,aD as To,D as bo,aE as or,a9 as xo,aF as me,a8 as rr,aG as ar,aH as nr,aI as lr,aJ as cr,ae as _o,b as Fo,aK as dr,aL as hr,A as vi,B as pi,aM as ur,aN as mr,$ as m,g as o,V as g,f as F,p as Z,a as Ss,t as R,l as G,m as A,n as _,k as Y,s as D,Z as Js,aO as Ao,aP as gr,aQ as vr,aR as pr}from"../chunks/index-client.C45Vwlhq.js";import{a as fr,l as wr,w as Cr,e as Ds,r as Bo,d as Ks,s as oe,b as yr}from"../chunks/render.DlnzOeuw.js";import{a as f,p as we,b as Mo,i as X,c as Tr}from"../chunks/props.I1FjIH6p.js";import"../chunks/legacy.Cbs8exOS.js";import{s as br}from"../chunks/slot.DpSFy6J-.js";function qs(s,e,t){z&&go();var i=s,a=Zo,n,l=qo()?Vo:Oo;Ys(()=>{l(a,a=e())&&(n&&vo(n),n=Es(()=>t(i)))}),z&&(i=ce)}function ue(s,e){z&&ss(po(s)),Go(()=>{var t=e();for(var i in t){var a=t[i];a?s.style.setProperty(i,a):s.style.removeProperty(i)}}),zo(()=>{s.remove()})}function ei(s,e){return e}function xr(s,e,t,i){for(var a=[],n=e.length,l=0;l<n;l++)Jo(e[l].e,a,!0);var d=n>0&&a.length===0&&t!==null;if(d){var v=t.parentNode;Ko(v),v.append(t),i.clear(),ae(s,e[0].prev,e[n-1].next)}er(a,()=>{for(var y=0;y<n;y++){var h=e[y];d||(i.delete(h.k),ae(s,h.prev,h.next)),yo(h.e,!d)}})}function te(s,e,t,i,a,n=null){var l=s,d={flags:e,items:new Map,first:null},v=(e&To)!==0;if(v){var y=s;l=z?ss(po(y)):y.appendChild(ir())}z&&go();var h=null,w=!1;Ys(()=>{var C=t(),u=Qo(C)?C:C==null?[]:fo(C),x=u.length;if(w&&x===0)return;w=x===0;let p=!1;if(z){var B=l.data===Yo;B!==(x===0)&&(l=ui(),ss(l),$s(!1),p=!0)}if(z){for(var b=null,T,L=0;L<x;L++){if(ce.nodeType===8&&ce.data===Wo){l=ce,p=!0,$s(!1);break}var j=u[L],M=i(j,L);T=Eo(ce,d,b,null,j,M,L,a,e),d.items.set(M,T),b=T}x>0&&ss(ui())}if(!z){var k=wo;_r(u,d,l,a,e,(k.f&is)!==0,i)}n!==null&&(x===0?h?Co(h):h=Es(()=>n(l)):h!==null&&vo(h,()=>{h=null})),p&&$s(!0),t()}),z&&(l=ce)}function _r(s,e,t,i,a,n,l,d){var ri,ai,ni,li;var v=(a&or)!==0,y=(a&(Xs|Ws))!==0,h=s.length,w=e.items,C=e.first,u=C,x,p=null,B,b=[],T=[],L,j,M,k;if(v)for(k=0;k<h;k+=1)L=s[k],j=l(L,k),M=w.get(j),M!==void 0&&((ri=M.a)==null||ri.measure(),(B??(B=new Set)).add(M));for(k=0;k<h;k+=1){if(L=s[k],j=l(L,k),M=w.get(j),M===void 0){var V=u?u.e.nodes_start:t;p=Eo(V,e,p,p===null?e.first:p.next,L,j,k,i,a),w.set(j,p),b=[],T=[],u=p.next;continue}if(y&&Fr(M,L,k,a),M.e.f&is&&(Co(M.e),v&&((ai=M.a)==null||ai.unfix(),(B??(B=new Set)).delete(M))),M!==u){if(x!==void 0&&x.has(M)){if(b.length<T.length){var q=T[0],N;p=q.prev;var Ls=b[0],ks=b[b.length-1];for(N=0;N<b.length;N+=1)fi(b[N],q,t);for(N=0;N<T.length;N+=1)x.delete(T[N]);ae(e,Ls.prev,ks.next),ae(e,p,Ls),ae(e,ks,q),u=q,p=ks,k-=1,b=[],T=[]}else x.delete(M),fi(M,u,t),ae(e,M.prev,M.next),ae(e,M,p===null?e.first:p.next),ae(e,p,M),p=M;continue}for(b=[],T=[];u!==null&&u.k!==j;)(n||!(u.e.f&is))&&(x??(x=new Set)).add(u),T.push(u),u=u.next;if(u===null)continue;M=u}b.push(M),p=M,u=M.next}if(u!==null||x!==void 0){for(var Ce=x===void 0?[]:fo(x);u!==null;)(n||!(u.e.f&is))&&Ce.push(u),u=u.next;var Ps=Ce.length;if(Ps>0){var Ro=a&To&&h===0?t:null;if(v){for(k=0;k<Ps;k+=1)(ni=Ce[k].a)==null||ni.measure();for(k=0;k<Ps;k+=1)(li=Ce[k].a)==null||li.fix()}xr(e,Ce,Ro,w)}}v&&bo(()=>{var ci;if(B!==void 0)for(M of B)(ci=M.a)==null||ci.apply()}),os.first=e.first&&e.first.e,os.last=p&&p.e}function Fr(s,e,t,i){i&Xs&&gi(s.v,e),i&Ws?gi(s.i,t):s.i=t}function Eo(s,e,t,i,a,n,l,d,v,y){var h=(v&Xs)!==0,w=(v&tr)===0,C=h?w?Xo(a):mi(a):a,u=v&Ws?mi(l):l,x={i:u,v:C,k:n,a:null,e:null,prev:t,next:i};try{return x.e=Es(()=>d(s,C,u),z),x.e.prev=t&&t.e,x.e.next=i&&i.e,t===null?e.first=x:(t.next=x,t.e.next=x.e),i!==null&&(i.prev=x,i.e.prev=x.e),x}finally{}}function fi(s,e,t){for(var i=s.next?s.next.e.nodes_start:t,a=e?e.e.nodes_start:t,n=s.e.nodes_start;n!==i;){var l=sr(n);a.before(n),n=l}}function ae(s,e,t){e===null?s.first=t:(e.next=t,e.e.next=t&&t.e),t!==null&&(t.prev=e,t.e.prev=e&&e.e)}function Ar(s,e,...t){var i=s,a=me,n;Ys(()=>{a!==(a=e())&&(n&&(yo(n),n=null),n=Es(()=>a(i,...t)))},xo),z&&(i=ce)}function de(s,e,t,i){var a=s.__attributes??(s.__attributes={});z&&(a[e]=s.getAttribute(e),e==="src"||e==="srcset"||e==="href"&&s.nodeName==="LINK")||a[e]!==(a[e]=t)&&(e==="style"&&"__styles"in s&&(s.__styles={}),e==="loading"&&(s[ar]=t),t==null?s.removeAttribute(e):typeof t!="string"&&Br(s).includes(e)?s[e]=t:s.setAttribute(e,t))}var wi=new Map;function Br(s){var e=wi.get(s.nodeName);if(e)return e;wi.set(s.nodeName,e=[]);for(var t,i=s,a=Element.prototype;a!==i;){t=nr(i);for(var n in t)t[n].set&&e.push(n);i=rr(i)}return e}function Mr(s,e,t){var i=s.__className,a=Er(e);z&&s.className===a?s.__className=a:(i!==a||z&&s.className!==a)&&(e==null?s.removeAttribute("class"):s.className=a,s.__className=a)}function Er(s,e){return(s??"")+""}function ve(s,e,t){if(t){if(s.classList.contains(e))return;s.classList.add(e)}else{if(!s.classList.contains(e))return;s.classList.remove(e)}}function U(s,e,t,i){var a=s.__styles??(s.__styles={});a[e]!==t&&(a[e]=t,t==null?s.style.removeProperty(e):s.style.setProperty(e,t,""))}const Sr=()=>performance.now(),se={tick:s=>requestAnimationFrame(s),now:()=>Sr(),tasks:new Set};function So(){const s=se.now();se.tasks.forEach(e=>{e.c(s)||(se.tasks.delete(e),e.f())}),se.tasks.size!==0&&se.tick(So)}function Dr(s){let e;return se.tasks.size===0&&se.tick(So),{promise:new Promise(t=>{se.tasks.add(e={c:s,f:t})}),abort(){se.tasks.delete(e)}}}function Xt(s,e){s.dispatchEvent(new CustomEvent(e))}function Lr(s){if(s==="float")return"cssFloat";if(s==="offset")return"cssOffset";if(s.startsWith("--"))return s;const e=s.split("-");return e.length===1?e[0]:e[0]+e.slice(1).map(t=>t[0].toUpperCase()+t.slice(1)).join("")}function Ci(s){const e={},t=s.split(";");for(const i of t){const[a,n]=i.split(":");if(!a||n===void 0)break;const l=Lr(a.trim());e[l]=n.trim()}return e}const kr=s=>s;function K(s,e,t,i){var a=(s&ur)!==0,n=(s&mr)!==0,l=a&&n,d=(s&dr)!==0,v=l?"both":a?"in":"out",y,h=e.inert,w,C;function u(){var T=wo,L=os;vi(null),pi(null);try{return y??(y=t()(e,(i==null?void 0:i())??{},{direction:v}))}finally{vi(T),pi(L)}}var x={is_global:d,in(){var T;if(e.inert=h,!a){C==null||C.abort(),(T=C==null?void 0:C.reset)==null||T.call(C);return}n||w==null||w.abort(),Xt(e,"introstart"),w=Vs(e,u(),C,1,()=>{Xt(e,"introend"),w==null||w.abort(),w=y=void 0})},out(T){if(!n){T==null||T(),y=void 0;return}e.inert=!0,Xt(e,"outrostart"),C=Vs(e,u(),w,0,()=>{Xt(e,"outroend"),T==null||T()})},stop:()=>{w==null||w.abort(),C==null||C.abort()}},p=os;if((p.transitions??(p.transitions=[])).push(x),a&&fr){var B=d;if(!B){for(var b=p.parent;b&&b.f&xo;)for(;(b=b.parent)&&!(b.f&lr););B=!b||(b.f&cr)!==0}B&&_o(()=>{Fo(()=>x.in())})}}function Vs(s,e,t,i,a){var n=i===1;if(hr(e)){var l,d=!1;return bo(()=>{if(!d){var B=e({direction:n?"in":"out"});l=Vs(s,B,t,i,a)}}),{abort:()=>{d=!0,l==null||l.abort()},deactivate:()=>l.deactivate(),reset:()=>l.reset(),t:()=>l.t()}}if(t==null||t.deactivate(),!(e!=null&&e.duration))return a(),{abort:me,deactivate:me,reset:me,t:()=>i};const{delay:v=0,css:y,tick:h,easing:w=kr}=e;var C=[];if(n&&t===void 0&&(h&&h(0,1),y)){var u=Ci(y(0,1));C.push(u,u)}var x=()=>1-i,p=s.animate(C,{duration:v});return p.onfinish=()=>{var B=(t==null?void 0:t.t())??1-i;t==null||t.abort();var b=i-B,T=e.duration*Math.abs(b),L=[];if(T>0){if(y)for(var j=Math.ceil(T/16.666666666666668),M=0;M<=j;M+=1){var k=B+b*w(M/j),V=y(k,1-k);L.push(Ci(V))}x=()=>{var q=p.currentTime;return B+b*w(q/T)},h&&Dr(()=>{if(p.playState!=="running")return!1;var q=x();return h(q,1-q),!0})}p=s.animate(L,{duration:T,fill:"forwards"}),p.onfinish=()=>{x=()=>i,h==null||h(i,1-i),a()}},{abort:()=>{p&&(p.cancel(),p.effect=null,p.onfinish=me)},deactivate:()=>{a=me},reset:()=>{i===0&&(h==null||h(1,0))},t:()=>x()}}var ne,fe,xe,rs,Do;const as=class as{constructor(e){c(this,rs);c(this,ne,new WeakMap);c(this,fe);c(this,xe);Is(this,xe,e)}observe(e,t){var i=r(this,ne).get(e)||new Set;return i.add(t),r(this,ne).set(e,i),hi(this,rs,Do).call(this).observe(e,r(this,xe)),()=>{var a=r(this,ne).get(e);a.delete(t),a.size===0&&(r(this,ne).delete(e),r(this,fe).unobserve(e))}}};ne=new WeakMap,fe=new WeakMap,xe=new WeakMap,rs=new WeakSet,Do=function(){return r(this,fe)??Is(this,fe,new ResizeObserver(e=>{for(var t of e){as.entries.set(t.target,t);for(var i of r(this,ne).get(t.target)||[])i(t)}}))},I(as,"entries",new WeakMap);let Os=as;var Pr=new Os({box:"border-box"});function yi(s,e,t){var i=Pr.observe(s,()=>t(s[e]));_o(()=>(Fo(()=>t(s[e])),i))}function Ti(s,e){wr(window,["resize"],()=>Cr(()=>e(window[s])))}var _e;class jr{constructor(){c(this,_e,m(f({})));I(this,"setup",e=>{this.managers=e});I(this,"update",e=>{this.managers.stageManager.update(e),this.managers.entityManager.update(e),this.managers.collisionManager.update(),this.managers.questionManager&&this.managers.questionManager.update(e),this.managers.particleManager&&this.managers.particleManager.update(e)});I(this,"get",e=>typeof e=="string"?this.managers[e]:e.reduce((t,i)=>(t[i]=this.managers[i],t),{}))}get managers(){return o(r(this,_e))}set managers(e){g(r(this,_e),f(e))}}_e=new WeakMap;const E=new jr,bi=["/enemies/BlueBlobElite/Die/0.svg","/enemies/BlueBlobElite/Die/1.svg","/enemies/BlueBlobElite/Die/2.svg"],Ir={name:"BlueBlobEliteDie",frames:bi,framesAmount:bi.length,frameRate:10,loop:!1},xi=["/enemies/BlueBlobElite/Follow/0.svg","/enemies/BlueBlobElite/Follow/1.svg","/enemies/BlueBlobElite/Follow/2.svg","/enemies/BlueBlobElite/Follow/3.svg"],$r={name:"BlueBlobEliteFollow",frames:xi,framesAmount:xi.length,frameRate:10,loop:!0},_i=["/enemies/BlueCircleElite/Die/0.svg","/enemies/BlueCircleElite/Die/1.svg","/enemies/BlueCircleElite/Die/2.svg"],Hr={name:"BlueCircleEliteDie",frames:_i,framesAmount:_i.length,frameRate:10,loop:!1},Fi=["/enemies/BlueCircleElite/Follow/0.svg","/enemies/BlueCircleElite/Follow/1.svg","/enemies/BlueCircleElite/Follow/2.svg","/enemies/BlueCircleElite/Follow/3.svg"],Rr={name:"BlueCircleEliteFollow",frames:Fi,framesAmount:Fi.length,frameRate:10,loop:!0},Ai=["/enemies/GreenCircleElite/Die/0.svg","/enemies/GreenCircleElite/Die/1.svg","/enemies/GreenCircleElite/Die/2.svg"],Ur={name:"GreenCircleEliteDie",frames:Ai,framesAmount:Ai.length,frameRate:10,loop:!1},Bi=["/enemies/GreenCircleElite/Follow/0.svg","/enemies/GreenCircleElite/Follow/1.svg","/enemies/GreenCircleElite/Follow/2.svg","/enemies/GreenCircleElite/Follow/3.svg"],Nr={name:"GreenCircleEliteFollow",frames:Bi,framesAmount:Bi.length,frameRate:10,loop:!0},Mi=["/enemies/RedBlobElite/Die/0.svg","/enemies/RedBlobElite/Die/1.svg","/enemies/RedBlobElite/Die/2.svg"],qr={name:"RedBlobEliteDie",frames:Mi,framesAmount:Mi.length,frameRate:10,loop:!1},Ei=["/enemies/RedBlobElite/Follow/0.svg","/enemies/RedBlobElite/Follow/1.svg","/enemies/RedBlobElite/Follow/2.svg","/enemies/RedBlobElite/Follow/3.svg"],Vr={name:"RedBlobEliteFollow",frames:Ei,framesAmount:Ei.length,frameRate:10,loop:!0},Si=["/enemies/BlueCommon/Die/0.svg","/enemies/BlueCommon/Die/1.svg","/enemies/BlueCommon/Die/2.svg"],Or={name:"BlueCommonDie",frames:Si,framesAmount:Si.length,frameRate:10,loop:!1},Di=["/enemies/BlueCommon/Follow/0.svg","/enemies/BlueCommon/Follow/1.svg","/enemies/BlueCommon/Follow/2.svg"],Zr={name:"BlueCommonFollow",frames:Di,framesAmount:Di.length,frameRate:10,loop:!0},Li=["/enemies/PurpleCommon/Die/0.svg","/enemies/PurpleCommon/Die/1.svg","/enemies/PurpleCommon/Die/2.svg"],Gr={name:"PurpleCommonDie",frames:Li,framesAmount:Li.length,frameRate:10,loop:!1},ki=["/enemies/PurpleCommon/Follow/0.svg","/enemies/PurpleCommon/Follow/1.svg","/enemies/PurpleCommon/Follow/2.svg"],zr={name:"PurpleCommonFollow",frames:ki,framesAmount:ki.length,frameRate:10,loop:!0},Pi=["/enemies/YellowCommon/Die/0.svg","/enemies/YellowCommon/Die/1.svg","/enemies/YellowCommon/Die/2.svg"],Qr={name:"YellowCommonDie",frames:Pi,framesAmount:Pi.length,frameRate:10,loop:!1},ji=["/enemies/YellowCommon/Follow/0.svg","/enemies/YellowCommon/Follow/1.svg","/enemies/YellowCommon/Follow/2.svg","/enemies/YellowCommon/Follow/3.svg"],Yr={name:"YellowCommonFollow",frames:ji,framesAmount:ji.length,frameRate:10,loop:!0},Wr=Object.freeze(Object.defineProperty({__proto__:null,BlueBlobEliteDie:Ir,BlueBlobEliteFollow:$r,BlueCircleEliteDie:Hr,BlueCircleEliteFollow:Rr,BlueCommonDie:Or,BlueCommonFollow:Zr,GreenCircleEliteDie:Ur,GreenCircleEliteFollow:Nr,PurpleCommonDie:Gr,PurpleCommonFollow:zr,RedBlobEliteDie:qr,RedBlobEliteFollow:Vr,YellowCommonDie:Qr,YellowCommonFollow:Yr},Symbol.toStringTag,{value:"Module"})),Xr=["/towers/Base.svg"],Jr={name:"TowerBase",frames:Xr,framesAmount:1,frameRate:0,loop:!0},Kr=["/towers/FireTower/Base0.svg"],ea={name:"FireTowerBase0",frames:Kr,framesAmount:1,frameRate:0,loop:!0},ta=["/towers/FireTower/Base1.svg"],sa={name:"FireTowerBase1",frames:ta,framesAmount:1,frameRate:0,loop:!0},ia=["/towers/FireTower/Base2.svg"],oa={name:"FireTowerBase2",frames:ia,framesAmount:1,frameRate:0,loop:!0},Ii=["/towers/Base.svg","/towers/Upgrade0.svg","/towers/FireTower/Base0.svg"],ra={name:"FireTowerUpgrade0",frames:Ii,framesAmount:Ii.length,frameRate:10,loop:!1},$i=["/towers/FireTower/Base0.svg","/towers/FireTower/Upgrade1.svg","/towers/FireTower/Base1.svg"],aa={name:"FireTowerUpgrade1",frames:$i,framesAmount:$i.length,frameRate:10,loop:!1},Hi=["/towers/FireTower/Base1.svg","/towers/FireTower/Upgrade2.svg","/towers/FireTower/Base2.svg"],na={name:"FireTowerUpgrade2",frames:Hi,framesAmount:Hi.length,frameRate:10,loop:!1},la=["/towers/IceTower/Base0.svg"],ca={name:"IceTowerBase0",frames:la,framesAmount:1,frameRate:0,loop:!0},da=["/towers/IceTower/Base1.svg"],ha={name:"IceTowerBase1",frames:da,framesAmount:1,frameRate:0,loop:!0},ua=["/towers/IceTower/Base2.svg"],ma={name:"IceTowerBase2",frames:ua,framesAmount:1,frameRate:0,loop:!0},Ri=["/towers/Base.svg","/towers/Upgrade0.svg","/towers/IceTower/Base0.svg"],ga={name:"IceTowerUpgrade0",frames:Ri,framesAmount:Ri.length,frameRate:10,loop:!1},Ui=["/towers/IceTower/Base0.svg","/towers/IceTower/Upgrade1.svg","/towers/IceTower/Base1.svg"],va={name:"IceTowerUpgrade1",frames:Ui,framesAmount:Ui.length,frameRate:10,loop:!1},Ni=["/towers/IceTower/Base1.svg","/towers/IceTower/Upgrade2.svg","/towers/IceTower/Base2.svg"],pa={name:"IceTowerUpgrade2",frames:Ni,framesAmount:Ni.length,frameRate:10,loop:!1},fa=["/towers/PoisonTower/Base0.svg"],wa={name:"PoisonTowerBase0",frames:fa,framesAmount:1,frameRate:0,loop:!0},Ca=["/towers/PoisonTower/Base1.svg"],ya={name:"PoisonTowerBase1",frames:Ca,framesAmount:1,frameRate:0,loop:!0},Ta=["/towers/PoisonTower/Base2.svg"],ba={name:"PoisonTowerBase2",frames:Ta,framesAmount:1,frameRate:0,loop:!0},qi=["/towers/Base.svg","/towers/Upgrade0.svg","/towers/PoisonTower/Base0.svg"],xa={name:"PoisonTowerUpgrade0",frames:qi,framesAmount:qi.length,frameRate:10,loop:!1},Vi=["/towers/PoisonTower/Base0.svg","/towers/PoisonTower/Upgrade1.svg","/towers/PoisonTower/Base1.svg"],_a={name:"PoisonTowerUpgrade1",frames:Vi,framesAmount:Vi.length,frameRate:10,loop:!1},Oi=["/towers/PoisonTower/Base1.svg","/towers/PoisonTower/Upgrade2.svg","/towers/PoisonTower/Base2.svg"],Fa={name:"PoisonTowerUpgrade2",frames:Oi,framesAmount:Oi.length,frameRate:10,loop:!1},Aa=["/towers/ThunderTower/Base0.svg"],Ba={name:"ThunderTowerBase0",frames:Aa,framesAmount:1,frameRate:0,loop:!0},Ma=["/towers/ThunderTower/Base1.svg"],Ea={name:"ThunderTowerBase1",frames:Ma,framesAmount:1,frameRate:0,loop:!0},Sa=["/towers/ThunderTower/Base2.svg"],Da={name:"ThunderTowerBase2",frames:Sa,framesAmount:1,frameRate:0,loop:!0},Zi=["/towers/Base.svg","/towers/Upgrade0.svg","/towers/ThunderTower/Base0.svg"],La={name:"ThunderTowerUpgrade0",frames:Zi,framesAmount:Zi.length,frameRate:10,loop:!1},Gi=["/towers/ThunderTower/Base0.svg","/towers/ThunderTower/Upgrade1.svg","/towers/ThunderTower/Base1.svg"],ka={name:"ThunderTowerUpgrade1",frames:Gi,framesAmount:Gi.length,frameRate:10,loop:!1},zi=["/towers/ThunderTower/Base1.svg","/towers/ThunderTower/Upgrade2.svg","/towers/ThunderTower/Base2.svg"],Pa={name:"ThunderTowerUpgrade2",frames:zi,framesAmount:zi.length,frameRate:10,loop:!1},ja=Object.freeze(Object.defineProperty({__proto__:null,FireTowerBase0:ea,FireTowerBase1:sa,FireTowerBase2:oa,FireTowerUpgrade0:ra,FireTowerUpgrade1:aa,FireTowerUpgrade2:na,IceTowerBase0:ca,IceTowerBase1:ha,IceTowerBase2:ma,IceTowerUpgrade0:ga,IceTowerUpgrade1:va,IceTowerUpgrade2:pa,PoisonTowerBase0:wa,PoisonTowerBase1:ya,PoisonTowerBase2:ba,PoisonTowerUpgrade0:xa,PoisonTowerUpgrade1:_a,PoisonTowerUpgrade2:Fa,ThunderTowerBase0:Ba,ThunderTowerBase1:Ea,ThunderTowerBase2:Da,ThunderTowerUpgrade0:La,ThunderTowerUpgrade1:ka,ThunderTowerUpgrade2:Pa,TowerBase:Jr},Symbol.toStringTag,{value:"Module"})),Qi=["/projectiles/Fireball/Die/0.svg","/projectiles/Fireball/Die/1.svg","/projectiles/Fireball/Die/2.svg"],Ia={name:"FireballDie",frames:Qi,framesAmount:Qi.length,frameRate:10,loop:!1},Yi=["/projectiles/Fireball/Follow/0.svg","/projectiles/Fireball/Follow/1.svg","/projectiles/Fireball/Follow/2.svg","/projectiles/Fireball/Follow/3.svg"],$a={name:"FireballFollow",frames:Yi,framesAmount:Yi.length,frameRate:10,loop:!0},Wi=["/projectiles/Icebolt/Die/0.svg","/projectiles/Icebolt/Die/1.svg","/projectiles/Icebolt/Die/2.svg"],Ha={name:"IceboltDie",frames:Wi,framesAmount:Wi.length,frameRate:10,loop:!1},Xi=["/projectiles/Icebolt/Follow/0.svg","/projectiles/Icebolt/Follow/1.svg"],Ra={name:"IceboltFollow",frames:Xi,framesAmount:Xi.length,frameRate:10,loop:!0},Ji=["/projectiles/Poisonball/Die/0.svg","/projectiles/Poisonball/Die/1.svg","/projectiles/Poisonball/Die/2.svg"],Ua={name:"PoisonballDie",frames:Ji,framesAmount:Ji.length,frameRate:10,loop:!1},Ki=["/projectiles/Poisonball/Follow/0.svg","/projectiles/Poisonball/Follow/1.svg","/projectiles/Poisonball/Follow/2.svg","/projectiles/Poisonball/Follow/3.svg"],Na={name:"PoisonballFollow",frames:Ki,framesAmount:Ki.length,frameRate:10,loop:!0},eo=["/projectiles/Thunderbolt/Die/0.svg","/projectiles/Thunderbolt/Die/1.svg","/projectiles/Thunderbolt/Die/2.svg"],qa={name:"ThunderboltDie",frames:eo,framesAmount:eo.length,frameRate:10,loop:!1},to=["/projectiles/Thunderbolt/Follow/0.svg","/projectiles/Thunderbolt/Follow/1.svg","/projectiles/Thunderbolt/Follow/2.svg","/projectiles/Thunderbolt/Follow/3.svg"],Va={name:"ThunderboltFollow",frames:to,framesAmount:to.length,frameRate:10,loop:!0},so=["/projectiles/Click/0.svg","/projectiles/Click/1.svg","/projectiles/Click/2.svg","/projectiles/Click/3.svg"],Oa={name:"Click",frames:so,framesAmount:so.length,frameRate:10,loop:!1},Za=Object.freeze(Object.defineProperty({__proto__:null,Click:Oa,FireballDie:Ia,FireballFollow:$a,IceboltDie:Ha,IceboltFollow:Ra,PoisonballDie:Ua,PoisonballFollow:Na,ThunderboltDie:qa,ThunderboltFollow:Va},Symbol.toStringTag,{value:"Module"})),io=["/cursors/build0.svg","/cursors/build1.svg","/cursors/build2.svg"],Ga={name:"TowerBuildCursor",frames:io,framesAmount:io.length,frameRate:7,loop:!1},za=Object.freeze(Object.defineProperty({__proto__:null,TowerBuildCursor:Ga},Symbol.toStringTag,{value:"Module"})),Qa=["/throne.svg"],Ya={name:"Throne",frames:Qa,framesAmount:1,frameRate:0,loop:!0},Wa=["/loot.svg"],Xa={name:"Loot",frames:Wa,framesAmount:1,frameRate:0,loop:!0},oo={Throne:Ya,Loot:Xa,...Wr,...ja,...Za,...za},Te=s=>{if(!oo[s])throw new Error(`Animation config not found for: ${s}`);return oo[s]};var Fe,Ae,Be,Me,Ee,ns,Se;class Lo{constructor({name:e,framesAmount:t,frameRate:i,loop:a=!1}){I(this,"name");c(this,Fe,m(0));c(this,Ae,m(0));c(this,Be,m(!1));c(this,Me,m(0));c(this,Ee,m(0));c(this,ns,F(()=>this.getIsAnimationComplete()));c(this,Se,m(()=>{}));this.name=e,this.framesAmount=t,this.frameRate=i,this.loop=a}get framesAmount(){return o(r(this,Fe))}set framesAmount(e){g(r(this,Fe),f(e))}get frameRate(){return o(r(this,Ae))}set frameRate(e){g(r(this,Ae),f(e))}get loop(){return o(r(this,Be))}set loop(e){g(r(this,Be),f(e))}get currentFrame(){return o(r(this,Me))}set currentFrame(e){g(r(this,Me),f(e))}get currentFrameTime(){return o(r(this,Ee))}set currentFrameTime(e){g(r(this,Ee),f(e))}get isComplete(){return o(r(this,ns))}get onFrameChange(){return o(r(this,Se))}set onFrameChange(e){g(r(this,Se),f(e))}update(e){this.frameRate!==0&&(this.currentFrameTime+=e,this.currentFrameTime>=1e3/this.frameRate&&(this.currentFrameTime=0,this.nextFrame()))}nextFrame(){this.onFrameChange(this.currentFrame),this.currentFrame>=this.framesAmount-1?this.loop?this.currentFrame=0:this.currentFrame=this.framesAmount-1:this.currentFrame+=1}getIsAnimationComplete(){return this.loop?!1:this.currentFrame===this.framesAmount-1}}Fe=new WeakMap,Ae=new WeakMap,Be=new WeakMap,Me=new WeakMap,Ee=new WeakMap,ns=new WeakMap,Se=new WeakMap;const ro={arrow:"/cursors/cursor-arrow.svg",hammer:"/cursors/cursor-hammer.svg"};var De,ls,cs,ds,hs;class Ja{constructor(){c(this,De,m());c(this,ls,F(()=>`url(${ro.arrow}), auto`));c(this,cs,F(()=>`url(${ro.hammer}), auto`));c(this,ds,F(()=>this.animation&&!this.animation.isComplete));c(this,hs,F(()=>this.getCurrentFrame()))}get animation(){return o(r(this,De))}set animation(e){g(r(this,De),f(e))}get arrow(){return o(r(this,ls))}get hammer(){return o(r(this,cs))}get inAnimation(){return o(r(this,ds))}get currentFrame(){return o(r(this,hs))}update(e){this.inAnimation&&this.animation.update(e)}get(e){return this.inAnimation?this.currentFrame:this[e]}setAnimation(e){if(!e){this.animation=null;return}const t=Te(e);this.animation=new Lo({...t})}getCurrentFrame(){const{frames:e}=Te(this.animation.name);return`url(${e[this.animation.currentFrame]}), auto`}}De=new WeakMap,ls=new WeakMap,cs=new WeakMap,ds=new WeakMap,hs=new WeakMap;const O=new Ja;var Le,ke,Pe,je,Ie,$e,us;class Ka{constructor(){c(this,Le,m(0));c(this,ke,m(0));c(this,Pe,m(0));c(this,je,m(0));c(this,Ie,m(0));c(this,$e,m(0));c(this,us,F(()=>this.width<768))}get width(){return o(r(this,Le))}set width(e){g(r(this,Le),f(e))}get height(){return o(r(this,ke))}set height(e){g(r(this,ke),f(e))}get gameAreaWidth(){return o(r(this,Pe))}set gameAreaWidth(e){g(r(this,Pe),f(e))}get gameAreaHeight(){return o(r(this,je))}set gameAreaHeight(e){g(r(this,je),f(e))}get gameXOffset(){return o(r(this,Ie))}set gameXOffset(e){g(r(this,Ie),f(e))}get gameYOffset(){return o(r(this,$e))}set gameYOffset(e){g(r(this,$e),f(e))}get isMobile(){return o(r(this,us))}get screenBounds(){return{x1:0,y1:0,x2:this.width,y2:this.height}}get gameBoundingBox(){return{x1:this.gameXOffset,y1:this.gameYOffset,x2:this.width,y2:this.height}}isEntityInScreen(e){const{x1:t,y1:i,x2:a,y2:n}=this.screenBounds,{x:l,y:d}=e.position;return l+e.width/2>t&&l-e.width/2<a&&d+e.height>i&&d-e.height<n}}Le=new WeakMap,ke=new WeakMap,Pe=new WeakMap,je=new WeakMap,Ie=new WeakMap,$e=new WeakMap,us=new WeakMap;const P=new Ka;var en=$('<img alt="Enemy animation" class="svelte-94zyf5">');function Hs(s,e){Z(e,!0);let t=we(e,"entity",7),i=m(void 0),a=F(()=>Te(t().animation.name)),n=F(()=>o(a).frames[t().animation.currentFrame]),l=m(!1);function d(){g(l,!0)}const v=F(()=>P.isMobile?t().scale-.2:t().scale),y=F(()=>t().position.x),h=F(()=>t().position.y),w=F(()=>`translate(${o(y)}px, ${o(h)}px) rotate(${t().rotation}deg) scale(${o(v)})`);Ss(()=>{if(!o(i)||!o(l))return;let x=o(i).getBoundingClientRect();t().width=x.width,t().height=x.height});var C=en();const u=F(()=>O.get("arrow"));Mo(C,x=>g(i,x),()=>o(i)),R(()=>{de(C,"src",o(n)),U(C,"left","0px"),U(C,"top","0px"),U(C,"transform",o(w)),U(C,"cursor",o(u))}),Ds("load",C,d),Bo(C),S(s,C),G()}var He,Re;const ee=class ee{constructor(e=0,t=0){c(this,He,m(0));c(this,Re,m(0));this.x=e,this.y=t}get x(){return o(r(this,He))}set x(e){g(r(this,He),f(e))}get y(){return o(r(this,Re))}set y(e){g(r(this,Re),f(e))}clone(){return new ee(this.x,this.y)}isEqual(e){return this.x===e.x&&this.y===e.y}add(e){return new ee(this.x+e.x,this.y+e.y)}subtract(e){return new ee(this.x-e.x,this.y-e.y)}multiply(e){return new ee(this.x*e,this.y*e)}magnitude(){return Math.sqrt(this.x*this.x+this.y*this.y)}normalize(){const e=this.magnitude();return e?new ee(this.x/e,this.y/e):new ee}distance(e){return this.subtract(e).magnitude()}dot(e){return this.x*e.x+this.y*e.y}rotate(e){const t=Math.cos(e),i=Math.sin(e);return new ee(this.x*t-this.y*i,this.x*i+this.y*t)}};He=new WeakMap,Re=new WeakMap;let Q=ee;var tn=$('<img alt="Enemy animation" class="svelte-usgp6v">');function Rs(s,e){Z(e,!0);let t=we(e,"entity",7),i=m(void 0),a=F(()=>Te(t().animation.name)),n=F(()=>o(a).frames[t().animation.currentFrame]),l=m(!1);function d(){g(l,!0)}const v=F(()=>P.isMobile?t().scale-.2:t().scale),y=F(()=>`scale(${o(v)})`);Ss(()=>{var u;if(!o(i)||!o(l))return;let w=o(i).getBoundingClientRect();const C=((u=o(i).offsetParent)==null?void 0:u.getBoundingClientRect())??{x:0,y:0};t().position=new Q(w.x-C.x,w.y-C.y),t().width=w.width,t().height=w.height,console.log("entity.position",o(n),t().width,t().height,P.width)});var h=tn();h.__click=function(...w){var C;(C=e.onclick)==null||C.apply(this,w)},Mo(h,w=>g(i,w),()=>o(i)),R(()=>{de(h,"src",o(n)),U(h,"transform",o(y))}),Ds("load",h,d),Bo(h),S(s,h),G()}Ks(["click"]);var sn=$('<div class="particle svelte-17cbyeb"></div>'),on=$('<div class="particle-layer svelte-17cbyeb"><!></div>');function rn(s,e){Z(e,!0);const t=F(()=>E.get("particleManager"));var i=on(),a=A(i);{var n=l=>{var d=ie(),v=Y(d);te(v,16,()=>o(t).particles,y=>y,(y,h)=>{var w=sn();R(()=>{U(w,"left",`${h.x??""}px`),U(w,"top",`${h.y??""}px`),U(w,"width",`${h.size??""}px`),U(w,"height",`${h.size??""}px`),U(w,"background-color",h.color),U(w,"opacity",h.life)}),S(y,w)}),S(l,d)};X(a,l=>{o(t)&&l(n)})}_(i),S(s,i),G()}function ge(s,e){return s.x1<=e.x2&&s.x2>=e.x1&&s.y1<=e.y2&&s.y2>=e.y1}function ko(s,e){return Math.atan2(e.y-s.y,e.x-s.x)}function ti(s){return new Q(Math.cos(s),Math.sin(s))}const si=(s,e,t)=>({x1:s.x-e/2,y1:s.y-t/2,x2:s.x+e/2,y2:s.y+t/2,center:new Q(s.x,s.y),topMiddle:new Q(s.x+e/2,s.y)}),Us={bgSound:"/sound/bgSound.mp3",effects:{pickUp:"/sound/sfx/pickUp.m4a",towerUpgrade:"/sound/sfx/towerUpgrade.m4a",clickEnemy:"/sound/sfx/clickEnemy.m4a",towerShoot:"/sound/sfx/towerShoot.m4a",clickMenu:"/sound/sfx/clickMenu.m4a",lowResourse:"/sound/sfx/lowResourse.m4a"}},Jt=.3,an=.2;var Ue,Ne,qe,Ve,Oe,Ze,Ge,ze,ms,gs;class nn{constructor(){c(this,Ue,m({}));c(this,Ne,m(!1));c(this,qe,m(0));c(this,Ve,m(null));c(this,Oe,m(null));c(this,Ze,m(null));c(this,Ge,m(!1));c(this,ze,m(0));c(this,ms,F(()=>Object.keys(Us.effects).length+1));c(this,gs,F(()=>Math.min(Math.floor(this.loadedCount/this.totalResources*100),100)));I(this,"preload",async()=>{const e=(t,i)=>new Promise((a,n)=>{const l=new Audio(i),d=()=>{this.sounds[t]=l,this.sounds[t].volume=t==="bgSound"?Jt:an,this.sounds[t].loop=t==="bgSound",this.loadedCount+=1,l.removeEventListener("canplaythrough",d),a()},v=y=>{l.removeEventListener("error",v),n(y)};l.addEventListener("canplaythrough",d),l.addEventListener("error",v),l.load()});try{await e("bgSound",Us.bgSound);const t=Object.entries(Us.effects).map(([i,a])=>e(i,a));await Promise.all(t),this.preloaded=!0,console.log("Sounds preloaded successfully.")}catch(t){throw console.error("Error preloading sounds:",t),t}});I(this,"reduceBgVolume",()=>{this.sounds.bgSound.volume=Jt-.2});I(this,"restoreBgVolume",()=>{this.sounds.bgSound.volume=Jt});I(this,"initAudioContext",()=>{if(this.audioContext)return;const e=window.AudioContext||window.webkitAudioContext;this.audioContext=new e;const t=this.sounds.bgSound;t&&(this.bgNode=this.audioContext.createMediaElementSource(t),this.bgFilter=this.audioContext.createBiquadFilter(),this.bgFilter.type="lowpass",this.bgFilter.frequency.value=22050,this.bgNode.connect(this.bgFilter),this.bgFilter.connect(this.audioContext.destination))});I(this,"play",(e,t=!1)=>{if(this.isMuted)return;const i=this.sounds[e];if(i){if(e==="bgSound"){this.initAudioContext(),this.audioContext.state==="suspended"&&this.audioContext.resume(),i.currentTime=0,i.play();return}if(!(navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome"))&&(t||this.playingEffectsCount<10)){i.currentTime=0,i.play();const a=()=>{this.playingEffectsCount-=1,i.removeEventListener("ended",a)};i.addEventListener("ended",a),this.playingEffectsCount+=1}}})}get sounds(){return o(r(this,Ue))}set sounds(e){g(r(this,Ue),e)}get isMuted(){return o(r(this,Ne))}set isMuted(e){g(r(this,Ne),f(e))}get playingEffectsCount(){return o(r(this,qe))}set playingEffectsCount(e){g(r(this,qe),f(e))}get audioContext(){return o(r(this,Ve))}set audioContext(e){g(r(this,Ve),e)}get bgNode(){return o(r(this,Oe))}set bgNode(e){g(r(this,Oe),e)}get bgFilter(){return o(r(this,Ze))}set bgFilter(e){g(r(this,Ze),e)}get preloaded(){return o(r(this,Ge))}set preloaded(e){g(r(this,Ge),f(e))}get loadedCount(){return o(r(this,ze))}set loadedCount(e){g(r(this,ze),f(e))}get totalResources(){return o(r(this,ms))}get preloadPercent(){return o(r(this,gs))}pause(e){const t=this.sounds[e];t&&t.pause()}toggleMute(){this.isMuted=!this.isMuted,this.isMuted?this.pause("bgSound"):this.play("bgSound")}reset(){if(this.isMuted)return;const e=this.sounds.bgSound;e&&(e.currentTime=0,e.volume=Jt,e.play())}setDistortion(e){if(!this.bgFilter||!this.audioContext)return;const t=this.audioContext.currentTime,i=e?600:22050;this.bgFilter.frequency.cancelScheduledValues(t),this.bgFilter.frequency.exponentialRampToValueAtTime(i,t+.5)}}Ue=new WeakMap,Ne=new WeakMap,qe=new WeakMap,Ve=new WeakMap,Oe=new WeakMap,Ze=new WeakMap,Ge=new WeakMap,ze=new WeakMap,ms=new WeakMap,gs=new WeakMap;const H=new nn,ln={click:5,upgrade:35};var Qe,Ye,We,Xe,Je,Ke;class cn{constructor(){c(this,Qe,m(100));c(this,Ye,m(!1));c(this,We,m(!1));c(this,Xe,m(!1));c(this,Je,m(100));c(this,Ke,m(0))}get collectedLoot(){return o(r(this,Qe))}set collectedLoot(e){g(r(this,Qe),f(e))}get playLowLootAnimation(){return o(r(this,Ye))}set playLowLootAnimation(e){g(r(this,Ye),f(e))}get playTowerUpgradeAnimation(){return o(r(this,We))}set playTowerUpgradeAnimation(e){g(r(this,We),f(e))}get playEnemyClickAnimation(){return o(r(this,Xe))}set playEnemyClickAnimation(e){g(r(this,Xe),f(e))}get score(){return o(r(this,Je))}set score(e){g(r(this,Je),f(e))}get killsEnemy(){return o(r(this,Ke))}set killsEnemy(e){g(r(this,Ke),f(e))}spendLoot(e){const t=ln[e.type];if(e.type==="upgrade"){const{questionManager:i}=E.get(["questionManager"]),{tower:a}=e.payload;if(a.state.currentState.name==="NotBuilt"){i.buildPoints>0?(i.buildPoints--,a.state.setState("Guard"),a.stats.health=a.stats.maxHealth||3):this.playAnimation("LowLoot");return}else{this.collectedLoot>=t?i.buildPoints>0?(this.collectedLoot-=t,i.buildPoints--,a.state.setState("Upgrade"),this.playAnimation("TowerUpgrade"),O.setAnimation("TowerBuildCursor")):this.playAnimation("LowLoot"):this.playAnimation("LowLoot");return}}if(this.collectedLoot<t){this.playAnimation("LowLoot");return}if(e.type==="click"){const{collisionManager:i,stageManager:a}=E.get(["collisionManager","stageManager"]),{offset:n}=e.payload,l=si(n,60,60),d=i.filterEnemiesByBounds(l);a.spawnEntity("ClickExplode",n),H.play("clickEnemy",!0),d.forEach(v=>{v.state.setState("Die")}),d.length>0&&(this.collectedLoot-=t)}}receiveLoot(e){this.collectedLoot+=e,this.score+=e,this.killsEnemy++}reset(){this.collectedLoot=100,this.killsEnemy=0}getAnimation(e){return`play${e}Animation`}playAnimation(e){const t=this.getAnimation(e);this[t]=!0}unsetAnimation(e){const t=this.getAnimation(e);this[t]=!1}}Qe=new WeakMap,Ye=new WeakMap,We=new WeakMap,Xe=new WeakMap,Je=new WeakMap,Ke=new WeakMap;const re=new cn;var dn=$('<div class="segment-marker svelte-xx93y6"></div>'),hn=$('<div class="health-bar-container svelte-xx93y6"><div class="health-bar-background svelte-xx93y6"><!> <div class="health-bar-fill svelte-xx93y6"></div></div></div>');function un(s,e){Z(e,!0);const t=e.entity.stats.maxHealth||500,i=5,a=F(()=>Math.max(0,Math.min(100,e.entity.stats.health/t*100))),n=Array.from({length:i-1},(w,C)=>(C+1)*(100/i));var l=hn();const d=F(()=>O.get("arrow"));R(()=>U(l,"cursor",o(d)));var v=A(l),y=A(v);te(y,17,()=>n,ei,(w,C)=>{var u=dn();R(()=>U(u,"left",`${o(C)??""}%`)),S(w,u)});var h=D(y,2);_(v),_(l),R(()=>{ve(h,"low",o(a)<=20),ve(h,"medium",o(a)>20&&o(a)<=60),ve(h,"high",o(a)>60),U(h,"width",`${o(a)??""}%`)}),S(s,l),G()}var mn=$('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),gn=$('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),vn=$('<div class="tower-wrapper svelte-td2xv"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></div>'),pn=$('<div class="tower-wrapper svelte-td2xv"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></div>'),fn=$('<section class="svelte-td2xv"><!> <!> <!> <div class="towers svelte-td2xv"></div> <div class="throne svelte-td2xv"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></div> <div class="towers svelte-td2xv"></div> <!></section>');function wn(s,e){Z(e,!0);const t=F(()=>E.get("entityManager")),i=p=>B=>{B.stopPropagation(),!(p.upgradeLevel===2||!p.isUpgradable||O.inAnimation)&&re.spendLoot({type:"upgrade",payload:{tower:p}})};var a=fn();const n=F(()=>O.get("arrow"));R(()=>U(a,"cursor",o(n)));var l=A(a);te(l,17,()=>o(t).loot,p=>p.id,(p,B)=>{var b=mn(),T=Y(b);ue(T,()=>({"--z-index":11})),Hs(T.lastChild,{get entity(){return o(B)}}),_(T),S(p,b)});var d=D(l,2);te(d,17,()=>o(t).projectiles,p=>p.id,(p,B)=>{var b=gn(),T=Y(b);ue(T,()=>({"--z-index":12})),Hs(T.lastChild,{get entity(){return o(B)}}),_(T),S(p,b)});var v=D(d,2);te(v,17,()=>o(t).enemies,p=>p.id,(p,B)=>{Hs(p,{get entity(){return o(B)}})});var y=D(v,2);te(y,23,()=>o(t).topTowers,p=>p.id,(p,B,b)=>{var T=vn(),L=A(T),j=F(()=>i(o(B)));ue(L,()=>({"--cursor":O.get("hammer"),"--z-index":10,"--pointer-events":"auto","--margin-left":o(b)===0?"12px":"0","--margin-right":o(b)===1?"12px":"0"})),Rs(L.lastChild,{get entity(){return o(B)},get onclick(){return o(j)}}),_(L),_(T),S(p,T)}),_(y);var h=D(y,2),w=A(h);ue(w,()=>({"--cursor":O.get("arrow")})),Rs(w.lastChild,{get entity(){return o(t).throne}}),_(w);var C=D(w,2);ue(C,()=>({"--width":`${o(t).throne.width}px`})),un(C.lastChild,{get entity(){return o(t).throne}}),_(C),_(h);var u=D(h,2);te(u,23,()=>o(t).bottomTowers,p=>p.id,(p,B,b)=>{var T=pn(),L=A(T),j=F(()=>i(o(B)));ue(L,()=>({"--cursor":O.get("hammer"),"--z-index":10,"--pointer-events":"auto","--margin-left":o(b)===0?"12px":"0","--margin-right":o(b)===1?"12px":"0"})),Rs(L.lastChild,{get entity(){return o(B)},get onclick(){return o(j)}}),_(L),_(T),S(p,T)}),_(u);var x=D(u,2);rn(x,{}),_(a),S(s,a),G()}const Cn=(s,e)=>{H!=null&&H.preloaded&&H.play("clickMenu",!0),e.onclick()};var yn=$('<button class="btn svelte-1gwdtzv"> </button>');function pe(s,e){Z(e,!0);const t=we(e,"disabled",3,!1),i=we(e,"text",3,"");var a=yn();a.__click=[Cn,e];const n=F(()=>O.get("arrow"));var l=A(a,!0);_(a),R(()=>{a.disabled=t(),U(a,"cursor",o(n)),oe(l,i())}),S(s,a),G()}Ks(["click"]);const Tn=s=>s;function Po(s){const e=s-1;return e*e*e+1}function he(s,{delay:e=0,duration:t=400,easing:i=Tn}={}){const a=+getComputedStyle(s).opacity;return{delay:e,duration:t,easing:i,css:n=>`opacity: ${n*a}`}}function bn(s,{delay:e=0,duration:t=400,easing:i=Po,axis:a="y"}={}){const n=getComputedStyle(s),l=+n.opacity,d=a==="y"?"height":"width",v=parseFloat(n[d]),y=a==="y"?["top","bottom"]:["left","right"],h=y.map(b=>`${b[0].toUpperCase()}${b.slice(1)}`),w=parseFloat(n[`padding${h[0]}`]),C=parseFloat(n[`padding${h[1]}`]),u=parseFloat(n[`margin${h[0]}`]),x=parseFloat(n[`margin${h[1]}`]),p=parseFloat(n[`border${h[0]}Width`]),B=parseFloat(n[`border${h[1]}Width`]);return{delay:e,duration:t,easing:i,css:b=>`overflow: hidden;opacity: ${Math.min(b*20,1)*l};${d}: ${b*v}px;padding-${y[0]}: ${b*w}px;padding-${y[1]}: ${b*C}px;margin-${y[0]}: ${b*u}px;margin-${y[1]}: ${b*x}px;border-${y[0]}-width: ${b*p}px;border-${y[1]}-width: ${b*B}px;`}}function ao(s,{delay:e=0,duration:t=400,easing:i=Po,start:a=0,opacity:n=0}={}){const l=getComputedStyle(s),d=+l.opacity,v=l.transform==="none"?"":l.transform,y=1-a,h=d*(1-n);return{delay:e,duration:t,easing:i,css:(w,C)=>`
			transform: ${v} scale(${1-y*C});
			opacity: ${d-h*C}
		`}}var xn=$('<div class="menu-container svelte-2plyb6"><!></div>');function ii(s,e){Z(e,!0);var t=xn();const i=F(()=>O.get("arrow"));R(()=>U(t,"cursor",o(i)));var a=A(t);Ar(a,()=>e.children),_(t),K(1,t,()=>he,()=>({duration:200})),K(2,t,()=>he,()=>({duration:200})),S(s,t),G()}var _n=Qs('<svg viewBox="0 0 50 50" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="25" cy="25" r="24.5" fill="#FFD700" stroke="white"></circle><circle cx="25" cy="25" r="18" fill="#FFAE00"></circle><path d="M43 25C43 20.2261 41.1036 15.6477 37.7279 12.2721C34.3523 8.89642 29.7739 7 25 7C20.2261 7 15.6477 8.89642 12.2721 12.2721C8.89642 15.6477 7 20.2261 7 25H7.72C7.72 20.4171 9.54057 16.0218 12.7812 12.7812C16.0218 9.54057 20.4171 7.72 25 7.72C29.5829 7.72 33.9782 9.54057 37.2188 12.7812C40.4594 16.0218 42.28 20.4171 42.28 25H43Z" fill="#E17100"></path><path d="M43 25C43 29.7739 41.1036 34.3523 37.7279 37.7279C34.3523 41.1036 29.7739 43 25 43C20.2261 43 15.6477 41.1036 12.2721 37.7279C8.89642 34.3523 7 29.7739 7 25H7.72C7.72 29.5829 9.54057 33.9782 12.7812 37.2188C16.0218 40.4594 20.4171 42.28 25 42.28C29.5829 42.28 33.9782 40.4594 37.2188 37.2188C40.4594 33.9782 42.28 29.5829 42.28 25H43Z" fill="#FFF4BA"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M25.4383 32.712C27.4385 32.7173 29.256 32.7221 30.6708 32.1912C32.8572 34.0388 35.4701 34.3689 36.5404 32.9185C37.6236 31.4507 36.7166 28.7153 34.5147 26.8087C34.237 26.5683 33.9521 26.3526 33.6639 26.1621C33.6294 19.4369 29.6875 14 24.83 14C19.951 14 15.9959 19.4851 15.9959 26.2512C15.9959 26.5311 16.0026 26.7988 16.0159 27.055C13.6344 28.6054 12.4107 31.1356 13.2796 32.7392C14.1577 34.3598 16.8404 34.4205 19.2715 32.8748C19.4834 32.7401 19.6864 32.5977 19.8798 32.4487C21.1345 32.7202 22.6195 32.7163 24.2217 32.712C24.4227 32.7115 24.6255 32.7109 24.83 32.7109C25.0344 32.7109 25.2373 32.7115 25.4383 32.712Z" fill="#E17100"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M25.4383 30.712C27.4385 30.7173 29.256 30.7221 30.6708 30.1912C32.8572 32.0388 35.4701 32.3689 36.5404 30.9185C37.6236 29.4507 36.7166 26.7153 34.5147 24.8087C34.237 24.5683 33.9521 24.3526 33.6639 24.1621C33.6294 17.4369 29.6875 12 24.83 12C19.951 12 15.9959 17.4851 15.9959 24.2512C15.9959 24.5311 16.0026 24.7988 16.0159 25.055C13.6344 26.6054 12.4107 29.1356 13.2796 30.7392C14.1577 32.3598 16.8404 32.4205 19.2715 30.8748C19.4834 30.7401 19.6864 30.5977 19.8798 30.4487C21.1345 30.7202 22.6195 30.7163 24.2217 30.712C24.4227 30.7115 24.6255 30.7109 24.83 30.7109C25.0344 30.7109 25.2373 30.7115 25.4383 30.712Z" fill="#FFF4BA"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M25.4383 31.712C27.4385 31.7173 29.256 31.7221 30.6708 31.1912C32.8572 33.0388 35.4701 33.3689 36.5404 31.9185C37.6236 30.4507 36.7166 27.7153 34.5147 25.8087C34.237 25.5683 33.9521 25.3526 33.6639 25.1621C33.6294 18.4369 29.6875 13 24.83 13C19.951 13 15.9959 18.4851 15.9959 25.2512C15.9959 25.5311 16.0026 25.7988 16.0159 26.055C13.6344 27.6054 12.4107 30.1356 13.2796 31.7392C14.1577 33.3598 16.8404 33.4205 19.2715 31.8748C19.4834 31.7401 19.6864 31.5977 19.8798 31.4487C21.1345 31.7202 22.6195 31.7163 24.2217 31.712C24.4227 31.7115 24.6255 31.7109 24.83 31.7109C25.0344 31.7109 25.2373 31.7115 25.4383 31.712Z" fill="#FFD700"></path><ellipse cx="24.9976" cy="22.982" rx="4.14994" ry="4.14994" fill="#FFF4BA"></ellipse><ellipse cx="25.0038" cy="22.9862" rx="2.62101" ry="2.62102" fill="#E17100"></ellipse><circle cx="25.0068" cy="22.9873" r="1.97166" fill="#FFD700"></circle><circle cx="25.0015" cy="22.9801" r="0.997639" fill="#E17100"></circle><mask id="path-12-inside-1_2401_1913" fill="white"><path d="M29.4521 22.9805C29.7547 22.9805 30.0031 22.7344 29.97 22.4336C29.8463 21.3087 29.3434 20.2528 28.5355 19.4449C27.5979 18.5073 26.3261 17.9805 25 17.9805C23.6739 17.9805 22.4021 18.5073 21.4645 19.4449C20.6566 20.2528 20.1537 21.3087 20.03 22.4336C19.9969 22.7344 20.2453 22.9805 20.5479 22.9805C20.8506 22.9805 21.0919 22.7339 21.1343 22.4343C21.252 21.6007 21.6372 20.822 22.2394 20.2198C22.9715 19.4877 23.9646 19.0764 25 19.0764C26.0354 19.0764 27.0285 19.4877 27.7606 20.2198C28.3628 20.822 28.748 21.6007 28.8657 22.4343C28.9081 22.7339 29.1494 22.9805 29.4521 22.9805Z"></path></mask><path d="M29.4521 22.9805C29.7547 22.9805 30.0031 22.7344 29.97 22.4336C29.8463 21.3087 29.3434 20.2528 28.5355 19.4449C27.5979 18.5073 26.3261 17.9805 25 17.9805C23.6739 17.9805 22.4021 18.5073 21.4645 19.4449C20.6566 20.2528 20.1537 21.3087 20.03 22.4336C19.9969 22.7344 20.2453 22.9805 20.5479 22.9805C20.8506 22.9805 21.0919 22.7339 21.1343 22.4343C21.252 21.6007 21.6372 20.822 22.2394 20.2198C22.9715 19.4877 23.9646 19.0764 25 19.0764C26.0354 19.0764 27.0285 19.4877 27.7606 20.2198C28.3628 20.822 28.748 21.6007 28.8657 22.4343C28.9081 22.7339 29.1494 22.9805 29.4521 22.9805Z" stroke="#E17100" stroke-width="2" mask="url(#path-12-inside-1_2401_1913)"></path><circle cx="24.3913" cy="21.9831" r="0.613932" fill="white"></circle><ellipse cx="26.0021" cy="24.2619" rx="0.283353" ry="0.283353" fill="white"></ellipse></svg>');function be(s,e){const t=we(e,"width",3,40),i=we(e,"height",3,40);var a=_n();R(()=>{de(a,"width",t()),de(a,"height",i())}),S(s,a)}var Fn=$('<div class="content svelte-1fxce1q"><h1 class="svelte-1fxce1q"> </h1> <div class="scores"><h2 class="svelte-1fxce1q"> </h2> <h2 class="svelte-1fxce1q"> </h2></div> <div class="hint svelte-1fxce1q"><h2 class="svelte-1fxce1q">Hint:</h2> <p>- Click on an Enemy to kill it</p> <p>- Click on a gray spot to build a Tower</p> <p>- Click on a Tower to upgrade</p> <div class="additional-hint svelte-1fxce1q"><div>Manage your resources carefully if you want to survive until the last wave!</div> <div class="cost svelte-1fxce1q"><div class="cost-item svelte-1fxce1q"><div>Upgrading towers costs 35</div> <div><!></div></div> <div class="cost-item svelte-1fxce1q"><div>Enemy click costs 5</div> <div><!></div></div></div></div></div> <!></div>');function An(s,e){Z(e,!0);const t=F(()=>E.get("stageManager"));Js(()=>{H.reduceBgVolume()}),Ao(()=>{H.restoreBgVolume()}),ii(s,{children:(i,a)=>{var n=Fn(),l=A(n),d=A(l,!0);_(l);var v=D(l,2),y=A(v),h=A(y);_(y);var w=D(y,2),C=A(w);_(w),_(v);var u=D(v,2),x=D(A(u),8),p=D(A(x),2),B=A(p),b=D(A(B),2),T=A(b);be(T,{width:13,height:13}),_(b),_(B);var L=D(B,2),j=D(A(L),2),M=A(j);be(M,{width:13,height:13}),_(j),_(L),_(p),_(x),_(u);var k=D(u,2);pe(k,{get onclick(){return e.onRestart},text:"Restart"}),_(n),R(()=>{oe(d,o(t).stageResult==="win"?"You win!":"You lose!"),oe(h,`Enemies killed: ${re.killsEnemy??""}`),oe(C,`Score: ${re.score??""}`)}),K(1,n,()=>bn,()=>({duration:500})),K(2,n,()=>he,()=>({duration:300})),S(i,n)},$$slots:{default:!0}}),G()}var Bn=$('<div class="container svelte-126rs5f"><svg class="logo svelte-126rs5f" viewBox="0 0 236 73" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M68.7367 38.4101L73.6997 24.2163H77.5358L72.3091 39.1054C71.6857 40.8796 70.6068 42.2462 68.7367 42.2462C66.8665 42.2462 65.7876 40.8796 65.1642 39.1054L59.9375 24.2163H63.7736L68.7367 38.4101Z" fill="#D685DA"></path><path d="M83.0362 34.7417V38.9135H92.219L93.8973 42.0064H82.8204C80.9503 42.0064 79.4398 40.5919 79.4398 38.8656V27.3572C79.4398 25.6309 80.9503 24.2163 82.8204 24.2163H93.8973L92.219 27.3092H83.0362V31.6489H91.4997V34.7417H83.0362Z" fill="#D685DA"></path><path d="M100.157 38.9135H108.62L110.299 42.0064H99.9411C98.071 42.0064 96.5605 40.5919 96.5605 38.8656V24.2163H100.157V38.9135Z" fill="#D685DA"></path><path d="M117.503 42.0064H113.907V27.3572C113.907 25.6309 115.418 24.2163 117.288 24.2163H122.61V27.3092H117.503V42.0064ZM114.578 24.2163L112.66 27.3092H109.112V24.2163H114.578Z" fill="#D685DA"></path><path d="M128.436 34.7417V38.9135H137.619L139.297 42.0064H128.22C126.35 42.0064 124.84 40.5919 124.84 38.8656V27.3572C124.84 25.6309 126.35 24.2163 128.22 24.2163H139.297L137.619 27.3092H128.436V31.6489H136.899V34.7417H128.436Z" fill="#D685DA"></path><path d="M148.525 29.2992C148.525 26.494 151.498 24.2163 155.166 24.2163H157.564C159.362 24.2163 161.927 24.9596 163.126 26.1584L160.009 28.556C159.458 27.7887 158.451 27.3092 157.564 27.3092H155.166C153.488 27.3092 152.121 28.1963 152.121 29.2992C152.121 32.0325 163.366 30.9296 163.366 36.9235C163.366 39.7287 160.273 42.0064 156.485 42.0064H154.087C152.217 42.0064 149.532 41.2632 148.285 40.0644L151.378 37.6668C151.977 38.434 153.104 38.9135 154.087 38.9135H156.485C158.307 38.9135 159.77 38.0264 159.77 36.9235C159.77 33.8546 148.525 35.2452 148.525 29.2992Z" fill="#D685DA"></path><path d="M169.765 27.3092V42.0064H166.169V27.3572C166.169 25.6309 167.68 24.2163 169.55 24.2163H174.393C178.181 24.2163 181.274 26.518 181.274 30.2582V30.9296C181.274 34.6698 178.181 36.9715 174.393 36.9715H170.005L171.923 33.8786H174.393C176.215 33.8786 177.678 32.9435 177.678 30.9296V30.2582C177.678 28.2443 176.215 27.3092 174.393 27.3092H169.765Z" fill="#D685DA"></path><path d="M194.322 39.6328H186.53L188.448 36.5399H193.243L190.198 27.8127L185.235 42.0064H181.399L186.626 27.1174C187.249 25.3432 188.328 23.9766 190.198 23.9766C192.068 23.9766 193.147 25.3432 193.771 27.1174L198.997 42.0064H195.161L194.322 39.6328Z" fill="#D685DA"></path><path d="M203.815 30.9775V35.2452C203.815 37.2592 205.277 38.9135 207.1 38.9135H209.497C210.48 38.9135 211.583 38.434 212.182 37.6668L215.299 40.0644C214.053 41.2632 211.367 42.0064 209.497 42.0064H207.1C203.311 42.0064 200.218 38.9855 200.218 35.2452V30.9775C200.218 27.2373 203.311 24.2163 207.1 24.2163H209.497C211.367 24.2163 214.053 24.9596 215.299 26.1584L212.182 28.556C211.583 27.7887 210.48 27.3092 209.497 27.3092H207.1C205.277 27.3092 203.815 28.9635 203.815 30.9775Z" fill="#D685DA"></path><path d="M221.342 34.7417V38.9135H230.525L232.204 42.0064H221.127C219.257 42.0064 217.746 40.5919 217.746 38.8656V27.3572C217.746 25.6309 219.257 24.2163 221.127 24.2163H232.204L230.525 27.3092H221.342V31.6489H229.806V34.7417H221.342Z" fill="#D685DA"></path><path d="M71.7992 41.4335L76.7622 27.2398H80.5983L75.3716 42.1288C74.7482 43.903 73.6693 45.2696 71.7992 45.2696C69.929 45.2696 68.8501 43.903 68.2267 42.1288L63 27.2398H66.8361L71.7992 41.4335Z" fill="#D685DA" fill-opacity="0.2"></path><path d="M86.0987 37.7652V41.937H95.2815L96.9598 45.0299H85.8829C84.0128 45.0299 82.5023 43.6153 82.5023 41.889V30.3806C82.5023 28.6543 84.0128 27.2398 85.8829 27.2398H96.9598L95.2815 30.3327H86.0987V34.6723H94.5622V37.7652H86.0987Z" fill="#D685DA" fill-opacity="0.2"></path><path d="M103.219 41.937H111.683L113.361 45.0299H103.004C101.133 45.0299 99.623 43.6153 99.623 41.889V27.2398H103.219V41.937Z" fill="#D685DA" fill-opacity="0.2"></path><path d="M120.566 45.0299H116.97V30.3806C116.97 28.6543 118.48 27.2398 120.35 27.2398H125.673V30.3327H120.566V45.0299ZM117.641 27.2398L115.723 30.3327H112.174V27.2398H117.641Z" fill="#D685DA" fill-opacity="0.2"></path><path d="M131.498 37.7652V41.937H140.681L142.359 45.0299H131.283C129.412 45.0299 127.902 43.6153 127.902 41.889V30.3806C127.902 28.6543 129.412 27.2398 131.283 27.2398H142.359L140.681 30.3327H131.498V34.6723H139.962V37.7652H131.498Z" fill="#D685DA" fill-opacity="0.2"></path><path d="M151.587 32.3226C151.587 29.5175 154.56 27.2398 158.229 27.2398H160.626C162.425 27.2398 164.99 27.983 166.189 29.1818L163.072 31.5794C162.52 30.8122 161.513 30.3327 160.626 30.3327H158.229C156.55 30.3327 155.184 31.2198 155.184 32.3226C155.184 35.0559 166.428 33.953 166.428 39.947C166.428 42.7522 163.336 45.0299 159.547 45.0299H157.15C155.28 45.0299 152.594 44.2866 151.348 43.0878L154.441 40.6902C155.04 41.4575 156.167 41.937 157.15 41.937H159.547C161.37 41.937 162.832 41.0499 162.832 39.947C162.832 36.8781 151.587 38.2687 151.587 32.3226Z" fill="#D685DA" fill-opacity="0.2"></path><path d="M172.828 30.3327V45.0299H169.232V30.3806C169.232 28.6543 170.742 27.2398 172.612 27.2398H177.455C181.244 27.2398 184.336 29.5414 184.336 33.2817V33.953C184.336 37.6933 181.244 39.9949 177.455 39.9949H173.068L174.986 36.902H177.455C179.278 36.902 180.74 35.967 180.74 33.953V33.2817C180.74 31.2677 179.278 30.3327 177.455 30.3327H172.828Z" fill="#D685DA" fill-opacity="0.2"></path><path d="M197.385 42.6563H189.592L191.51 39.5634H196.306L193.261 30.8361L188.298 45.0299H184.462L189.688 30.1408C190.312 28.3666 191.391 27 193.261 27C195.131 27 196.21 28.3666 196.833 30.1408L202.06 45.0299H198.224L197.385 42.6563Z" fill="#D685DA" fill-opacity="0.2"></path><path d="M206.877 34.001V38.2687C206.877 40.2826 208.34 41.937 210.162 41.937H212.56C213.543 41.937 214.646 41.4575 215.245 40.6902L218.362 43.0878C217.115 44.2866 214.43 45.0299 212.56 45.0299H210.162C206.374 45.0299 203.281 42.0089 203.281 38.2687V34.001C203.281 30.2607 206.374 27.2398 210.162 27.2398H212.56C214.43 27.2398 217.115 27.983 218.362 29.1818L215.245 31.5794C214.646 30.8122 213.543 30.3327 212.56 30.3327H210.162C208.34 30.3327 206.877 31.987 206.877 34.001Z" fill="#D685DA" fill-opacity="0.2"></path><path d="M224.405 37.7652V41.937H233.588L235.266 45.0299H224.189C222.319 45.0299 220.809 43.6153 220.809 41.889V30.3806C220.809 28.6543 222.319 27.2398 224.189 27.2398H235.266L233.588 30.3327H224.405V34.6723H232.868V37.7652H224.405Z" fill="#D685DA" fill-opacity="0.2"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M26.8439 7.96275C35.7667 2.31579 47.5625 4.98108 53.1905 13.9159C58.8185 22.8506 56.1476 34.6715 47.2248 40.3184L31.2944 50.4002C22.3716 56.0472 10.5758 53.3819 4.94779 44.4471C-0.680224 35.5124 1.99074 23.6915 10.9136 18.0446L26.8439 7.96275ZM46.1734 17.6575C46.2058 17.7056 46.2379 17.754 46.2697 17.8027C49.5247 22.792 48.5079 29.3438 44.123 33.1391C43.711 33.5027 43.2689 33.8418 42.7975 34.1527L27.9992 43.9143C22.5561 47.5048 15.268 45.98 11.7209 40.5086C8.17374 35.0371 9.71072 27.6909 15.1538 24.1004L29.9521 14.3388C35.3662 10.7674 42.6057 12.257 46.1734 17.6575Z" fill="#D685DA" fill-opacity="0.2"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M26.8628 26.9503C35.7766 21.3223 47.565 23.9859 53.193 32.8997C58.821 41.8135 56.1574 53.602 47.2436 59.23L31.2806 69.3088C22.3668 74.9368 10.5783 72.2731 4.95029 63.3593C-0.677717 54.4455 1.98594 42.6571 10.8997 37.0291L26.8628 26.9503ZM46.1948 36.6689C46.2182 36.7039 46.2414 36.7389 46.2644 36.7742C49.2396 41.3238 48.6488 47.1738 45.1803 51.0352C44.5002 51.8059 43.7082 52.4997 42.8095 53.0911L27.9927 62.842C22.5547 66.4207 15.2708 64.8967 11.7236 59.4381C8.17648 53.9795 9.7093 46.6533 15.1473 43.0746L29.9641 33.3237C35.3826 29.7579 42.6337 31.2581 46.1948 36.6689Z" fill="#D685DA" fill-opacity="0.2"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M51.4113 8.9017C45.7833 -0.0120999 33.9949 -2.67576 25.0811 2.95225L9.11805 13.031C0.371424 18.5535 -2.3573 30.0075 2.86069 38.8568C-0.858384 44.8693 -1.07807 52.7223 2.95029 59.1025C8.5783 68.0163 20.3668 70.68 29.2806 65.052L45.2436 54.9732C53.9902 49.4508 56.7189 37.9967 51.5009 29.1474C55.22 23.1349 55.4397 15.2819 51.4113 8.9017ZM15.9353 47.9583C20.4649 48.7728 25.3007 47.9614 29.4989 45.3107L38.0426 39.9164C37.7878 40.6333 37.3048 41.2756 36.6185 41.724L21.4583 51.6294C19.791 52.7188 17.5551 52.251 16.4643 50.5845C15.936 49.7774 15.7733 48.8371 15.9353 47.9583ZM38.3102 20.0255C38.6136 19.037 38.4914 17.9259 37.8807 16.9928C36.7899 15.3263 34.554 14.8584 32.8867 15.9479L17.7265 25.8532C16.8752 26.4095 16.3367 27.264 16.1586 28.1891L24.8628 22.6935C29.0251 20.0655 33.8142 19.2454 38.3102 20.0255Z" fill="#D685DA"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M24.8628 22.6808C33.7766 17.0528 45.565 19.7164 51.193 28.6302C56.821 37.544 54.1574 49.3325 45.2436 54.9605L29.2806 65.0393C20.3668 70.6673 8.5783 68.0036 2.95029 59.0898C-2.67772 50.176 -0.0140554 38.3875 8.89974 32.7595L24.8628 22.6808ZM44.1948 32.3995C44.2182 32.4344 44.2414 32.4694 44.2644 32.5046C47.2396 37.0542 46.6488 42.9043 43.1803 46.7657C42.5002 47.5364 41.7082 48.2302 40.8095 48.8216L25.9927 58.5725C20.5547 62.1512 13.2708 60.6272 9.72363 55.1686C6.17648 49.71 7.70929 42.3838 13.1473 38.8051L27.9641 29.0542C33.3826 25.4883 40.6338 26.9886 44.1948 32.3995Z" fill="#D685DA"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M25.0509 2.96275C33.9738 -2.68421 45.7695 -0.0189172 51.3975 8.91586C57.0256 17.8506 54.3546 29.6715 45.4318 35.3184L29.5014 45.4002C20.5786 51.0472 8.78283 48.3819 3.15482 39.4471C-2.47319 30.5124 0.197772 18.6915 9.12058 13.0446L25.0509 2.96275ZM44.3804 12.6575C44.4128 12.7056 44.4449 12.754 44.4767 12.8027C47.7318 17.792 46.715 24.3438 42.33 28.1391C41.918 28.5027 41.4759 28.8418 41.0045 29.1527L26.2062 38.9143C20.7631 42.5048 13.4751 40.98 9.92793 35.5086C6.38077 30.0371 7.91775 22.6909 13.3609 19.1004L28.1591 9.33882C33.5733 5.76744 40.8127 7.25701 44.3804 12.6575Z" fill="#D685DA"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M8.45943 44.8515C7.31549 48.1859 7.6597 51.9938 9.72342 55.1696C13.2706 60.6283 20.5545 62.1522 25.9924 58.5735L40.8093 48.8226C46.2473 45.2439 47.7801 37.9177 44.233 32.4591C40.6858 27.0005 33.4019 25.4765 27.9639 29.0552L13.2264 38.7539C17.0753 41.7359 22.5362 42.1003 26.8406 39.2676L29.0701 37.8003L29.1055 37.8517L32.3848 35.7072C34.1484 34.5539 36.5131 35.0487 37.6664 36.8123C38.8197 38.5759 38.325 40.9406 36.5613 42.0939L21.6734 51.8298C19.9098 52.9832 17.5451 52.4884 16.3918 50.7248C15.8891 49.9561 15.6995 49.0733 15.7916 48.2264C13.1607 47.6408 10.6534 46.5016 8.45943 44.8515Z" fill="#53126E"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M44.4289 12.9182C46.4923 16.0936 46.8367 19.9008 45.6935 23.2348C43.5018 21.5847 40.9972 20.4446 38.3687 19.8573C38.4597 19.0117 38.2699 18.1306 37.7681 17.3633C36.6148 15.5997 34.2501 15.1049 32.4865 16.2582L17.5985 25.9942C15.8349 27.1475 15.3401 29.5121 16.4935 31.2758C17.6468 33.0394 20.0114 33.5341 21.775 32.3808L25.047 30.2411L25.0801 30.2892L27.312 28.8204C31.6163 25.9878 37.0771 26.352 40.9259 29.334L26.1884 39.0327C20.7504 42.6114 13.4665 41.0874 9.91939 35.6288C6.37224 30.1702 7.90506 22.844 13.343 19.2653L28.1599 9.51438C33.5979 5.93567 40.8818 7.45963 44.4289 12.9182Z" fill="#53126E"></path><rect x="35.5703" y="33.5879" width="7.88869" height="25.4198" rx="3.94434" transform="rotate(56.8174 35.5703 33.5879)" fill="#D685DA"></rect><rect x="35.5859" y="14.0918" width="7.88869" height="25.4198" rx="3.94434" transform="rotate(56.8174 35.5859 14.0918)" fill="#D685DA"></rect></svg></div>');function Mn(s){var e=Bn();S(s,e)}var En=$('<div class="content svelte-1pe2kac"><!> <div><h2>Hint:</h2> <p>- Click on an Enemy to kill it</p> <p>- Click on a gray spot to build a Tower</p> <p>- Click on a Tower to upgrade</p> <div class="additional-hint svelte-1pe2kac"><div>Manage your resources carefully if you want to survive until the last wave!</div> <div class="cost svelte-1pe2kac"><div class="cost-item svelte-1pe2kac"><div>Upgrading towers costs 35</div> <div><!></div></div> <div class="cost-item svelte-1pe2kac"><div>Enemy click costs 5</div> <div><!></div></div></div></div></div> <div class="buttons-container"><!></div></div>');function Sn(s,e){Z(e,!0);const t=F(()=>H.preloaded?"Start game":`${H.preloadPercent}%`);ii(s,{children:(i,a)=>{var n=En(),l=A(n);Mn(l);var d=D(l,2),v=D(A(d),8),y=D(A(v),2),h=A(y),w=D(A(h),2),C=A(w);be(C,{width:13,height:13}),_(w),_(h);var u=D(h,2),x=D(A(u),2),p=A(x);be(p,{width:13,height:13}),_(x),_(u),_(y),_(v),_(d);var B=D(d,2),b=A(B),T=F(()=>!H.preloaded);pe(b,{get disabled(){return o(T)},get text(){return o(t)},get onclick(){return e.onStart}}),_(B),_(n),K(2,n,()=>he,()=>({duration:300})),S(i,n)},$$slots:{default:!0}}),G()}class Dn{constructor(){I(this,"filterEnemiesByBounds",e=>E.get("entityManager").livingEnemies.filter(i=>ge(i.boundingBox,e)))}update(){const e=E.get("entityManager");this.handleEnemyCollisions(e.livingEnemies,e.livingProjectiles,e.throne),this.handleProjectileCollisions(e.livingProjectiles),this.handleLootCollisions(e.livingLoot,e.throne)}handleEnemyCollisions(e,t,i){for(const a of e){for(const n of t)this.checkCollision(n,a)&&(n.onCollide(a),a.onCollide(n));this.checkCollision(a,i)&&(a.onCollide(i),i.onCollide(a))}}handleProjectileCollisions(e){for(const t of e)if(!this.checkScreenBounds(t)){t.onCollide("OUT_OF_BOUNDS");continue}}handleLootCollisions(e,t){e.forEach(i=>{this.checkCollision(i,t)&&(i.onCollide(t),t.onCollide(i))})}checkCollision(e,t){return ge(e.boundingBox,t.boundingBox)}checkBounds(e,t){return ge(e.boundingBox,t)}checkScreenBounds(e){return ge(e.boundingBox,P.screenBounds)}checkGameBounds(e){return ge(e.boundingBox,P.gameBoundingBox)}}var et,vs,ps,fs,ws,Cs,ys,Ts,bs,xs,_s;class Ln{constructor(){c(this,et,m([]));c(this,vs,F(()=>this.entities.filter(e=>e.type==="enemy")));c(this,ps,F(()=>this.enemies.filter(e=>e.isInteractable)));c(this,fs,F(()=>this.entities.filter(e=>e.type==="tower")));c(this,ws,F(()=>this.towers.filter((e,t)=>t<=1)));c(this,Cs,F(()=>this.towers.filter((e,t)=>t>=2)));c(this,ys,F(()=>this.entities.filter(e=>e.type==="projectile")));c(this,Ts,F(()=>this.projectiles.filter(e=>e.isInteractable)));c(this,bs,F(()=>this.entities.find(e=>e.type==="throne")));c(this,xs,F(()=>this.entities.filter(e=>e.type==="loot")));c(this,_s,F(()=>this.loot.filter(e=>e.isInteractable)));I(this,"update",e=>{this.entities.forEach(t=>t.update(e))});I(this,"reset",()=>{this.entities=[]});I(this,"add",e=>{this.entities=[...this.entities,...Array.isArray(e)?e:[e]]});I(this,"destroy",e=>{this.entities=this.entities.filter(t=>t.id!==e)});I(this,"getByName",e=>this.entities.find(t=>t.name===e));I(this,"getById",e=>this.entities.find(t=>t.id===e))}get entities(){return o(r(this,et))}set entities(e){g(r(this,et),e)}get enemies(){return o(r(this,vs))}get livingEnemies(){return o(r(this,ps))}get towers(){return o(r(this,fs))}get topTowers(){return o(r(this,ws))}get bottomTowers(){return o(r(this,Cs))}get projectiles(){return o(r(this,ys))}get livingProjectiles(){return o(r(this,Ts))}get throne(){return o(r(this,bs))}get loot(){return o(r(this,xs))}get livingLoot(){return o(r(this,_s))}filterByName(e){return this.entities.filter(t=>Array.isArray(e)?e.includes(t.name):t.name===e)}findNearestEntity(e,t){const i=t.filter(d=>d.isInteractable);if(i.length===0)return;const a=i.map(d=>e.position.distance(d.position)),n=Math.min(...a),l=a.indexOf(n);return i[l]}findNearestEntities(e,t,i=3){const a=t.filter(d=>d.isInteractable);if(a.length===0)return;const n=a.map(d=>({target:d,distance:e.position.distance(d.position)}));n.sort((d,v)=>d.distance-v.distance);const l=Math.min(i,n.length);return n.slice(0,l).map(d=>d.target)}findByPosition(e){const t=si(e,100,100);return this.entities.filter(i=>ge(i.boundingBox,t))}}et=new WeakMap,vs=new WeakMap,ps=new WeakMap,fs=new WeakMap,ws=new WeakMap,Cs=new WeakMap,ys=new WeakMap,Ts=new WeakMap,bs=new WeakMap,xs=new WeakMap,_s=new WeakMap;const no=[{commonEnemies:["PurpleCommon","YellowCommon"],time:6e4,eliteEnemies:["RedBlobElite"],spawnDelays:{common:900,elite:1400},statsAmplify:{health:1,speed:1,damage:1}},{commonEnemies:["YellowCommon","BlueCommon"],eliteEnemies:["GreenCircleElite","BlueCircleElite"],time:12e4,spawnDelays:{common:800,elite:1300},statsAmplify:{health:1.2,speed:1.2,damage:1.2}},{commonEnemies:["PurpleCommon","YellowCommon","BlueCommon"],eliteEnemies:["BlueBlobElite","GreenCircleElite","BlueCircleElite"],time:12e4,spawnDelays:{common:600,elite:1100},statsAmplify:{health:1.7,speed:1.4,damage:1.5}},{commonEnemies:["PurpleCommon","YellowCommon","BlueCommon"],eliteEnemies:["BlueCircleElite","GreenCircleElite","BlueBlobElite","RedBlobElite"],time:12e4,spawnDelays:{common:400,elite:800},statsAmplify:{health:2.2,speed:1.6,damage:1.8}}],le=(s,e)=>{s.takeDamage(e.stats.damage)},Kt=(s,e)=>{s.state.setState("Explode")},kn=(s,e)=>{e.type==="loot"?(re.receiveLoot(1),H.play("pickUp")):e.type==="enemy"&&s.takeDamage(e.stats.damage)},es=(s,e)=>{e.type==="enemy"&&(s.takeDamage(1),e.takeDamage(999))},Pn=(s,e)=>{s.stopInteractions(),E.get("entityManager").destroy(s.id)},jo={PurpleCommon:{type:"enemy",initialState:"FollowThrone",vfx:[],scale:.6,stateToAnimation:{FollowThrone:"PurpleCommonFollow",Die:"PurpleCommonDie"},stats:{health:20,speed:.03,damage:5},onCollide:le},YellowCommon:{type:"enemy",initialState:"FollowThrone",vfx:[],scale:.8,stateToAnimation:{FollowThrone:"YellowCommonFollow",Die:"YellowCommonDie"},stats:{health:15,speed:.025,damage:4},onCollide:le},BlueCommon:{type:"enemy",initialState:"FollowThrone",vfx:[],scale:.7,stateToAnimation:{FollowThrone:"BlueCommonFollow",Die:"BlueCommonDie"},stats:{health:25,speed:.02,damage:8},onCollide:le},GreenCircleElite:{type:"enemy",initialState:"FollowThrone",vfx:[],scale:1,stateToAnimation:{FollowThrone:"GreenCircleEliteFollow",Die:"GreenCircleEliteDie"},stats:{health:80,speed:.01,damage:15},onCollide:le},RedBlobElite:{type:"enemy",initialState:"FollowThrone",vfx:[],scale:.8,stateToAnimation:{FollowThrone:"RedBlobEliteFollow",Die:"RedBlobEliteDie"},stats:{health:30,speed:.015,damage:10},onCollide:le},BlueBlobElite:{type:"enemy",initialState:"FollowThrone",vfx:[],scale:1,stateToAnimation:{FollowThrone:"BlueBlobEliteFollow",Die:"BlueBlobEliteDie"},stats:{health:60,speed:.04,damage:8},onCollide:le},BlueCircleElite:{type:"enemy",initialState:"FollowThrone",vfx:[],scale:1,stateToAnimation:{FollowThrone:"BlueCircleEliteFollow",Die:"BlueCircleEliteDie"},stats:{health:70,speed:.02,damage:10},onCollide:le}},jn=[s=>{},s=>{s.stats.attackSpeed-=50,s.stats.projectileNumber+=1},s=>{s.stats.attackSpeed-=50,s.stats.projectileNumber+=1}],In=[s=>{},s=>{s.stats.attackSpeed-=50,s.stats.projectileNumber+=1},s=>{s.stats.attackSpeed-=50,s.stats.projectileNumber+=1}],$n=[s=>{},s=>{s.stats.attackSpeed-=50,s.stats.projectileNumber+=1},s=>{s.stats.attackSpeed-=50,s.stats.projectileNumber+=1}],Hn=[s=>{},s=>{s.stats.attackSpeed-=50,s.stats.projectileNumber+=1},s=>{s.stats.attackSpeed-=30,s.stats.projectileNumber+=1}],W={questionInterval:8e3,initialQuestionDelay:2e3,bulletTimeFactor:.05,questionDuration:1e4,maxStrikes:3,mainTowerHP:1e3,subTowerHP:3},ts={health:W.subTowerHP,maxHealth:W.subTowerHP,attackSpeed:800,projectileNumber:1},oi={Throne:{type:"throne",stats:{health:W.mainTowerHP,maxHealth:W.mainTowerHP,damage:999,speed:0},scale:.6,stateToAnimation:{Idle:"Throne",Die:"Throne"},initialState:"Idle",onCollide:kn},FireTower:{type:"tower",initialState:"NotBuilt",stateToAnimation:{Guard:"FireTowerBase0",Shoot:"FireTowerBase0",NotBuilt:"TowerBase",Upgrade:"FireTowerUpgrade0"},effects:[],stats:{...ts,projectileType:"Fireball"},scale:.8,upgrades:jn,onCollide:es},ThunderTower:{type:"tower",initialState:"NotBuilt",stateToAnimation:{Guard:"ThunderTowerBase0",Shoot:"ThunderTowerBase0",NotBuilt:"TowerBase",Upgrade:"ThunderTowerUpgrade0"},effects:[],stats:{...ts,attackSpeed:750,projectileType:"Thunderbolt"},scale:.8,upgrades:$n,onCollide:es},PoisonTower:{type:"tower",initialState:"NotBuilt",stateToAnimation:{Guard:"PoisonTowerBase0",Shoot:"PoisonTowerBase0",NotBuilt:"TowerBase",Upgrade:"PoisonTowerUpgrade0"},effects:[],stats:{...ts,projectileType:"Poisonball"},scale:.8,upgrades:In,onCollide:es},IceTower:{type:"tower",initialState:"NotBuilt",stateToAnimation:{Guard:"IceTowerBase0",Shoot:"IceTowerBase0",NotBuilt:"TowerBase",Upgrade:"IceTowerUpgrade0"},effects:[],stats:{...ts,attackSpeed:850,projectileType:"Icebolt"},scale:.8,upgrades:Hn,onCollide:es}},Io={Fireball:{type:"projectile",width:20,height:22,vfx:[],initialState:"FollowTarget",stateToAnimation:{FollowTarget:"FireballFollow",FollowAngle:"FireballFollow",Explode:"FireballDie"},scale:2,stats:{health:1,speed:.5,damage:11},onCollide:Kt},Icebolt:{type:"projectile",width:10,height:27,vfx:[],initialState:"FollowTarget",stateToAnimation:{FollowTarget:"IceboltFollow",FollowAngle:"IceboltFollow",Explode:"IceboltDie"},scale:2,stats:{health:1,speed:.3,damage:11},onCollide:Kt},Poisonball:{type:"projectile",width:17,height:16,vfx:[],initialState:"FollowTarget",stateToAnimation:{FollowTarget:"PoisonballFollow",FollowAngle:"PoisonballFollow",Explode:"PoisonballDie"},scale:2,stats:{health:1,speed:.4,damage:11},onCollide:Kt},Thunderbolt:{type:"projectile",width:17,height:31,vfx:[],initialState:"FollowTarget",stateToAnimation:{FollowTarget:"ThunderboltFollow",FollowAngle:"ThunderboltFollow",Explode:"ThunderboltDie"},scale:2,stats:{health:1,speed:.4,damage:11},onCollide:Kt},Loot:{type:"loot",vfx:[],width:14,height:19,initialState:"FollowTarget",stateToAnimation:{FollowTarget:"Loot"},scale:1,stats:{health:1,damage:0,speed:.5},onCollide:Pn},ClickExplode:{type:"projectile",vfx:[],width:30,height:30,initialState:"Explode",stateToAnimation:{Explode:"Click"},scale:1,stats:{health:1,damage:10,speed:.5}}},Zs={...jo,...oi,...Io},lo=Object.keys(jo).length+Object.keys(oi).length+Object.keys(Io).length,co=Object.keys(Zs).length;if(lo!==co)throw new Error(`Entities defined and exported do not match. Check for duplicated Entity names : Total count: ${lo} / Exported count ${co}`);const Rn=s=>{if(!Zs[s])throw new Error(`Entity config not found for: ${s}`);return Zs[s]};var tt;class J{constructor(e){c(this,tt,m());this.stateMachine=e}get stateMachine(){return o(r(this,tt))}set stateMachine(e){g(r(this,tt),f(e))}update(e,t){}get name(){return this.constructor.name}get entity(){return this.stateMachine.owner}}tt=new WeakMap;let Un=class extends J{constructor(e){super(e),e.owner.stopInteractions(),this.entity.removeCollider()}update(){if(this.entity.animation.isComplete){const{entityManager:e,stageManager:t}=E.get(["entityManager","stageManager"]);e.destroy(this.entity.id),t.spawnLoot(this.entity)}}};class Nn extends J{constructor(){super(...arguments);I(this,"lastAngle",0)}update(t){this.follow(t)}follow(t){const{throne:i}=this.stateMachine.context;if(!i.width)return;const a=i.position;this.entity.rotation=ko(this.entity.position,a);const l=ti(this.entity.rotation).multiply(this.entity.stats.speed*t);this.entity.position=this.entity.position.add(l)}}const qn=Object.freeze(Object.defineProperty({__proto__:null,Die:Un,FollowThrone:Nn},Symbol.toStringTag,{value:"Module"}));class Vn extends J{constructor(){super(...arguments);I(this,"isSetup",!1)}update(t,i){this.isSetup||(P.isMobile?this.entity.position.y+=30:this.entity.position.y+=35,this.isSetup=!0)}}const $o=s=>s===1?"1":s===2?"2":"0",On=(s,e)=>`${s.name}Upgrade${$o(e)}`,ho=(s,e)=>`${s.name}Base${$o(e)}`;class Zn extends J{constructor(e){super(e),this.entity.upgradeLevel+=1;const t=this.entity.upgrades[this.entity.upgradeLevel];t(this.entity),this.entity.animation.onFrameChange=i=>{},H.play("towerUpgrade")}update(e){this.entity.animation.isComplete&&(this.entity.stateToAnimation={...this.entity.stateToAnimation,Guard:ho(this.entity,this.entity.upgradeLevel),Shoot:ho(this.entity,this.entity.upgradeLevel),Upgrade:On(this.entity,this.entity.upgradeLevel+1)},this.entity.state.setState("Guard"),this.entity.animation.onFrameChange=()=>{})}}class Gn extends J{constructor(e){super(e);const t=E.get("gameLoop"),i=this.entity.stats.attackSpeed;this.cdId=t.setCD(i,!0)}update(){const{entityManager:e,gameLoop:t}=E.get(["entityManager","gameLoop"]),i=e.findNearestEntity(this.entity,e.enemies);t.isCDReady(this.cdId)&&i&&this.stateMachine.setState("Shoot",{spawner:this.entity,target:i})}}class zn extends J{update(){this.shoot(),this.entity.addVFX("TowerShoot"),this.entity.state.setState("Guard")}shoot(){const e=E.get("stageManager"),{spawner:t}=this.stateMachine.context,i=t.stats.projectileType,a=this.entity.stats.projectileNumber,n=t.position.add(new Q(t.width/2,0)),l=E.get("entityManager");l.findNearestEntities(t,l.enemies,a).forEach(v=>{e.spawnEntity(i,n,{spawner:t,target:v})}),H.play("towerShoot")}}const Qn=Object.freeze(Object.defineProperty({__proto__:null,Guard:Gn,NotBuilt:Vn,Shoot:zn,Upgrade:Zn},Symbol.toStringTag,{value:"Module"}));class Yn extends J{update(e){this.follow(e)}follow(e){const{angle:t}=this.stateMachine.context,a=ti(t).multiply(this.entity.stats.speed*e);this.entity.position=this.entity.position.add(a),this.entity.rotation=t*180/Math.PI+90}}class Wn extends J{constructor(){super(...arguments);I(this,"lastAngle",0);I(this,"rotationOffset",90)}update(t){const{target:i}=this.stateMachine.context;i!=null&&i.isInteractable?this.followTarget(t,i):this.stateMachine.setState("FollowAngle",{angle:this.lastAngle})}getTopMiddlePoint(t){return si(t.position,t.width,t.height).topMiddle}followTarget(t,i){const a=this.entity.boundingBox.center;this.getTopMiddlePoint(i),this.lastAngle=ko(a,i.boundingBox.center),this.entity.rotation=this.lastAngle*180/Math.PI+this.rotationOffset;const l=ti(this.lastAngle).multiply(this.entity.stats.speed*t);this.entity.position=this.entity.position.add(l)}}class Xn extends J{constructor(e){super(e),this.entity.removeCollider(),this.entity.width=30,this.entity.height=30,this.entity.animation.onFrameChange=t=>{this.entity.scale+=.5},e.owner.stopInteractions()}update(){(!this.entity.animation||this.entity.animation&&this.entity.animation.isComplete)&&(E.get("entityManager").destroy(this.entity.id),this.entity.animation.onFrameChange=()=>{})}}const Jn=Object.freeze(Object.defineProperty({__proto__:null,Explode:Xn,FollowAngle:Yn,FollowTarget:Wn},Symbol.toStringTag,{value:"Module"}));class Kn extends J{update(){}}class el extends J{constructor(e){super(e),E.get("stageManager").gameOver("lose")}}const tl=Object.freeze(Object.defineProperty({__proto__:null,Die:el,Idle:Kn},Symbol.toStringTag,{value:"Module"})),uo=(s,e,t,i={})=>{let a={};e==="enemy"?a=qn:e==="tower"?a=Qn:["projectile","loot"].includes(e)?a=Jn:e==="throne"&&(a=tl);const n=a[t];if(!n)throw new Error(`Invalid entity type: ${e} with name ${t}`);return new n(s,i)};var st,it;class sl{constructor({owner:e,initialState:t,onEnter:i,context:a={}}){c(this,st,m());c(this,it,m());this.owner=e,this.onEnter=i,this.context=a,this.onEnter(t),this.currentState=uo(this,e.type,t,a)}get currentState(){return o(r(this,st))}set currentState(e){g(r(this,st),f(e))}get context(){return o(r(this,it))}set context(e){g(r(this,it),f(e))}update(e,t){this.currentState.update(e,this.owner,t)}setState(e,t={}){e!==this.currentState.name&&(this.onEnter(e),this.context={...this.context,...t},this.currentState=uo(this,this.owner.type,e,t))}}st=new WeakMap,it=new WeakMap;var ot,rt,at,nt,lt,ct,dt,ht,ut,mt,gt,vt,pt,ft,wt,Ct,yt,Tt,bt,Fs;const As=class As{constructor(e,t,{offsetPosition:i,staticSlot:a,width:n,height:l,scale:d,rotation:v,type:y,states:h,initialState:w,onCollide:C,stats:u,upgradeLevel:x,upgrades:p,vfx:B,effects:b,stateToAnimation:T},L){I(this,"id");c(this,ot,m(0));c(this,rt,m(0));c(this,at,m(""));c(this,nt,m(""));c(this,lt,m(0));c(this,ct,m(0));c(this,dt,m([]));c(this,ht,m([]));c(this,ut,m());c(this,mt,m());c(this,gt,m());c(this,vt,m(f({})));c(this,pt,m(0));c(this,ft,m(1));c(this,wt,m(1));c(this,Ct,m(!0));c(this,yt,m(f({})));c(this,Tt,m(-1));c(this,bt,m([]));c(this,Fs,F(()=>this.upgrades.length&&this.upgradeLevel<this.upgrades.length));I(this,"setPosition",e=>{this.position=e});this.id=As.lastId++,this.name=e,this.type=y,this.width=n,this.height=l,this.scale=d||1,this.rotation=v||0,this.position=t,this.offsetPosition=i||null,this.staticSlot=a||null,this.stats={...u},this.upgradeLevel=x||-1,this.upgrades=p||[],this.vfx=B||[],this.effects=b||[],this.stateToAnimation=T||{},this.onCollide=M=>C(this,M);const j=M=>{this.stateToAnimation[M]&&this.setAnimation(M)};this.state=new sl({owner:this,states:h,initialState:w,onEnter:j,context:L})}get x(){return o(r(this,ot))}set x(e){g(r(this,ot),f(e))}get y(){return o(r(this,rt))}set y(e){g(r(this,rt),f(e))}get name(){return o(r(this,at))}set name(e){g(r(this,at),f(e))}get type(){return o(r(this,nt))}set type(e){g(r(this,nt),f(e))}get width(){return o(r(this,lt))}set width(e){g(r(this,lt),f(e))}get height(){return o(r(this,ct))}set height(e){g(r(this,ct),f(e))}get effects(){return o(r(this,dt))}set effects(e){g(r(this,dt),e)}get vfx(){return o(r(this,ht))}set vfx(e){g(r(this,ht),e)}get animation(){return o(r(this,ut))}set animation(e){g(r(this,ut),e)}get position(){return o(r(this,mt))}set position(e){g(r(this,mt),f(e))}get state(){return o(r(this,gt))}set state(e){g(r(this,gt),f(e))}get stats(){return o(r(this,vt))}set stats(e){g(r(this,vt),f(e))}get rotation(){return o(r(this,pt))}set rotation(e){g(r(this,pt),f(e))}get scale(){return o(r(this,ft))}set scale(e){g(r(this,ft),f(e))}get opacity(){return o(r(this,wt))}set opacity(e){g(r(this,wt),f(e))}get isInteractable(){return o(r(this,Ct))}set isInteractable(e){g(r(this,Ct),f(e))}get stateToAnimation(){return o(r(this,yt))}set stateToAnimation(e){g(r(this,yt),f(e))}get upgradeLevel(){return o(r(this,Tt))}set upgradeLevel(e){g(r(this,Tt),f(e))}get upgrades(){return o(r(this,bt))}set upgrades(e){g(r(this,bt),e)}get isUpgradable(){return o(r(this,Fs))}get boundingBox(){const e=this.position.x,t=this.position.y,i=this.position.x+this.width,a=this.position.y+this.height;return{x1:e,y1:t,x2:i,y2:a,center:new Q(e+this.width/2,t+this.height/2),topMiddle:new Q(e+this.width/2,a)}}update(e){this.isDestroyed||(this.state.update(e),this.effects.forEach(t=>{t(this)}),this.animation&&this.animation.update(e))}setAnimation(e){const t=this.stateToAnimation[e],i=Te(t);this.animation=new Lo({...i,name:t})}addEffect(e){this.effects.includes(e)||(this.effects=[...this.effects,e])}removeEffect(e){this.effects=this.effects.filter(t=>t!==e)}cleanEffects(){this.effects=[]}addVFX(e){this.vfx.includes(e)||(this.vfx=[...this.vfx,e])}removeVFX(e){this.vfx=this.vfx.filter(t=>t!==e)}cleanVFX(){this.vfx=[]}takeDamage(e){this.stats.health-=e,this.stats.health<=0&&this.state.setState("Die")}stopInteractions(){this.isInteractable=!1}removeCollider(){this.onCollide=()=>{}}};ot=new WeakMap,rt=new WeakMap,at=new WeakMap,nt=new WeakMap,lt=new WeakMap,ct=new WeakMap,dt=new WeakMap,ht=new WeakMap,ut=new WeakMap,mt=new WeakMap,gt=new WeakMap,vt=new WeakMap,pt=new WeakMap,ft=new WeakMap,wt=new WeakMap,Ct=new WeakMap,yt=new WeakMap,Tt=new WeakMap,bt=new WeakMap,Fs=new WeakMap,I(As,"lastId",0);let Gs=As;const il=(s,e,t={})=>{const{context:i={},...a}=Rn(s),{initialState:n,...l}=t;return n&&(a.initialState=n),new Gs(s,e.clone(),a,{...i,...l})},ol=F(()=>({top:[{x:P.width*.1,y:20},{x:P.width*.3,y:20},{x:P.width*.5,y:20},{x:P.width*.7,y:20},{x:P.width*.9,y:20}],bottom:[{x:P.width*.1,y:P.height-20},{x:P.width*.3,y:P.height-20},{x:P.width*.5,y:P.height-20},{x:P.width*.7,y:P.height-20},{x:P.width*.9,y:P.height-20}],left:[{x:20,y:P.height*.1},{x:20,y:P.height*.3},{x:20,y:P.height*.5},{x:20,y:P.height*.7},{x:20,y:P.height*.9}],right:[{x:P.width-20,y:P.height*.1},{x:P.width-20,y:P.height*.3},{x:P.width-20,y:P.height*.5},{x:P.width-20,y:P.height*.7},{x:P.width-20,y:P.height*.9}]})),rl=()=>{const s=P.isMobile?["top","bottom"]:["top","bottom","left","right"],e=s[Math.floor(Math.random()*s.length)],t=o(ol)[e];return t[Math.floor(Math.random()*t.length)]},al=s=>s[Math.floor(Math.random()*s.length)];var xt,Bs,_t,Ft;class nl{constructor(){c(this,xt,m(0));c(this,Bs,F(()=>no[this.stageNumber]));c(this,_t,m(0));I(this,"commonSpawnCd");I(this,"eliteSpawnCd");c(this,Ft,m(""));I(this,"init",()=>{const e=E.get("gameLoop");this.commonSpawnCd=e.setCD(this.stageConfig.spawnDelays.common,!0),this.eliteSpawnCd=e.setCD(this.stageConfig.spawnDelays.elite,!0),this.spawnTowers(),this.spawnEntity("Throne",new Q(0,0))});I(this,"update",e=>{const t=E.get("gameLoop");t.isCDReady(this.commonSpawnCd)&&this.spawnEnemy("common"),t.isCDReady(this.eliteSpawnCd)&&this.spawnEnemy("elite"),this.checkStageTime()});I(this,"spawnEntity",(e,t,i={})=>{const a=E.get("entityManager"),n=il(e,t,i);return a.add(n),n})}get stageNumber(){return o(r(this,xt))}set stageNumber(e){g(r(this,xt),f(e))}get stageConfig(){return o(r(this,Bs))}get stageStartTime(){return o(r(this,_t))}set stageStartTime(e){g(r(this,_t),f(e))}get stageResult(){return o(r(this,Ft))}set stageResult(e){g(r(this,Ft),f(e))}reset(){this.commonSpawnCd=null,this.eliteSpawnCd=null,this.stageNumber=0,this.stageResult="",this.init()}spawnTowers(){["IceTower","FireTower","PoisonTower","ThunderTower"].forEach((e,t)=>{this.spawnEntity(e,new Q(0,0))})}apllyAmlify(e){const{statsAmplify:t}=this.stageConfig;e.stats.health*=t.health,e.stats.damage*=t.damage,e.stats.speed*=t.speed}spawnEnemy(e){const t=E.get("entityManager"),i=e==="common"?this.stageConfig.commonEnemies:this.stageConfig.eliteEnemies,a=al(i),n=rl(),l=new Q(n.x,n.y),d=this.spawnEntity(a,l,{throne:t.throne});return this.apllyAmlify(d),d}spawnLoot(e){const i=E.get("entityManager").throne;this.spawnEntity("Loot",e.boundingBox.center,{target:i})}gameOver(e){this.stageResult=e,E.get("gameLoop").pause()}checkStageTime(){const e=E.get("gameLoop");this.stageStartTime+this.stageConfig.time<e.elapsedTime&&this.nextStage()}nextStage(){if(this.stageNumber<no.length-1){const e=E.get("gameLoop");this.stageNumber++,this.stageStartTime=e.elapsedTime,this.commonSpawnCd=e.setCD(this.stageConfig.spawnDelays.common,!0),this.eliteSpawnCd=e.setCD(this.stageConfig.spawnDelays.elite,!0)}else this.gameOver("win")}}xt=new WeakMap,Bs=new WeakMap,_t=new WeakMap,Ft=new WeakMap;const Ns=16.666;var At,Bt,Mt,Et,St,Dt;const Ms=class Ms{constructor(){c(this,At,m(f(performance.now())));c(this,Bt,m(0));c(this,Mt,m(0));c(this,Et,m(1));c(this,St,m(null));c(this,Dt,m(f({})));this.loop=this.loop.bind(this),this.previousTime=0,this.elapsedTime=0,this.accumulator=0}get previousTime(){return o(r(this,At))}set previousTime(e){g(r(this,At),f(e))}get accumulator(){return o(r(this,Bt))}set accumulator(e){g(r(this,Bt),f(e))}get elapsedTime(){return o(r(this,Mt))}set elapsedTime(e){g(r(this,Mt),f(e))}get timeScale(){return o(r(this,Et))}set timeScale(e){g(r(this,Et),f(e))}get pauseState(){return o(r(this,St))}set pauseState(e){g(r(this,St),f(e))}get cooldowns(){return o(r(this,Dt))}set cooldowns(e){g(r(this,Dt),f(e))}get elapsedInSeconds(){return this.elapsedTime/1e3}start(e){this.update=e,requestAnimationFrame(this.loop)}reset(){this.previousTime=0,this.elapsedTime=0,this.accumulator=0}loop(e){if(this.pauseState){this.previousTime=e,requestAnimationFrame(this.loop);return}let t=e-this.previousTime;for(t>250&&(t=250),this.previousTime=e,this.accumulator+=t*this.timeScale,this.elapsedTime+=t*this.timeScale;this.accumulator>=Ns;)this.update(Ns),this.accumulator-=Ns;requestAnimationFrame(this.loop)}setCD(e,t=!1){const i=Ms.lastCDId++;return this.cooldowns[i]={waitTime:e,isInfinite:t,startTime:this.elapsedTime},i}isCDReady(e){const t=this.cooldowns[e];return!t||this.pauseState||this.elapsedTime-t.startTime<=t.waitTime?!1:t.isInfinite?(this.cooldowns[e]={...t,startTime:this.elapsedTime},!0):(delete this.cooldowns[e],!0)}pause(){this.pauseState?this.resume():this.pauseState={pausedTime:this.elapsedTime}}resume(){if(!this.pauseState)return;const e=performance.now();this.previousTime=e,this.pauseState=null}};At=new WeakMap,Bt=new WeakMap,Mt=new WeakMap,Et=new WeakMap,St=new WeakMap,Dt=new WeakMap,I(Ms,"lastCDId",0);let zs=Ms;const ll=[{id:"q1",question:"What is the capital of France?",options:["London","Berlin","Paris","Madrid"],correctIndex:2,meta:{subject:"Geography",level:"Easy"}},{id:"q2",question:"What is 12 * 12?",options:["122","144","124","148"],correctIndex:1,meta:{subject:"Math",level:"Medium"}},{id:"q3",question:"Which planet is known as the Red Planet?",options:["Earth","Mars","Jupiter","Venus"],correctIndex:1,meta:{subject:"Astronomy",level:"Easy"}},{id:"q4",question:"What is the chemical symbol for Gold?",options:["Au","Ag","Fe","Cu"],correctIndex:0,meta:{subject:"Chemistry",level:"Medium"}},{id:"q5",question:"Who wrote 'Romeo and Juliet'?",options:["Charles Dickens","William Shakespeare","Mark Twain","Jane Austen"],correctIndex:1,meta:{subject:"Literature",level:"Easy"}},{id:"q6",question:"What is the square root of 64?",options:["6","7","8","9"],correctIndex:2,meta:{subject:"Math",level:"Easy"}},{id:"q7",question:"Physics: What is the unit of force?",options:["Joule","Watt","Newton","Pascal"],correctIndex:2,meta:{subject:"Physics",level:"Medium"}},{id:"q8",question:"Which element has the atomic number 1?",options:["Helium","Hydrogen","Lithium","Carbon"],correctIndex:1,meta:{subject:"Chemistry",level:"Easy"}},{id:"q9",question:"What year did World War II end?",options:["1942","1945","1948","1950"],correctIndex:1,meta:{subject:"History",level:"Hard"}},{id:"q10",question:"What is the largest ocean on Earth?",options:["Atlantic","Indian","Arctic","Pacific"],correctIndex:3,meta:{subject:"Geography",level:"Medium"}}];var Lt,kt,Pt,jt,It,$t,Ht,Rt,Ut,Nt;class Ho{constructor(){c(this,Lt,m(f(ll)));c(this,kt,m(null));c(this,Pt,m(!1));c(this,jt,m(1));c(this,It,m(0));c(this,$t,m(0));c(this,Ht,m(0));c(this,Rt,m(0));c(this,Ut,m(0));c(this,Nt,m(!1));this.reset()}get questions(){return o(r(this,Lt))}set questions(e){g(r(this,Lt),f(e))}get currentQuestion(){return o(r(this,kt))}set currentQuestion(e){g(r(this,kt),f(e))}get isActive(){return o(r(this,Pt))}set isActive(e){g(r(this,Pt),f(e))}get timeScale(){return o(r(this,jt))}set timeScale(e){g(r(this,jt),f(e))}get timer(){return o(r(this,It))}set timer(e){g(r(this,It),f(e))}get strikes(){return o(r(this,$t))}set strikes(e){g(r(this,$t),f(e))}get gameTimeSinceLastQuestion(){return o(r(this,Ht))}set gameTimeSinceLastQuestion(e){g(r(this,Ht),f(e))}get buildPoints(){return o(r(this,Rt))}set buildPoints(e){g(r(this,Rt),f(e))}get wrongAnswerTrigger(){return o(r(this,Ut))}set wrongAnswerTrigger(e){g(r(this,Ut),f(e))}get distortedAudio(){return o(r(this,Nt))}set distortedAudio(e){g(r(this,Nt),f(e))}reset(){this.isActive=!1,this.timeScale=1,this.strikes=0,this.buildPoints=0,this.gameTimeSinceLastQuestion=W.questionInterval-W.initialQuestionDelay,this.currentQuestion=null}update(e){if(!this.isActive)this.gameTimeSinceLastQuestion+=e,this.gameTimeSinceLastQuestion>=W.questionInterval&&this.triggerQuestion();else{const t=e/this.timeScale;this.timer-=t,this.timer<=0&&this.handleTimeout()}}triggerQuestion(){const e=Math.floor(Math.random()*this.questions.length);this.currentQuestion=this.questions[e],this.isActive=!0,this.timeScale=W.bulletTimeFactor,E.get("gameLoop").timeScale=this.timeScale,this.timer=W.questionDuration,this.gameTimeSinceLastQuestion=0,this.distortedAudio=!0,H.setDistortion(!0)}answer(e){if(!this.currentQuestion)return;e===this.currentQuestion.correctIndex?this.handleCorrect():this.handleIncorrect(),this.closeQuestion()}handleCorrect(){if(this.buildPoints>=8){console.log("Correct! Max Points Reached -> +10 Gold");const e=E.get("lootTracker");e&&e.receiveLoot(10),H.play("towerUpgrade")}else console.log("Correct! +1 Build Point"),this.buildPoints++,H.play("towerUpgrade")}handleIncorrect(){console.log("Wrong!"),this.wrongAnswerTrigger++,H.play("lowResourse"),this.strikes++,this.strikes>=W.maxStrikes&&(this.punishPlayer(),this.strikes=0)}handleTimeout(){this.handleIncorrect(),this.closeQuestion()}punishPlayer(){var a,n;console.log("PUNISHMENT: Destroying Tower");const{entityManager:e}=E.get(["entityManager"]),i=e.towers.filter(l=>l.state.currentState!=="NotBuilt"&&l.type!=="throne");if(i.length>0){const l=i[0];console.log(`Destroying tower: ${l.name}`);const d=oi[l.name];d&&(l.stats={...d.stats},l.stateToAnimation={...d.stateToAnimation}),l.upgradeLevel=-1,l.state.setState("NotBuilt");const v=E.get("particleManager"),y=((a=l.position)==null?void 0:a.x)??l.x,h=((n=l.position)==null?void 0:n.y)??l.y;v&&v.spawnExplosion(y+l.width/2,h+l.height/2,"#ff0000",30)}}closeQuestion(){this.isActive=!1,this.timeScale=1,E.get("gameLoop").timeScale=1,this.currentQuestion=null,this.distortedAudio=!1,H.setDistortion(!1)}}Lt=new WeakMap,kt=new WeakMap,Pt=new WeakMap,jt=new WeakMap,It=new WeakMap,$t=new WeakMap,Ht=new WeakMap,Rt=new WeakMap,Ut=new WeakMap,Nt=new WeakMap;new Ho;var qt,Vt,Ot,Zt,Gt,zt,Qt;class cl{constructor(e,t,i){c(this,qt,m(0));c(this,Vt,m(0));c(this,Ot,m(0));c(this,Zt,m(0));c(this,Gt,m(1));c(this,zt,m("#ff0000"));c(this,Qt,m(5));I(this,"decay",.05);this.x=e,this.y=t,this.color=i;const a=Math.random()*Math.PI*2,n=Math.random()*5+2;this.vx=Math.cos(a)*n,this.vy=Math.sin(a)*n,this.size=Math.random()*6+4,this.decay=Math.random()*.03+.02}get x(){return o(r(this,qt))}set x(e){g(r(this,qt),f(e))}get y(){return o(r(this,Vt))}set y(e){g(r(this,Vt),f(e))}get vx(){return o(r(this,Ot))}set vx(e){g(r(this,Ot),f(e))}get vy(){return o(r(this,Zt))}set vy(e){g(r(this,Zt),f(e))}get life(){return o(r(this,Gt))}set life(e){g(r(this,Gt),f(e))}get color(){return o(r(this,zt))}set color(e){g(r(this,zt),f(e))}get size(){return o(r(this,Qt))}set size(e){g(r(this,Qt),f(e))}update(e){this.x+=this.vx,this.y+=this.vy,this.life-=this.decay,this.size*=.95}}qt=new WeakMap,Vt=new WeakMap,Ot=new WeakMap,Zt=new WeakMap,Gt=new WeakMap,zt=new WeakMap,Qt=new WeakMap;var Yt;class dl{constructor(){c(this,Yt,m(f([])))}get particles(){return o(r(this,Yt))}set particles(e){g(r(this,Yt),f(e))}update(e){this.particles=this.particles.filter(t=>t.life>0);for(const t of this.particles)t.update(e)}spawnExplosion(e,t,i="#ff4400",a=10){for(let n=0;n<a;n++)this.particles.push(new cl(e,t,i))}}Yt=new WeakMap;var Wt;class hl{constructor(){c(this,Wt,m(!1));I(this,"update",async e=>{E.update(e),O.update(e)});I(this,"start",async()=>{E.setup(ul());const{gameLoop:e,stageManager:t,questionManager:i}=E.get(["gameLoop","stageManager","questionManager"]);t.init(),i.reset(),e.start(this.update),H.play("bgSound"),this.isStarted=!0});I(this,"restart",()=>{const{entityManager:e,gameLoop:t,stageManager:i,questionManager:a}=E.get(["entityManager","gameLoop","stageManager","questionManager"]);t.reset(),e.reset(),i.reset(),H.reset(),re.reset(),a.reset(),t.resume()})}get isStarted(){return o(r(this,Wt))}set isStarted(e){g(r(this,Wt),f(e))}}Wt=new WeakMap;const ul=()=>(E.collisionManager=new Dn,E.entityManager=new Ln,E.gameLoop=new zs,E.stageManager=new nl,E.questionManager=new Ho,E.particleManager=new dl,E),ye=new hl;var ml=Qs('<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M11.999 1C5.926 1 1 5.925 1 12c0 4.86 3.152 8.983 7.523 10.437c.55.102.75-.238.75-.53c0-.26-.009-.952-.014-1.87c-3.06.664-3.706-1.475-3.706-1.475c-.5-1.27-1.221-1.61-1.221-1.61c-.999-.681.075-.668.075-.668c1.105.078 1.685 1.134 1.685 1.134c.981 1.68 2.575 1.195 3.202.914c.1-.71.384-1.195.698-1.47c-2.442-.278-5.01-1.222-5.01-5.437c0-1.2.428-2.183 1.132-2.952c-.114-.278-.491-1.397.108-2.91c0 0 .923-.297 3.025 1.127A10.5 10.5 0 0 1 12 6.32a10.5 10.5 0 0 1 2.754.37c2.1-1.424 3.022-1.128 3.022-1.128c.6 1.514.223 2.633.11 2.911c.705.769 1.13 1.751 1.13 2.952c0 4.226-2.572 5.156-5.022 5.428c.395.34.747 1.01.747 2.037c0 1.47-.014 2.657-.014 3.017c0 .295.199.637.756.53C19.851 20.979 23 16.859 23 12c0-6.075-4.926-11-11.001-11"></path></svg>');function gl(s){var e=ml();S(s,e)}var vl=$('<div class="content svelte-6i2tvj"><div class="header svelte-6i2tvj"><a href="https://github.com/baterson/svelte-tower-defence" class="git-link svelte-6i2tvj"><!></a></div> <div class="title svelte-6i2tvj"><h1>Paused</h1></div> <div class="buttons-container svelte-6i2tvj"><!> <!> <!></div></div>'),pl=$('<div class="pause-overlay svelte-6i2tvj"><!></div>');function fl(s,e){Z(e,!0);const t=()=>{H.toggleMute()};Js(()=>{H.reduceBgVolume()}),Ao(()=>{H.restoreBgVolume()});var i=pl(),a=A(i);ii(a,{children:(n,l)=>{var d=vl(),v=A(d),y=A(v),h=A(y);gl(h),_(y),_(v);var w=D(v,4),C=A(w);pe(C,{text:"Resume Game",get onclick(){return e.onResume}});var u=D(C,2);pe(u,{text:"Restart Game",get onclick(){return e.onRestart}});var x=D(u,2),p=F(()=>H.isMuted?"Sound: OFF":"Sound: ON");pe(x,{get text(){return o(p)},onclick:t}),_(w),_(d),S(n,d)},$$slots:{default:!0}}),_(i),S(s,i),G()}var wl=$('<div class="bg-container svelte-11qp6pd"><div class="gradient-bg svelte-11qp6pd"></div> <div class="stars svelte-11qp6pd"></div></div>');function mo(s){var e=wl();S(s,e)}var Cl=$('<div class="bg-container svelte-1hdxkm"><div class="gradient-bg svelte-1hdxkm"></div> <div class="aurora svelte-1hdxkm"></div> <div class="stars svelte-1hdxkm"></div></div>');function yl(s){var e=Cl();S(s,e)}var Tl=$('<div class="bg-container svelte-7703io"><div class="gradient-bg svelte-7703io"></div> <div class="stars svelte-7703io"></div></div>');function bl(s){var e=Tl();S(s,e)}var xl=$('<div class="bg-container svelte-10mh7j2"><div class="quantum-base svelte-10mh7j2"></div> <div class="energy-fields svelte-10mh7j2"></div> <div class="quantum-grid svelte-10mh7j2"></div> <div class="stars svelte-10mh7j2"></div></div>');function _l(s){var e=xl();S(s,e)}var Fl=$('<div class="background-container svelte-5o0ex9"><!></div>');function Al(s,e){const t=[mo,yl,bl,_l];let i=F(()=>t[e.stageNumber]||mo);var a=ie(),n=Y(a);qs(n,()=>e.stageNumber,l=>{var d=Fl(),v=A(d);Tr(v,()=>o(i),(y,h)=>{h(y,{})}),_(d),K(1,d,()=>he,()=>({duration:400})),K(2,d,()=>he,()=>({duration:300})),S(l,d)}),S(s,a)}var Bl=$('<div class="loot svelte-bipu4"><!> <span class="svelte-bipu4"> </span></div>');function Ml(s,e){Z(e,!0);let t=F(()=>re.playLowLootAnimation);var i=Bl();const a=F(()=>O.get("arrow"));R(()=>U(i,"cursor",o(a)));var n=A(i);be(n,{});var l=D(n,2);const d=F(()=>O.get("arrow"));R(()=>U(l,"cursor",o(d)));var v=A(l,!0);_(l),_(i),R(()=>{ve(i,"isAnimated",o(t)),oe(v,re.collectedLoot)}),Ds("animationend",i,y=>{re.unsetAnimation("LowLoot")}),S(s,i),G()}var El=Qs('<svg width="54" height="54" viewBox="0 0 54 54" fill="none" xmlns="http://www.w3.org/2000/svg"><mask id="path-1-outside-1_0_1" maskUnits="userSpaceOnUse" x="0" y="0" width="54" height="54" fill="black"><rect fill="white" width="54" height="54"></rect><path d="M50.0898 37.7747C50.35 37.8961 50.66 37.7837 50.7762 37.5211C53.2068 32.0286 53.6627 25.8578 52.0564 20.0591C50.4038 14.0933 46.6768 8.91281 41.5457 5.44952C36.4146 1.98623 30.2161 0.467392 24.0651 1.16617C17.9142 1.86495 12.2144 4.7355 7.99089 9.26151C3.76741 13.7875 1.29741 19.672 1.02516 25.8565C0.7529 32.0411 2.69625 38.1198 6.50568 42.9995C10.3151 47.8791 15.7406 51.2394 21.8064 52.476C27.7021 53.6779 33.8267 52.7968 39.1382 49.9927C39.3922 49.8586 39.4829 49.5416 39.3438 49.2904C39.2047 49.0392 38.8884 48.9488 38.6343 49.0827C33.5395 51.767 27.6672 52.6094 22.0141 51.457C16.191 50.2698 10.9825 47.0439 7.32545 42.3595C3.6684 37.675 1.80279 31.8394 2.06415 25.9023C2.32552 19.9651 4.69671 14.316 8.75126 9.97105C12.8058 5.62608 18.2776 2.87036 24.1825 2.19953C30.0875 1.5287 36.038 2.98679 40.9639 6.31154C45.8897 9.6363 49.4677 14.6095 51.0542 20.3368C52.5943 25.8968 52.1595 31.8132 49.8335 37.0813C49.7175 37.344 49.8295 37.6532 50.0898 37.7747Z"></path></mask><path d="M50.0898 37.7747C50.35 37.8961 50.66 37.7837 50.7762 37.5211C53.2068 32.0286 53.6627 25.8578 52.0564 20.0591C50.4038 14.0933 46.6768 8.91281 41.5457 5.44952C36.4146 1.98623 30.2161 0.467392 24.0651 1.16617C17.9142 1.86495 12.2144 4.7355 7.99089 9.26151C3.76741 13.7875 1.29741 19.672 1.02516 25.8565C0.7529 32.0411 2.69625 38.1198 6.50568 42.9995C10.3151 47.8791 15.7406 51.2394 21.8064 52.476C27.7021 53.6779 33.8267 52.7968 39.1382 49.9927C39.3922 49.8586 39.4829 49.5416 39.3438 49.2904C39.2047 49.0392 38.8884 48.9488 38.6343 49.0827C33.5395 51.767 27.6672 52.6094 22.0141 51.457C16.191 50.2698 10.9825 47.0439 7.32545 42.3595C3.6684 37.675 1.80279 31.8394 2.06415 25.9023C2.32552 19.9651 4.69671 14.316 8.75126 9.97105C12.8058 5.62608 18.2776 2.87036 24.1825 2.19953C30.0875 1.5287 36.038 2.98679 40.9639 6.31154C45.8897 9.6363 49.4677 14.6095 51.0542 20.3368C52.5943 25.8968 52.1595 31.8132 49.8335 37.0813C49.7175 37.344 49.8295 37.6532 50.0898 37.7747Z" fill="#D685DA"></path><path d="M50.0898 37.7747C50.35 37.8961 50.66 37.7837 50.7762 37.5211C53.2068 32.0286 53.6627 25.8578 52.0564 20.0591C50.4038 14.0933 46.6768 8.91281 41.5457 5.44952C36.4146 1.98623 30.2161 0.467392 24.0651 1.16617C17.9142 1.86495 12.2144 4.7355 7.99089 9.26151C3.76741 13.7875 1.29741 19.672 1.02516 25.8565C0.7529 32.0411 2.69625 38.1198 6.50568 42.9995C10.3151 47.8791 15.7406 51.2394 21.8064 52.476C27.7021 53.6779 33.8267 52.7968 39.1382 49.9927C39.3922 49.8586 39.4829 49.5416 39.3438 49.2904C39.2047 49.0392 38.8884 48.9488 38.6343 49.0827C33.5395 51.767 27.6672 52.6094 22.0141 51.457C16.191 50.2698 10.9825 47.0439 7.32545 42.3595C3.6684 37.675 1.80279 31.8394 2.06415 25.9023C2.32552 19.9651 4.69671 14.316 8.75126 9.97105C12.8058 5.62608 18.2776 2.87036 24.1825 2.19953C30.0875 1.5287 36.038 2.98679 40.9639 6.31154C45.8897 9.6363 49.4677 14.6095 51.0542 20.3368C52.5943 25.8968 52.1595 31.8132 49.8335 37.0813C49.7175 37.344 49.8295 37.6532 50.0898 37.7747Z" stroke="white" stroke-width="2" mask="url(#path-1-outside-1_0_1)"></path><circle cx="27" cy="27" r="16.5" fill="#D685DA" stroke="white"></circle><circle cx="45" cy="44" r="4.5" fill="#D685DA" stroke="white"></circle><rect x="20.5" y="20.5" width="5" height="13" rx="2.5" fill="#FFDFFC" stroke="white"></rect><rect x="28.5" y="20.5" width="5" height="13" rx="2.5" fill="#FFDFFC" stroke="white"></rect></svg>');function Sl(s){var e=El();S(s,e)}var Dl=$('<div class="meta-tag svelte-rnoh95"> </div>'),Ll=$('<div class="option-wrapper"><!></div>'),kl=$('<div class="overlay svelte-rnoh95"><div class="backdrop svelte-rnoh95"></div> <div class="content svelte-rnoh95"><h2 class="question-header">Quick! Answer this:</h2> <div class="timer-bar svelte-rnoh95"></div> <div class="question-box svelte-rnoh95"><p class="question-text svelte-rnoh95"> </p> <!></div> <div class="options-grid svelte-rnoh95"></div> <div class="status-bar svelte-rnoh95"><span class="strikes"> </span></div></div></div>');function Pl(s,e){Z(e,!0);const t=F(()=>E.get("questionManager")),i=F(()=>{var v;return(v=o(t))==null?void 0:v.currentQuestion}),a=F(()=>o(t)?o(t).timer/1e4*100:0);var n=ie(),l=Y(n);{var d=v=>{var y=kl(),h=D(A(y),2),w=D(A(h),2),C=D(w,2),u=A(C),x=A(u,!0);_(u);var p=D(u,2);{var B=M=>{var k=Dl(),V=A(k);_(k),R(()=>oe(V,`${o(i).meta.subject??""}  ${o(i).meta.level??""}`)),S(M,k)};X(p,M=>{o(i).meta&&M(B)})}_(C);var b=D(C,2);te(b,21,()=>o(i).options,ei,(M,k,V)=>{var q=Ll(),N=A(q);pe(N,{onclick:()=>o(t).answer(V),get text(){return o(k)}}),_(q),S(M,q)}),_(b);var T=D(b,2),L=A(T),j=A(L);_(L),_(T),_(h),_(y),R(()=>{de(w,"style",`width: ${o(a)??""}%`),oe(x,o(i).question),oe(j,`Strikes: ${o(t).strikes??""} / 3`)}),K(3,y,()=>he,()=>({duration:200})),S(v,y)};X(l,v=>{o(t)&&o(t).isActive&&o(i)&&v(d)})}S(s,n),G()}var jl=$('<div class="floating-text svelte-10t94eg">+1 BP</div>'),Il=$('<div class="points-badge svelte-10t94eg"><div class="badge-content svelte-10t94eg"><span class="icon svelte-10t94eg"></span> <span class="count svelte-10t94eg"> </span> <span class="text svelte-10t94eg">Builds Available</span></div> <!></div>'),$l=$('<div class="indicator-container svelte-10t94eg"><div class="timer-section svelte-10t94eg"><div class="label svelte-10t94eg">Next Chance:</div> <div class="progress-bar-bg svelte-10t94eg"><div class="progress-bar-fill svelte-10t94eg"></div></div></div> <!></div>');function Hl(s,e){Z(e,!0);const t=F(()=>E.get("questionManager")),i=F(()=>o(t)?Math.min(100,o(t).gameTimeSinceLastQuestion/W.questionInterval*100):0),a=F(()=>{var h;return((h=o(t))==null?void 0:h.buildPoints)||0});let n=0,l=m(!1);Ss(()=>{o(t)&&(o(t).buildPoints>n&&(g(l,!0),setTimeout(()=>g(l,!1),1500)),n=o(t).buildPoints)});var d=ie(),v=Y(d);{var y=h=>{var w=$l(),C=A(w),u=D(A(C),2),x=A(u);_(u),_(C);var p=D(C,2);{var B=b=>{var T=Il(),L=A(T),j=D(A(L),2),M=A(j,!0);_(j),gr(2),_(L);var k=D(L,2);{var V=q=>{var N=jl();S(q,N)};X(k,q=>{o(l)&&q(V)})}_(T),R(()=>{ve(T,"has-points",o(a)>0),oe(M,o(a))}),K(1,T,()=>ao,()=>({duration:300,start:.5,opacity:0})),K(2,T,()=>ao,()=>({duration:200,start:.8,opacity:0})),S(b,T)};X(p,b=>{o(a)>0&&b(B)})}_(w),R(()=>de(x,"style",`width: ${o(i)??""}%`)),S(h,w)};X(v,h=>{o(t)&&!o(t).isActive&&h(y)})}S(s,d),G()}var Rl=$("<div><!> <!></div>");function Ul(s,e){Z(e,!0);let t=m(0),i=0,a=-1;Ss(()=>{const d=E.get("questionManager");d&&d.wrongAnswerTrigger!==a&&(a!==-1&&vr(t),a=d.wrongAnswerTrigger);const v=E.get("entityManager");v&&v.throne});var n=ie(),l=Y(n);qs(l,()=>o(t),d=>{var v=Rl(),y=A(v);br(y,e,"default",{});var h=D(y,2);qs(h,()=>i,w=>{var C=ie(),u=Y(C);X(u,x=>{}),S(w,C)}),_(v),R(()=>Mr(v,`feedback-layer ${(o(t)>0?"shake-effect":"")??""} svelte-10dqr7b`)),S(d,v)}),S(s,n),G()}const Nl=["/projectiles/Click/0.svg","/projectiles/Click/1.svg","/projectiles/Click/2.svg","/projectiles/Click/3.svg","/projectiles/Fireball/Die/0.svg","/projectiles/Fireball/Die/1.svg","/projectiles/Fireball/Die/2.svg","/projectiles/Fireball/Follow/0.svg","/projectiles/Fireball/Follow/1.svg","/projectiles/Fireball/Follow/2.svg","/projectiles/Fireball/Follow/3.svg","/projectiles/Icebolt/Die/0.svg","/projectiles/Icebolt/Die/1.svg","/projectiles/Icebolt/Die/2.svg","/projectiles/Icebolt/Follow/0.svg","/projectiles/Icebolt/Follow/1.svg","/projectiles/Poisonball/Die/0.svg","/projectiles/Poisonball/Die/1.svg","/projectiles/Poisonball/Die/2.svg","/projectiles/Poisonball/Follow/0.svg","/projectiles/Poisonball/Follow/1.svg","/projectiles/Poisonball/Follow/2.svg","/projectiles/Poisonball/Follow/3.svg","/projectiles/Thunderbolt/Die/0.svg","/projectiles/Thunderbolt/Die/1.svg","/projectiles/Thunderbolt/Die/2.svg","/projectiles/Thunderbolt/Follow/0.svg","/projectiles/Thunderbolt/Follow/1.svg","/projectiles/Thunderbolt/Follow/2.svg","/projectiles/Thunderbolt/Follow/3.svg","/enemies/BlueCommon/Follow/0.svg","/enemies/BlueCommon/Follow/1.svg","/enemies/BlueCommon/Follow/2.svg","/enemies/BlueCommon/Die/0.svg","/enemies/BlueCommon/Die/1.svg","/enemies/BlueCommon/Die/2.svg","/enemies/BlueCommon/Follow/0.svg","/enemies/BlueCommon/Follow/1.svg","/enemies/BlueCommon/Follow/2.svg","/enemies/BlueCommon/Die/0.svg","/enemies/BlueCommon/Die/1.svg","/enemies/BlueCommon/Die/2.svg","/towers/FireTower/Base0.svg","/towers/FireTower/Base1.svg","/towers/FireTower/Base2.svg","/towers/FireTower/Upgrade1.svg","/towers/FireTower/Upgrade2.svg","/towers/IceTower/Base0.svg","/towers/IceTower/Base1.svg","/towers/IceTower/Base2.svg","/towers/IceTower/Upgrade1.svg","/towers/IceTower/Upgrade2.svg","/towers/PoisonTower/Base0.svg","/towers/PoisonTower/Base1.svg","/towers/PoisonTower/Base2.svg","/towers/PoisonTower/Upgrade1.svg","/towers/PoisonTower/Upgrade2.svg","/towers/ThunderTower/Base0.svg","/towers/ThunderTower/Base1.svg","/towers/ThunderTower/Base2.svg","/towers/ThunderTower/Upgrade1.svg","/towers/ThunderTower/Upgrade2.svg","/towers/Base.svg","/towers/Upgrade0.svg","/throne.svg","/cursors/cursor-hammer.svg","/cursors/cursor-arrow.svg","/cursors/build0.svg","/cursors/build1.svg","/cursors/build2.svg"],ql=s=>{re.spendLoot({type:"click",payload:{offset:new Q(s.clientX,s.clientY)}})},Vl=(s,e)=>{H.play("clickMenu",!0),o(e).pause()};var Ol=$('<link rel="preload" as="image">'),Zl=$('<div class="window-wrapper"><div class="wrapper svelte-dz30ag"><!> <!> <!> <button tabindex="-1" class="btn-pause svelte-dz30ag"><!></button> <div class="game-container svelte-dz30ag"><!></div></div></div>'),Gl=$("<!> <!> <!>",1);function t2(s,e){Z(e,!0);const t=F(()=>E.get("questionManager")),i=F(()=>E.get("gameLoop")),a=F(()=>E.get("stageManager")),n=u=>{u.key==="Escape"&&(o(i).pauseState?o(i).resume():o(i).pause())};Js(()=>{H.preload()});var l=Gl();Ds("keydown",pr,n),yr(u=>{var x=ie(),p=Y(x);te(p,17,()=>Nl,ei,(B,b)=>{var T=Ol();R(()=>de(T,"href",o(b))),S(B,T)}),S(u,x)});var d=Y(l);{var v=u=>{Sn(u,{onStart:()=>ye.start()})},y=u=>{var x=ie(),p=Y(x);{var B=T=>{An(T,{onRestart:()=>ye.restart()})},b=T=>{var L=ie(),j=Y(L);{var M=k=>{fl(k,{onResume:()=>o(i).resume(),onRestart:()=>ye.restart()})};X(j,k=>{o(i).pauseState&&k(M)},!0)}S(T,L)};X(p,T=>{o(a).stageResult?T(B):T(b,!1)},!0)}S(u,x)};X(d,u=>{ye.isStarted?u(y,!1):u(v)})}var h=D(d,2);{var w=u=>{var x=Zl();x.__click=[ql];const p=F(()=>O.get("arrow"));R(()=>U(x,"cursor",o(p)));var B=A(x),b=A(B);Al(b,{get stageNumber(){return o(a).stageNumber}});var T=D(b,2);Ml(T,{});var L=D(T,2);Hl(L,{});var j=D(L,2);j.__click=[Vl,i];const M=F(()=>O.get("arrow"));R(()=>U(j,"cursor",o(M)));var k=A(j);Sl(k),_(j);var V=D(j,2);U(V,"transform-origin","center");var q=A(V);Ul(q,{children:(N,Ls)=>{wn(N,{})},$$slots:{default:!0}}),_(V),_(B),_(x),R(()=>{var N;return ve(B,"bullet-time",(N=o(t))==null?void 0:N.isActive)}),yi(V,"offsetHeight",N=>P.gameAreaHeight=N),yi(V,"offsetWidth",N=>P.gameAreaWidth=N),S(u,x)};X(h,u=>{ye.isStarted&&H.preloaded&&u(w)})}var C=D(h,2);Pl(C,{}),Ti("innerWidth",u=>P.width=u),Ti("innerHeight",u=>P.height=u),S(s,l),G()}Ks(["click"]);export{t2 as component};
