var _a=Object.defineProperty;var Oi=s=>{throw TypeError(s)};var xa=(s,e,t)=>e in s?_a(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var $=(s,e,t)=>xa(s,typeof e!="symbol"?e+"":e,t),vi=(s,e,t)=>e.has(s)||Oi("Cannot "+t);var n=(s,e,t)=>(vi(s,e,"read from private field"),t?t.call(s):e.get(s)),u=(s,e,t)=>e.has(s)?Oi("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(s):e.set(s,t),fi=(s,e,t,i)=>(vi(s,e,"write to private field"),i?i.call(s,t):e.set(s,t),t),Qi=(s,e,t)=>(vi(s,e,"access private method"),t);import{a as S,t as D,c as ve,n as ri}from"../chunks/disclose-version.CevxcIVZ.js";import{h as oe,a as Wo,at as Fa,au as Ba,s as Ea,J as Mi,af as Yo,X as ni,A as Pe,a7 as Aa,B as Ds,y as Xo,ah as Sa,C as Ma,I as ka,V as Zo,ac as Da,ad as Gi,N as pi,Q as Pa,F as Jo,av as Ps,ae as Ko,x as Is,$ as Ia,a5 as Hi,aw as ki,ax as Vi,ay as La,U as Ra,az as ja,aA as ea,aB as Di,aC as $a,M as qa,w as Na,aD as ta,G as sa,aE as Ua,ab as ia,n as qe,aF as za,aa as Oa,aG as Qa,aH as Ga,aI as Ha,ag as oa,b as aa,aJ as Va,aK as Wa,D as Wi,E as Yi,aL as Ya,aM as Xa,a1 as v,g as o,Y as h,k as B,p as Y,u as Ie,t as I,m as X,aN as Pi,f as se,v as F,o as x,q as C,aO as Ii,aP as Za}from"../chunks/runtime.BL11IQWW.js";import{a as Ja,l as Ka,w as er,e as Qe,r as ra,d as Ge,s as ne,b as tr}from"../chunks/render.BWQL7xXt.js";import{a as b,p as Ee,b as na,i as U,c as sr,s as ir,d as or}from"../chunks/props.C_nab1LJ.js";import{o as li,a as la}from"../chunks/index-client.C4s1iBsW.js";import{b as bi,w as ar}from"../chunks/paths.CGWrhlRi.js";import"../chunks/legacy.BwMg7t2V.js";import{s as rr}from"../chunks/slot.1_vvGQ04.js";function _i(s,e,t){oe&&Wo();var i=s,a=Aa,r,l=Fa()?Ba:Ea;Mi(()=>{l(a,a=e())&&(r&&Yo(r),r=ni(()=>t(i)))}),oe&&(i=Pe)}function $e(s,e){oe&&Ds(Xo(s)),Sa(()=>{var t=e();for(var i in t){var a=t[i];a?s.style.setProperty(i,a):s.style.removeProperty(i)}}),Ma(()=>{s.remove()})}function Ls(s,e){return e}function nr(s,e,t,i){for(var a=[],r=e.length,l=0;l<r;l++)La(e[l].e,a,!0);var c=r>0&&a.length===0&&t!==null;if(c){var g=t.parentNode;Ra(g),g.append(t),i.clear(),Fe(s,e[0].prev,e[r-1].next)}ja(a,()=>{for(var T=0;T<r;T++){var f=e[T];c||(i.delete(f.k),Fe(s,f.prev,f.next)),ea(f.e,!c)}})}function he(s,e,t,i,a,r=null){var l=s,c={flags:e,items:new Map,first:null},g=(e&ta)!==0;if(g){var T=s;l=oe?Ds(Xo(T)):T.appendChild(Na())}oe&&Wo();var f=null,w=!1;Mi(()=>{var p=t(),m=ka(p)?p:p==null?[]:Zo(p),y=m.length;if(w&&y===0)return;w=y===0;let d=!1;if(oe){var E=l.data===Da;E!==(y===0)&&(l=Gi(),Ds(l),pi(!1),d=!0)}if(oe){for(var _=null,A,L=0;L<y;L++){if(Pe.nodeType===8&&Pe.data===Pa){l=Pe,d=!0,pi(!1);break}var q=m[L],M=i(q,L);A=ca(Pe,c,_,null,q,M,L,a,e),c.items.set(M,A),_=A}y>0&&Ds(Gi())}if(!oe){var P=Jo;lr(m,c,l,a,e,(P.f&Ps)!==0,i)}r!==null&&(y===0?f?Ko(f):f=ni(()=>r(l)):f!==null&&Yo(f,()=>{f=null})),d&&pi(!0),t()}),oe&&(l=Pe)}function lr(s,e,t,i,a,r,l,c){var Ae,Se,Le,Me;var g=(a&Ua)!==0,T=(a&(Di|ki))!==0,f=s.length,w=e.items,p=e.first,m=p,y,d=null,E,_=[],A=[],L,q,M,P;if(g)for(P=0;P<f;P+=1)L=s[P],q=l(L,P),M=w.get(q),M!==void 0&&((Ae=M.a)==null||Ae.measure(),(E??(E=new Set)).add(M));for(P=0;P<f;P+=1){if(L=s[P],q=l(L,P),M=w.get(q),M===void 0){var H=m?m.e.nodes_start:t;d=ca(H,e,d,d===null?e.first:d.next,L,q,P,i,a),w.set(q,d),_=[],A=[],m=d.next;continue}if(T&&cr(M,L,P,a),M.e.f&Ps&&(Ko(M.e),g&&((Se=M.a)==null||Se.unfix(),(E??(E=new Set)).delete(M))),M!==m){if(y!==void 0&&y.has(M)){if(_.length<A.length){var O=A[0],Z;d=O.prev;var z=_[0],ae=_[_.length-1];for(Z=0;Z<_.length;Z+=1)Xi(_[Z],O,t);for(Z=0;Z<A.length;Z+=1)y.delete(A[Z]);Fe(e,z.prev,ae.next),Fe(e,d,z),Fe(e,ae,O),m=O,d=ae,P-=1,_=[],A=[]}else y.delete(M),Xi(M,m,t),Fe(e,M.prev,M.next),Fe(e,M,d===null?e.first:d.next),Fe(e,d,M),d=M;continue}for(_=[],A=[];m!==null&&m.k!==q;)(r||!(m.e.f&Ps))&&(y??(y=new Set)).add(m),A.push(m),m=m.next;if(m===null)continue;M=m}_.push(M),d=M,m=M.next}if(m!==null||y!==void 0){for(var Q=y===void 0?[]:Zo(y);m!==null;)(r||!(m.e.f&Ps))&&Q.push(m),m=m.next;var ie=Q.length;if(ie>0){var _e=a&ta&&f===0?t:null;if(g){for(P=0;P<ie;P+=1)(Le=Q[P].a)==null||Le.measure();for(P=0;P<ie;P+=1)(Me=Q[P].a)==null||Me.fix()}nr(e,Q,_e,w)}}g&&sa(()=>{var xe;if(E!==void 0)for(M of E)(xe=M.a)==null||xe.apply()}),Is.first=e.first&&e.first.e,Is.last=d&&d.e}function cr(s,e,t,i){i&Di&&Vi(s.v,e),i&ki?Vi(s.i,t):s.i=t}function ca(s,e,t,i,a,r,l,c,g,T){var f=(g&Di)!==0,w=(g&$a)===0,p=f?w?Ia(a):Hi(a):a,m=g&ki?Hi(l):l,y={i:m,v:p,k:r,a:null,e:null,prev:t,next:i};try{return y.e=ni(()=>c(s,p,m),oe),y.e.prev=t&&t.e,y.e.next=i&&i.e,t===null?e.first=y:(t.next=y,t.e.next=y.e),i!==null&&(i.prev=y,i.e.prev=y.e),y}finally{}}function Xi(s,e,t){for(var i=s.next?s.next.e.nodes_start:t,a=e?e.e.nodes_start:t,r=s.e.nodes_start;r!==i;){var l=qa(r);a.before(r),r=l}}function Fe(s,e,t){e===null?s.first=t:(e.next=t,e.e.next=t&&t.e),t!==null&&(t.prev=e,t.e.prev=e&&e.e)}function dr(s,e,...t){var i=s,a=qe,r;Mi(()=>{a!==(a=e())&&(r&&(ea(r),r=null),r=ni(()=>a(i,...t)))},ia),oe&&(i=Pe)}function K(s,e,t,i){var a=s.__attributes??(s.__attributes={});oe&&(a[e]=s.getAttribute(e),e==="src"||e==="srcset"||e==="href"&&s.nodeName==="LINK")||a[e]!==(a[e]=t)&&(e==="style"&&"__styles"in s&&(s.__styles={}),e==="loading"&&(s[za]=t),t==null?s.removeAttribute(e):typeof t!="string"&&ur(s).includes(e)?s[e]=t:s.setAttribute(e,t))}var Zi=new Map;function ur(s){var e=Zi.get(s.nodeName);if(e)return e;Zi.set(s.nodeName,e=[]);for(var t,i=s,a=Element.prototype;a!==i;){t=Qa(i);for(var r in t)t[r].set&&e.push(r);i=Oa(i)}return e}function da(s,e,t){var i=s.__className,a=hr(e);oe&&s.className===a?s.__className=a:(i!==a||oe&&s.className!==a)&&(e==null?s.removeAttribute("class"):s.className=a,s.__className=a)}function hr(s,e){return(s??"")+""}function Te(s,e,t){if(t){if(s.classList.contains(e))return;s.classList.add(e)}else{if(!s.classList.contains(e))return;s.classList.remove(e)}}function N(s,e,t,i){var a=s.__styles??(s.__styles={});a[e]!==t&&(a[e]=t,t==null?s.style.removeProperty(e):s.style.setProperty(e,t,""))}const mr=()=>performance.now(),ge={tick:s=>requestAnimationFrame(s),now:()=>mr(),tasks:new Set};function ua(){const s=ge.now();ge.tasks.forEach(e=>{e.c(s)||(ge.tasks.delete(e),e.f())}),ge.tasks.size!==0&&ge.tick(ua)}function ha(s){let e;return ge.tasks.size===0&&ge.tick(ua),{promise:new Promise(t=>{ge.tasks.add(e={c:s,f:t})}),abort(){ge.tasks.delete(e)}}}function Es(s,e){s.dispatchEvent(new CustomEvent(e))}function gr(s){if(s==="float")return"cssFloat";if(s==="offset")return"cssOffset";if(s.startsWith("--"))return s;const e=s.split("-");return e.length===1?e[0]:e[0]+e.slice(1).map(t=>t[0].toUpperCase()+t.slice(1)).join("")}function Ji(s){const e={},t=s.split(";");for(const i of t){const[a,r]=i.split(":");if(!a||r===void 0)break;const l=gr(a.trim());e[l]=r.trim()}return e}const vr=s=>s;function W(s,e,t,i){var a=(s&Ya)!==0,r=(s&Xa)!==0,l=a&&r,c=(s&Va)!==0,g=l?"both":a?"in":"out",T,f=e.inert,w,p;function m(){var A=Jo,L=Is;Wi(null),Yi(null);try{return T??(T=t()(e,(i==null?void 0:i())??{},{direction:g}))}finally{Wi(A),Yi(L)}}var y={is_global:c,in(){var A;if(e.inert=f,!a){p==null||p.abort(),(A=p==null?void 0:p.reset)==null||A.call(p);return}r||w==null||w.abort(),Es(e,"introstart"),w=xi(e,m(),p,1,()=>{Es(e,"introend"),w==null||w.abort(),w=T=void 0})},out(A){if(!r){A==null||A(),T=void 0;return}e.inert=!0,Es(e,"outrostart"),p=xi(e,m(),w,0,()=>{Es(e,"outroend"),A==null||A()})},stop:()=>{w==null||w.abort(),p==null||p.abort()}},d=Is;if((d.transitions??(d.transitions=[])).push(y),a&&Ja){var E=c;if(!E){for(var _=d.parent;_&&_.f&ia;)for(;(_=_.parent)&&!(_.f&Ga););E=!_||(_.f&Ha)!==0}E&&oa(()=>{aa(()=>y.in())})}}function xi(s,e,t,i,a){var r=i===1;if(Wa(e)){var l,c=!1;return sa(()=>{if(!c){var E=e({direction:r?"in":"out"});l=xi(s,E,t,i,a)}}),{abort:()=>{c=!0,l==null||l.abort()},deactivate:()=>l.deactivate(),reset:()=>l.reset(),t:()=>l.t()}}if(t==null||t.deactivate(),!(e!=null&&e.duration))return a(),{abort:qe,deactivate:qe,reset:qe,t:()=>i};const{delay:g=0,css:T,tick:f,easing:w=vr}=e;var p=[];if(r&&t===void 0&&(f&&f(0,1),T)){var m=Ji(T(0,1));p.push(m,m)}var y=()=>1-i,d=s.animate(p,{duration:g});return d.onfinish=()=>{var E=(t==null?void 0:t.t())??1-i;t==null||t.abort();var _=i-E,A=e.duration*Math.abs(_),L=[];if(A>0){if(T)for(var q=Math.ceil(A/16.666666666666668),M=0;M<=q;M+=1){var P=E+_*w(M/q),H=T(P,1-P);L.push(Ji(H))}y=()=>{var O=d.currentTime;return E+_*w(O/A)},f&&ha(()=>{if(d.playState!=="running")return!1;var O=y();return f(O,1-O),!0})}d=s.animate(L,{duration:A,fill:"forwards"}),d.onfinish=()=>{y=()=>i,f==null||f(i,1-i),a()}},{abort:()=>{d&&(d.cancel(),d.effect=null,d.onfinish=qe)},deactivate:()=>{a=qe},reset:()=>{i===0&&(f==null||f(1,0))},t:()=>y()}}var Be,Ue,We,Rs,ma;const js=class js{constructor(e){u(this,Rs);u(this,Be,new WeakMap);u(this,Ue);u(this,We);fi(this,We,e)}observe(e,t){var i=n(this,Be).get(e)||new Set;return i.add(t),n(this,Be).set(e,i),Qi(this,Rs,ma).call(this).observe(e,n(this,We)),()=>{var a=n(this,Be).get(e);a.delete(t),a.size===0&&(n(this,Be).delete(e),n(this,Ue).unobserve(e))}}};Be=new WeakMap,Ue=new WeakMap,We=new WeakMap,Rs=new WeakSet,ma=function(){return n(this,Ue)??fi(this,Ue,new ResizeObserver(e=>{for(var t of e){js.entries.set(t.target,t);for(var i of n(this,Be).get(t.target)||[])i(t)}}))},$(js,"entries",new WeakMap);let Fi=js;var fr=new Fi({box:"border-box"});function Ki(s,e,t){var i=fr.observe(s,()=>t(s[e]));oa(()=>(aa(()=>t(s[e])),i))}function eo(s,e){Ka(window,["resize"],()=>er(()=>e(window[s])))}var Ye;class pr{constructor(){u(this,Ye,v(b({})));$(this,"setup",e=>{this.managers=e});$(this,"update",e=>{this.managers.stageManager.update(e),this.managers.entityManager.update(e),this.managers.collisionManager.update(),this.managers.questionManager&&this.managers.questionManager.update(e),this.managers.particleManager&&this.managers.particleManager.update(e)});$(this,"get",e=>typeof e=="string"?this.managers[e]:e.reduce((t,i)=>(t[i]=this.managers[i],t),{}))}get managers(){return o(n(this,Ye))}set managers(e){h(n(this,Ye),b(e))}}Ye=new WeakMap;const j=new pr,J=s=>`${bi}${s}`,to=["/enemies/BlueBlobElite/Die/0.svg","/enemies/BlueBlobElite/Die/1.svg","/enemies/BlueBlobElite/Die/2.svg"],wr={name:"BlueBlobEliteDie",frames:to,framesAmount:to.length,frameRate:10,loop:!1},so=["/enemies/BlueBlobElite/Follow/0.svg","/enemies/BlueBlobElite/Follow/1.svg","/enemies/BlueBlobElite/Follow/2.svg","/enemies/BlueBlobElite/Follow/3.svg"],yr={name:"BlueBlobEliteFollow",frames:so,framesAmount:so.length,frameRate:10,loop:!0},io=["/enemies/BlueCircleElite/Die/0.svg","/enemies/BlueCircleElite/Die/1.svg","/enemies/BlueCircleElite/Die/2.svg"],Cr={name:"BlueCircleEliteDie",frames:io,framesAmount:io.length,frameRate:10,loop:!1},oo=["/enemies/BlueCircleElite/Follow/0.svg","/enemies/BlueCircleElite/Follow/1.svg","/enemies/BlueCircleElite/Follow/2.svg","/enemies/BlueCircleElite/Follow/3.svg"],Tr={name:"BlueCircleEliteFollow",frames:oo,framesAmount:oo.length,frameRate:10,loop:!0},ao=["/enemies/GreenCircleElite/Die/0.svg","/enemies/GreenCircleElite/Die/1.svg","/enemies/GreenCircleElite/Die/2.svg"],br={name:"GreenCircleEliteDie",frames:ao,framesAmount:ao.length,frameRate:10,loop:!1},ro=["/enemies/GreenCircleElite/Follow/0.svg","/enemies/GreenCircleElite/Follow/1.svg","/enemies/GreenCircleElite/Follow/2.svg","/enemies/GreenCircleElite/Follow/3.svg"],_r={name:"GreenCircleEliteFollow",frames:ro,framesAmount:ro.length,frameRate:10,loop:!0},no=["/enemies/RedBlobElite/Die/0.svg","/enemies/RedBlobElite/Die/1.svg","/enemies/RedBlobElite/Die/2.svg"],xr={name:"RedBlobEliteDie",frames:no,framesAmount:no.length,frameRate:10,loop:!1},lo=["/enemies/RedBlobElite/Follow/0.svg","/enemies/RedBlobElite/Follow/1.svg","/enemies/RedBlobElite/Follow/2.svg","/enemies/RedBlobElite/Follow/3.svg"],Fr={name:"RedBlobEliteFollow",frames:lo,framesAmount:lo.length,frameRate:10,loop:!0},co=["/enemies/BlueCommon/Die/0.svg","/enemies/BlueCommon/Die/1.svg","/enemies/BlueCommon/Die/2.svg"],Br={name:"BlueCommonDie",frames:co,framesAmount:co.length,frameRate:10,loop:!1},uo=["/enemies/BlueCommon/Follow/0.svg","/enemies/BlueCommon/Follow/1.svg","/enemies/BlueCommon/Follow/2.svg"],Er={name:"BlueCommonFollow",frames:uo,framesAmount:uo.length,frameRate:10,loop:!0},ho=["/enemies/PurpleCommon/Die/0.svg","/enemies/PurpleCommon/Die/1.svg","/enemies/PurpleCommon/Die/2.svg"],Ar={name:"PurpleCommonDie",frames:ho,framesAmount:ho.length,frameRate:10,loop:!1},mo=["/enemies/PurpleCommon/Follow/0.svg","/enemies/PurpleCommon/Follow/1.svg","/enemies/PurpleCommon/Follow/2.svg"],Sr={name:"PurpleCommonFollow",frames:mo,framesAmount:mo.length,frameRate:10,loop:!0},go=["/enemies/YellowCommon/Die/0.svg","/enemies/YellowCommon/Die/1.svg","/enemies/YellowCommon/Die/2.svg"],Mr={name:"YellowCommonDie",frames:go,framesAmount:go.length,frameRate:10,loop:!1},vo=["/enemies/YellowCommon/Follow/0.svg","/enemies/YellowCommon/Follow/1.svg","/enemies/YellowCommon/Follow/2.svg","/enemies/YellowCommon/Follow/3.svg"],kr={name:"YellowCommonFollow",frames:vo,framesAmount:vo.length,frameRate:10,loop:!0},Dr=Object.freeze(Object.defineProperty({__proto__:null,BlueBlobEliteDie:wr,BlueBlobEliteFollow:yr,BlueCircleEliteDie:Cr,BlueCircleEliteFollow:Tr,BlueCommonDie:Br,BlueCommonFollow:Er,GreenCircleEliteDie:br,GreenCircleEliteFollow:_r,PurpleCommonDie:Ar,PurpleCommonFollow:Sr,RedBlobEliteDie:xr,RedBlobEliteFollow:Fr,YellowCommonDie:Mr,YellowCommonFollow:kr},Symbol.toStringTag,{value:"Module"})),Pr=["/towers/Base.svg"],Ir={name:"TowerBase",frames:Pr,framesAmount:1,frameRate:0,loop:!0},Lr=["/towers/FireTower/Base0.svg"],Rr={name:"FireTowerBase0",frames:Lr,framesAmount:1,frameRate:0,loop:!0},jr=["/towers/FireTower/Base1.svg"],$r={name:"FireTowerBase1",frames:jr,framesAmount:1,frameRate:0,loop:!0},qr=["/towers/FireTower/Base2.svg"],Nr={name:"FireTowerBase2",frames:qr,framesAmount:1,frameRate:0,loop:!0},fo=["/towers/Base.svg","/towers/Upgrade0.svg","/towers/FireTower/Base0.svg"],Ur={name:"FireTowerUpgrade0",frames:fo,framesAmount:fo.length,frameRate:10,loop:!1},po=["/towers/FireTower/Base0.svg","/towers/FireTower/Upgrade1.svg","/towers/FireTower/Base1.svg"],zr={name:"FireTowerUpgrade1",frames:po,framesAmount:po.length,frameRate:10,loop:!1},wo=["/towers/FireTower/Base1.svg","/towers/FireTower/Upgrade2.svg","/towers/FireTower/Base2.svg"],Or={name:"FireTowerUpgrade2",frames:wo,framesAmount:wo.length,frameRate:10,loop:!1},Qr=["/towers/IceTower/Base0.svg"],Gr={name:"IceTowerBase0",frames:Qr,framesAmount:1,frameRate:0,loop:!0},Hr=["/towers/IceTower/Base1.svg"],Vr={name:"IceTowerBase1",frames:Hr,framesAmount:1,frameRate:0,loop:!0},Wr=["/towers/IceTower/Base2.svg"],Yr={name:"IceTowerBase2",frames:Wr,framesAmount:1,frameRate:0,loop:!0},yo=["/towers/Base.svg","/towers/Upgrade0.svg","/towers/IceTower/Base0.svg"],Xr={name:"IceTowerUpgrade0",frames:yo,framesAmount:yo.length,frameRate:10,loop:!1},Co=["/towers/IceTower/Base0.svg","/towers/IceTower/Upgrade1.svg","/towers/IceTower/Base1.svg"],Zr={name:"IceTowerUpgrade1",frames:Co,framesAmount:Co.length,frameRate:10,loop:!1},To=["/towers/IceTower/Base1.svg","/towers/IceTower/Upgrade2.svg","/towers/IceTower/Base2.svg"],Jr={name:"IceTowerUpgrade2",frames:To,framesAmount:To.length,frameRate:10,loop:!1},Kr=["/towers/PoisonTower/Base0.svg"],en={name:"PoisonTowerBase0",frames:Kr,framesAmount:1,frameRate:0,loop:!0},tn=["/towers/PoisonTower/Base1.svg"],sn={name:"PoisonTowerBase1",frames:tn,framesAmount:1,frameRate:0,loop:!0},on=["/towers/PoisonTower/Base2.svg"],an={name:"PoisonTowerBase2",frames:on,framesAmount:1,frameRate:0,loop:!0},bo=["/towers/Base.svg","/towers/Upgrade0.svg","/towers/PoisonTower/Base0.svg"],rn={name:"PoisonTowerUpgrade0",frames:bo,framesAmount:bo.length,frameRate:10,loop:!1},_o=["/towers/PoisonTower/Base0.svg","/towers/PoisonTower/Upgrade1.svg","/towers/PoisonTower/Base1.svg"],nn={name:"PoisonTowerUpgrade1",frames:_o,framesAmount:_o.length,frameRate:10,loop:!1},xo=["/towers/PoisonTower/Base1.svg","/towers/PoisonTower/Upgrade2.svg","/towers/PoisonTower/Base2.svg"],ln={name:"PoisonTowerUpgrade2",frames:xo,framesAmount:xo.length,frameRate:10,loop:!1},cn=["/towers/ThunderTower/Base0.svg"],dn={name:"ThunderTowerBase0",frames:cn,framesAmount:1,frameRate:0,loop:!0},un=["/towers/ThunderTower/Base1.svg"],hn={name:"ThunderTowerBase1",frames:un,framesAmount:1,frameRate:0,loop:!0},mn=["/towers/ThunderTower/Base2.svg"],gn={name:"ThunderTowerBase2",frames:mn,framesAmount:1,frameRate:0,loop:!0},Fo=["/towers/Base.svg","/towers/Upgrade0.svg","/towers/ThunderTower/Base0.svg"],vn={name:"ThunderTowerUpgrade0",frames:Fo,framesAmount:Fo.length,frameRate:10,loop:!1},Bo=["/towers/ThunderTower/Base0.svg","/towers/ThunderTower/Upgrade1.svg","/towers/ThunderTower/Base1.svg"],fn={name:"ThunderTowerUpgrade1",frames:Bo,framesAmount:Bo.length,frameRate:10,loop:!1},Eo=["/towers/ThunderTower/Base1.svg","/towers/ThunderTower/Upgrade2.svg","/towers/ThunderTower/Base2.svg"],pn={name:"ThunderTowerUpgrade2",frames:Eo,framesAmount:Eo.length,frameRate:10,loop:!1},wn=Object.freeze(Object.defineProperty({__proto__:null,FireTowerBase0:Rr,FireTowerBase1:$r,FireTowerBase2:Nr,FireTowerUpgrade0:Ur,FireTowerUpgrade1:zr,FireTowerUpgrade2:Or,IceTowerBase0:Gr,IceTowerBase1:Vr,IceTowerBase2:Yr,IceTowerUpgrade0:Xr,IceTowerUpgrade1:Zr,IceTowerUpgrade2:Jr,PoisonTowerBase0:en,PoisonTowerBase1:sn,PoisonTowerBase2:an,PoisonTowerUpgrade0:rn,PoisonTowerUpgrade1:nn,PoisonTowerUpgrade2:ln,ThunderTowerBase0:dn,ThunderTowerBase1:hn,ThunderTowerBase2:gn,ThunderTowerUpgrade0:vn,ThunderTowerUpgrade1:fn,ThunderTowerUpgrade2:pn,TowerBase:Ir},Symbol.toStringTag,{value:"Module"})),Ao=["/projectiles/Fireball/Die/0.svg","/projectiles/Fireball/Die/1.svg","/projectiles/Fireball/Die/2.svg"],yn={name:"FireballDie",frames:Ao,framesAmount:Ao.length,frameRate:10,loop:!1},So=["/projectiles/Fireball/Follow/0.svg","/projectiles/Fireball/Follow/1.svg","/projectiles/Fireball/Follow/2.svg","/projectiles/Fireball/Follow/3.svg"],Cn={name:"FireballFollow",frames:So,framesAmount:So.length,frameRate:10,loop:!0},Mo=["/projectiles/Icebolt/Die/0.svg","/projectiles/Icebolt/Die/1.svg","/projectiles/Icebolt/Die/2.svg"],Tn={name:"IceboltDie",frames:Mo,framesAmount:Mo.length,frameRate:10,loop:!1},ko=["/projectiles/Icebolt/Follow/0.svg","/projectiles/Icebolt/Follow/1.svg"],bn={name:"IceboltFollow",frames:ko,framesAmount:ko.length,frameRate:10,loop:!0},Do=["/projectiles/Poisonball/Die/0.svg","/projectiles/Poisonball/Die/1.svg","/projectiles/Poisonball/Die/2.svg"],_n={name:"PoisonballDie",frames:Do,framesAmount:Do.length,frameRate:10,loop:!1},Po=["/projectiles/Poisonball/Follow/0.svg","/projectiles/Poisonball/Follow/1.svg","/projectiles/Poisonball/Follow/2.svg","/projectiles/Poisonball/Follow/3.svg"],xn={name:"PoisonballFollow",frames:Po,framesAmount:Po.length,frameRate:10,loop:!0},Io=["/projectiles/Thunderbolt/Die/0.svg","/projectiles/Thunderbolt/Die/1.svg","/projectiles/Thunderbolt/Die/2.svg"],Fn={name:"ThunderboltDie",frames:Io,framesAmount:Io.length,frameRate:10,loop:!1},Lo=["/projectiles/Thunderbolt/Follow/0.svg","/projectiles/Thunderbolt/Follow/1.svg","/projectiles/Thunderbolt/Follow/2.svg","/projectiles/Thunderbolt/Follow/3.svg"],Bn={name:"ThunderboltFollow",frames:Lo,framesAmount:Lo.length,frameRate:10,loop:!0},Ro=["/projectiles/Click/0.svg","/projectiles/Click/1.svg","/projectiles/Click/2.svg","/projectiles/Click/3.svg"],En={name:"Click",frames:Ro,framesAmount:Ro.length,frameRate:10,loop:!1},An=Object.freeze(Object.defineProperty({__proto__:null,Click:En,FireballDie:yn,FireballFollow:Cn,IceboltDie:Tn,IceboltFollow:bn,PoisonballDie:_n,PoisonballFollow:xn,ThunderboltDie:Fn,ThunderboltFollow:Bn},Symbol.toStringTag,{value:"Module"})),jo=["/cursors/build0.svg","/cursors/build1.svg","/cursors/build2.svg"],Sn={name:"TowerBuildCursor",frames:jo,framesAmount:jo.length,frameRate:7,loop:!1},Mn=Object.freeze(Object.defineProperty({__proto__:null,TowerBuildCursor:Sn},Symbol.toStringTag,{value:"Module"})),kn=["/castle/castle.png"],Dn={name:"Throne",frames:kn,framesAmount:1,frameRate:0,loop:!0},Pn=["/castle/castle-broken.png"],In={name:"ThroneDamaged1",frames:Pn,framesAmount:1,frameRate:0,loop:!0},Ln=["/castle/castle-broken2.png"],Rn={name:"ThroneDamaged2",frames:Ln,framesAmount:1,frameRate:0,loop:!0},jn=["/castle/castle-broken3.png"],$n={name:"ThroneDamaged3",frames:jn,framesAmount:1,frameRate:0,loop:!0},qn=["/castle/castle-destroyed.png"],Nn={name:"ThroneDestroyed",frames:qn,framesAmount:1,frameRate:0,loop:!1},Un=Object.freeze(Object.defineProperty({__proto__:null,Throne:Dn,ThroneDamaged1:In,ThroneDamaged2:Rn,ThroneDamaged3:$n,ThroneDestroyed:Nn},Symbol.toStringTag,{value:"Module"})),zn=["/loot.svg"],On={name:"Loot",frames:zn,framesAmount:1,frameRate:0,loop:!0},$o={...Un,Loot:On,...Dr,...wn,...An,...Mn},ze=s=>{if(!$o[s])throw new Error(`Animation config not found for: ${s}`);const e=$o[s];return{...e,frames:e.frames.map(t=>J(t))}};var Xe,Ze,Je,Ke,et,$s,tt;class Li{constructor({name:e,framesAmount:t,frameRate:i,loop:a=!1}){$(this,"name");u(this,Xe,v(0));u(this,Ze,v(0));u(this,Je,v(!1));u(this,Ke,v(0));u(this,et,v(0));u(this,$s,B(()=>this.getIsAnimationComplete()));u(this,tt,v(()=>{}));this.name=e,this.framesAmount=t,this.frameRate=i,this.loop=a}get framesAmount(){return o(n(this,Xe))}set framesAmount(e){h(n(this,Xe),b(e))}get frameRate(){return o(n(this,Ze))}set frameRate(e){h(n(this,Ze),b(e))}get loop(){return o(n(this,Je))}set loop(e){h(n(this,Je),b(e))}get currentFrame(){return o(n(this,Ke))}set currentFrame(e){h(n(this,Ke),b(e))}get currentFrameTime(){return o(n(this,et))}set currentFrameTime(e){h(n(this,et),b(e))}get isComplete(){return o(n(this,$s))}get onFrameChange(){return o(n(this,tt))}set onFrameChange(e){h(n(this,tt),b(e))}update(e){this.frameRate!==0&&(this.currentFrameTime+=e,this.currentFrameTime>=1e3/this.frameRate&&(this.currentFrameTime=0,this.nextFrame()))}nextFrame(){this.onFrameChange(this.currentFrame),this.currentFrame>=this.framesAmount-1?this.loop?this.currentFrame=0:this.currentFrame=this.framesAmount-1:this.currentFrame+=1}getIsAnimationComplete(){return this.loop?!1:this.currentFrame===this.framesAmount-1}}Xe=new WeakMap,Ze=new WeakMap,Je=new WeakMap,Ke=new WeakMap,et=new WeakMap,$s=new WeakMap,tt=new WeakMap;const qo={arrow:J("/cursors/cursor-arrow.svg"),hammer:J("/cursors/cursor-hammer.svg")};var st,qs,Ns,Us,zs;class Qn{constructor(){u(this,st,v());u(this,qs,B(()=>`url(${qo.arrow}), auto`));u(this,Ns,B(()=>`url(${qo.hammer}), auto`));u(this,Us,B(()=>this.animation&&!this.animation.isComplete));u(this,zs,B(()=>this.getCurrentFrame()))}get animation(){return o(n(this,st))}set animation(e){h(n(this,st),b(e))}get arrow(){return o(n(this,qs))}get hammer(){return o(n(this,Ns))}get inAnimation(){return o(n(this,Us))}get currentFrame(){return o(n(this,zs))}update(e){this.inAnimation&&this.animation.update(e)}get(e){return this.inAnimation?this.currentFrame:this[e]}setAnimation(e){if(!e){this.animation=null;return}const t=ze(e);this.animation=new Li({...t})}getCurrentFrame(){const{frames:e}=ze(this.animation.name);return`url(${e[this.animation.currentFrame]}), auto`}}st=new WeakMap,qs=new WeakMap,Ns=new WeakMap,Us=new WeakMap,zs=new WeakMap;const te=new Qn;var it,ot,at,rt,nt,lt,Os;class Gn{constructor(){u(this,it,v(0));u(this,ot,v(0));u(this,at,v(0));u(this,rt,v(0));u(this,nt,v(0));u(this,lt,v(0));u(this,Os,B(()=>this.width<768))}get width(){return o(n(this,it))}set width(e){h(n(this,it),b(e))}get height(){return o(n(this,ot))}set height(e){h(n(this,ot),b(e))}get gameAreaWidth(){return o(n(this,at))}set gameAreaWidth(e){h(n(this,at),b(e))}get gameAreaHeight(){return o(n(this,rt))}set gameAreaHeight(e){h(n(this,rt),b(e))}get gameXOffset(){return o(n(this,nt))}set gameXOffset(e){h(n(this,nt),b(e))}get gameYOffset(){return o(n(this,lt))}set gameYOffset(e){h(n(this,lt),b(e))}get isMobile(){return o(n(this,Os))}get screenBounds(){return{x1:0,y1:0,x2:this.width,y2:this.height}}get gameBoundingBox(){return{x1:this.gameXOffset,y1:this.gameYOffset,x2:this.width,y2:this.height}}isEntityInScreen(e){const{x1:t,y1:i,x2:a,y2:r}=this.screenBounds,{x:l,y:c}=e.position;return l+e.width/2>t&&l-e.width/2<a&&c+e.height>i&&c-e.height<r}}it=new WeakMap,ot=new WeakMap,at=new WeakMap,rt=new WeakMap,nt=new WeakMap,lt=new WeakMap,Os=new WeakMap;const R=new Gn;var Hn=D('<img alt="Enemy animation" class="svelte-94zyf5">');function wi(s,e){Y(e,!0);let t=Ee(e,"entity",7),i=v(void 0),a=B(()=>ze(t().animation.name)),r=B(()=>o(a).frames[t().animation.currentFrame]),l=v(!1);function c(){h(l,!0)}const g=B(()=>R.isMobile?t().scale-.2:t().scale),T=B(()=>t().position.x),f=B(()=>t().position.y),w=B(()=>`translate(${o(T)}px, ${o(f)}px) rotate(${t().rotation}deg) scale(${o(g)})`);Ie(()=>{if(!o(i)||!o(l))return;let y=o(i).getBoundingClientRect();t().width=y.width,t().height=y.height});var p=Hn();const m=B(()=>te.get("arrow"));na(p,y=>h(i,y),()=>o(i)),I(()=>{K(p,"src",o(r)),N(p,"left","0px"),N(p,"top","0px"),N(p,"transform",o(w)),N(p,"cursor",o(m))}),Qe("load",p,c),ra(p),S(s,p),X()}var ct,dt;const ye=class ye{constructor(e=0,t=0){u(this,ct,v(0));u(this,dt,v(0));this.x=e,this.y=t}get x(){return o(n(this,ct))}set x(e){h(n(this,ct),b(e))}get y(){return o(n(this,dt))}set y(e){h(n(this,dt),b(e))}clone(){return new ye(this.x,this.y)}isEqual(e){return this.x===e.x&&this.y===e.y}add(e){return new ye(this.x+e.x,this.y+e.y)}subtract(e){return new ye(this.x-e.x,this.y-e.y)}multiply(e){return new ye(this.x*e,this.y*e)}magnitude(){return Math.sqrt(this.x*this.x+this.y*this.y)}normalize(){const e=this.magnitude();return e?new ye(this.x/e,this.y/e):new ye}distance(e){return this.subtract(e).magnitude()}dot(e){return this.x*e.x+this.y*e.y}rotate(e){const t=Math.cos(e),i=Math.sin(e);return new ye(this.x*t-this.y*i,this.x*i+this.y*t)}};ct=new WeakMap,dt=new WeakMap;let le=ye;const Vn=s=>s;function ga(s){const e=s-1;return e*e*e+1}function ce(s,{delay:e=0,duration:t=400,easing:i=Vn}={}){const a=+getComputedStyle(s).opacity;return{delay:e,duration:t,easing:i,css:r=>`opacity: ${r*a}`}}function va(s,{delay:e=0,duration:t=400,easing:i=ga,axis:a="y"}={}){const r=getComputedStyle(s),l=+r.opacity,c=a==="y"?"height":"width",g=parseFloat(r[c]),T=a==="y"?["top","bottom"]:["left","right"],f=T.map(_=>`${_[0].toUpperCase()}${_.slice(1)}`),w=parseFloat(r[`padding${f[0]}`]),p=parseFloat(r[`padding${f[1]}`]),m=parseFloat(r[`margin${f[0]}`]),y=parseFloat(r[`margin${f[1]}`]),d=parseFloat(r[`border${f[0]}Width`]),E=parseFloat(r[`border${f[1]}Width`]);return{delay:e,duration:t,easing:i,css:_=>`overflow: hidden;opacity: ${Math.min(_*20,1)*l};${c}: ${_*g}px;padding-${T[0]}: ${_*w}px;padding-${T[1]}: ${_*p}px;margin-${T[0]}: ${_*m}px;margin-${T[1]}: ${_*y}px;border-${T[0]}-width: ${_*d}px;border-${T[1]}-width: ${_*E}px;`}}function Oe(s,{delay:e=0,duration:t=400,easing:i=ga,start:a=0,opacity:r=0}={}){const l=getComputedStyle(s),c=+l.opacity,g=l.transform==="none"?"":l.transform,T=1-a,f=c*(1-r);return{delay:e,duration:t,easing:i,css:(w,p)=>`
			transform: ${g} scale(${1-T*p});
			opacity: ${c-f*p}
		`}}var Wn=D('<div class="shoot-effect svelte-1yv4put"></div>');function Yn(s,e){Y(e,!0);let i=B(()=>{switch(e.entity.name){case"IceTower":return"#9AD5FF";case"FireTower":return"#E45F01";case"ThunderTower":return"#FFF263";case"PoisonTower":return"#6CE966";default:return"#ffffff"}}),r=B(()=>e.entity.upgradeLevel===0?{x:e.entity.width/2,y:22}:e.entity.upgradeLevel===1?{x:e.entity.width/2,y:23}:{x:e.entity.width/2,y:24});var l=Wn();I(()=>{N(l,"--effect-color",o(i)),N(l,"left",`${o(r).x}px`),N(l,"top",`${o(r).y}px`)}),Qe("animationend",l,()=>{e.entity.removeVFX("TowerShoot")}),W(2,l,()=>ce,()=>({duration:40})),S(s,l),X()}var Xn=D('<div class="smoke-effect svelte-1pfktwp"></div>');function Zn(s,e){Y(e,!0);const t=174,i=249.5,a=7,r=14,c=1e3/r;let g=v(0),T=B(()=>o(g)%a*t),f=B(()=>Math.floor(o(g)/a)*i);Ie(()=>{const p=setInterval(()=>{o(g)<r-1?Pi(g):(clearInterval(p),e.entity.removeVFX("Smoke"))},c);return()=>clearInterval(p)});var w=Xn();N(w,"width",`${t}px`),N(w,"height",`${i}px`),I(()=>N(w,"background-position",`-${o(T)}px -${o(f)}px`)),S(s,w),X()}var Jn=D('<div class="explosion-effect svelte-6va1lc"></div>');function Kn(s,e){Y(e,!0);const t=320,i=344,a=4,r=8,c=1e3/r;let g=v(0),T=B(()=>o(g)%a*t),f=B(()=>Math.floor(o(g)/a)*i);Ie(()=>{const p=setInterval(()=>{o(g)<r-1?Pi(g):(clearInterval(p),e.entity.removeVFX("Explosion"))},c);return()=>clearInterval(p)});var w=Jn();N(w,"width",`${t}px`),N(w,"height",`${i}px`),I(()=>N(w,"background-position",`-${o(T)}px -${o(f)}px`)),S(s,w),X()}const el=Object.freeze(Object.defineProperty({__proto__:null,Explosion:Kn,Smoke:Zn,TowerShoot:Yn},Symbol.toStringTag,{value:"Module"}));function tl(s,e){Y(e,!0);const t=el[e.name];if(!t)throw new Error(`Effect with name ${e.name} not found for entity ${e.entity.name}`);t(s,{get entity(){return e.entity}}),X()}var sl=D('<img alt="Enemy animation" class="svelte-usgp6v"> <!>',1);function yi(s,e){Y(e,!0);let t=Ee(e,"entity",7),i=v(void 0),a=B(()=>ze(t().animation.name)),r=B(()=>o(a).frames[t().animation.currentFrame]),l=v(!1);function c(){h(l,!0)}const g=B(()=>R.isMobile?t().scale-.2:t().scale),T=B(()=>`scale(${o(g)})`);Ie(()=>{var d;if(!o(i)||!o(l))return;let m=o(i).getBoundingClientRect();const y=((d=o(i).offsetParent)==null?void 0:d.getBoundingClientRect())??{x:0,y:0};t().position=new le(m.x-y.x,m.y-y.y),t().width=m.width,t().height=m.height,console.log("entity.position",o(r),t().width,t().height,R.width)});var f=sl(),w=se(f);w.__click=function(...m){var y;(y=e.onclick)==null||y.apply(this,m)},na(w,m=>h(i,m),()=>o(i));var p=F(w,2);he(p,17,()=>t().vfx,m=>m+t().vfx.length,(m,y)=>{tl(m,{get name(){return o(y)},get entity(){return t()}})}),I(()=>{K(w,"src",o(r)),N(w,"transform",o(T))}),Qe("load",w,c),ra(w),S(s,f),X()}Ge(["click"]);var il=D('<div class="particle svelte-17cbyeb"></div>'),ol=D('<div class="particle-layer svelte-17cbyeb"><!></div>');function al(s,e){Y(e,!0);const t=B(()=>j.get("particleManager"));var i=ol(),a=x(i);{var r=l=>{var c=ve(),g=se(c);he(g,16,()=>o(t).particles,T=>T,(T,f)=>{var w=il();I(()=>{N(w,"left",`${f.x??""}px`),N(w,"top",`${f.y??""}px`),N(w,"width",`${f.size??""}px`),N(w,"height",`${f.size??""}px`),N(w,"background-color",f.color),N(w,"opacity",f.life)}),S(T,w)}),S(l,c)};U(a,l=>{o(t)&&l(r)})}C(i),S(s,i),X()}function Ne(s,e){return s.x1<=e.x2&&s.x2>=e.x1&&s.y1<=e.y2&&s.y2>=e.y1}function fa(s,e){return Math.atan2(e.y-s.y,e.x-s.x)}function Ri(s){return new le(Math.cos(s),Math.sin(s))}const ji=(s,e,t)=>({x1:s.x-e/2,y1:s.y-t/2,x2:s.x+e/2,y2:s.y+t/2,center:new le(s.x,s.y),topMiddle:new le(s.x+e/2,s.y)}),Ci={bgSound:J("/sound/bgSound.mp3"),effects:{pickUp:J("/sound/sfx/pickUp.m4a"),towerUpgrade:J("/sound/sfx/towerUpgrade.m4a"),clickEnemy:J("/sound/sfx/clickEnemy.m4a"),towerShoot:J("/sound/sfx/towerShoot.m4a"),clickMenu:J("/sound/sfx/clickMenu.m4a"),lowResourse:J("/sound/sfx/lowResourse.m4a"),shine:J("/sound/sfx/shine.mp3"),chime:J("/sound/sfx/chime.mp3"),magicBurst:J("/sound/sfx/magic-burst.mp3"),break:J("/sound/sfx/break-sound.mp3"),destruction:J("/sound/sfx/destruction-sound.mp3")}},As=.2,rl=.3;var ut,ht,mt,gt,vt,ft,pt,wt,Qs,Gs;class nl{constructor(){u(this,ut,v({}));u(this,ht,v(!1));u(this,mt,v(0));u(this,gt,v(null));u(this,vt,v(null));u(this,ft,v(null));u(this,pt,v(!1));u(this,wt,v(0));u(this,Qs,B(()=>Object.keys(Ci.effects).length+1));u(this,Gs,B(()=>Math.min(Math.floor(this.loadedCount/this.totalResources*100),100)));$(this,"preload",async()=>{const e=(t,i)=>new Promise((a,r)=>{const l=new Audio(i),c=()=>{this.sounds[t]=l,this.sounds[t].volume=t==="bgSound"?As:rl,this.sounds[t].loop=t==="bgSound",this.loadedCount+=1,l.removeEventListener("canplaythrough",c),a()},g=T=>{l.removeEventListener("error",g),r(T)};l.addEventListener("canplaythrough",c),l.addEventListener("error",g),l.load()});try{await e("bgSound",Ci.bgSound);const t=Object.entries(Ci.effects).map(([i,a])=>e(i,a));await Promise.all(t),this.preloaded=!0,console.log("Sounds preloaded successfully.")}catch(t){throw console.error("Error preloading sounds:",t),t}});$(this,"reduceBgVolume",()=>{this.sounds.bgSound.volume=As-.2});$(this,"restoreBgVolume",()=>{this.sounds.bgSound.volume=As});$(this,"initAudioContext",()=>{if(this.audioContext)return;const e=window.AudioContext||window.webkitAudioContext;this.audioContext=new e;const t=this.sounds.bgSound;t&&(this.bgNode=this.audioContext.createMediaElementSource(t),this.bgFilter=this.audioContext.createBiquadFilter(),this.bgFilter.type="lowpass",this.bgFilter.frequency.value=22050,this.bgNode.connect(this.bgFilter),this.bgFilter.connect(this.audioContext.destination))});$(this,"play",(e,t=!1)=>{if(this.isMuted)return;const i=this.sounds[e];if(i){if(e==="bgSound"){this.initAudioContext(),this.audioContext.state==="suspended"&&this.audioContext.resume(),i.currentTime=0,i.play();return}if(!(navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome"))&&(t||this.playingEffectsCount<10)){i.currentTime=0,i.play();const a=()=>{this.playingEffectsCount-=1,i.removeEventListener("ended",a)};i.addEventListener("ended",a),this.playingEffectsCount+=1}}})}get sounds(){return o(n(this,ut))}set sounds(e){h(n(this,ut),e)}get isMuted(){return o(n(this,ht))}set isMuted(e){h(n(this,ht),b(e))}get playingEffectsCount(){return o(n(this,mt))}set playingEffectsCount(e){h(n(this,mt),b(e))}get audioContext(){return o(n(this,gt))}set audioContext(e){h(n(this,gt),e)}get bgNode(){return o(n(this,vt))}set bgNode(e){h(n(this,vt),e)}get bgFilter(){return o(n(this,ft))}set bgFilter(e){h(n(this,ft),e)}get preloaded(){return o(n(this,pt))}set preloaded(e){h(n(this,pt),b(e))}get loadedCount(){return o(n(this,wt))}set loadedCount(e){h(n(this,wt),b(e))}get totalResources(){return o(n(this,Qs))}get preloadPercent(){return o(n(this,Gs))}pause(e){const t=this.sounds[e];t&&t.pause()}toggleMute(){this.isMuted=!this.isMuted,this.isMuted?this.pause("bgSound"):this.play("bgSound")}reset(){if(this.isMuted)return;const e=this.sounds.bgSound;e&&(e.currentTime=0,e.volume=As,e.play())}setDistortion(e){if(!this.bgFilter||!this.audioContext)return;const t=this.audioContext.currentTime,i=e?600:22050;this.bgFilter.frequency.cancelScheduledValues(t),this.bgFilter.frequency.exponentialRampToValueAtTime(i,t+.5)}}ut=new WeakMap,ht=new WeakMap,mt=new WeakMap,gt=new WeakMap,vt=new WeakMap,ft=new WeakMap,pt=new WeakMap,wt=new WeakMap,Qs=new WeakMap,Gs=new WeakMap;const k=new nl,ll={click:5,upgrade:35};var yt,Ct,Tt,bt,_t,xt;class cl{constructor(){u(this,yt,v(100));u(this,Ct,v(!1));u(this,Tt,v(!1));u(this,bt,v(!1));u(this,_t,v(100));u(this,xt,v(0))}get collectedLoot(){return o(n(this,yt))}set collectedLoot(e){h(n(this,yt),b(e))}get playLowLootAnimation(){return o(n(this,Ct))}set playLowLootAnimation(e){h(n(this,Ct),b(e))}get playTowerUpgradeAnimation(){return o(n(this,Tt))}set playTowerUpgradeAnimation(e){h(n(this,Tt),b(e))}get playEnemyClickAnimation(){return o(n(this,bt))}set playEnemyClickAnimation(e){h(n(this,bt),b(e))}get score(){return o(n(this,_t))}set score(e){h(n(this,_t),b(e))}get killsEnemy(){return o(n(this,xt))}set killsEnemy(e){h(n(this,xt),b(e))}spendLoot(e){const t=ll[e.type];if(e.type==="upgrade"){const{questionManager:i}=j.get(["questionManager"]),{tower:a}=e.payload;if(a.state.currentState.name==="NotBuilt"){i.buildPoints>0?(i.buildPoints--,a.state.setState("Guard"),a.stats.health=a.stats.maxHealth||3):this.playAnimation("LowLoot");return}else{this.collectedLoot>=t?i.buildPoints>0?(this.collectedLoot-=t,i.buildPoints--,a.state.setState("Upgrade"),this.playAnimation("TowerUpgrade"),te.setAnimation("TowerBuildCursor")):this.playAnimation("LowLoot"):this.playAnimation("LowLoot");return}}if(this.collectedLoot<t){this.playAnimation("LowLoot");return}if(e.type==="click"){const{collisionManager:i,stageManager:a}=j.get(["collisionManager","stageManager"]),{offset:r}=e.payload,l=ji(r,60,60),c=i.filterEnemiesByBounds(l);a.spawnEntity("ClickExplode",r),k.play("clickEnemy",!0),c.forEach(g=>{g.state.setState("Die")}),c.length>0&&(this.collectedLoot-=t)}}receiveLoot(e){this.collectedLoot+=e,this.score+=e,this.killsEnemy++}reset(){this.collectedLoot=100,this.killsEnemy=0}getAnimation(e){return`play${e}Animation`}playAnimation(e){const t=this.getAnimation(e);this[t]=!0}unsetAnimation(e){const t=this.getAnimation(e);this[t]=!1}}yt=new WeakMap,Ct=new WeakMap,Tt=new WeakMap,bt=new WeakMap,_t=new WeakMap,xt=new WeakMap;const be=new cl;var dl=D('<div class="segment-marker svelte-1syar9e"></div>'),ul=D('<div class="health-bar-container svelte-1syar9e"><div class="health-bar-background svelte-1syar9e"><!> <div class="health-bar-fill svelte-1syar9e"></div></div></div>');function hl(s,e){Y(e,!0);const t=e.entity.stats.maxHealth||500,i=5,a=B(()=>Math.max(0,Math.min(100,e.entity.stats.health/t*100))),r=Array.from({length:i-1},(w,p)=>(p+1)*(100/i));var l=ul();const c=B(()=>te.get("arrow"));I(()=>N(l,"cursor",o(c)));var g=x(l),T=x(g);he(T,17,()=>r,Ls,(w,p)=>{var m=dl();I(()=>N(m,"left",`${o(p)??""}%`)),S(w,m)});var f=F(T,2);C(g),C(l),I(()=>{Te(f,"low",o(a)<=20),Te(f,"medium",o(a)>20&&o(a)<=60),Te(f,"high",o(a)>60),N(f,"width",`${o(a)??""}%`)}),S(s,l),X()}var ml=D('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),gl=D('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),vl=D('<div class="tower-wrapper svelte-1u5gm4i"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></div>'),fl=D('<div class="tower-wrapper svelte-1u5gm4i"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></div>'),pl=D('<section class="svelte-1u5gm4i"><div class="grid-plane svelte-1u5gm4i"></div> <!> <!> <!> <div class="towers svelte-1u5gm4i"></div> <div class="throne svelte-1u5gm4i"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></div> <div class="towers svelte-1u5gm4i"></div> <!></section>');function wl(s,e){Y(e,!0);const t=B(()=>j.get("entityManager")),i=d=>E=>{E.stopPropagation(),!(d.upgradeLevel===2||!d.isUpgradable||te.inAnimation)&&be.spendLoot({type:"upgrade",payload:{tower:d}})};var a=pl();const r=B(()=>te.get("arrow"));I(()=>N(a,"cursor",o(r)));var l=F(x(a),2);he(l,17,()=>o(t).loot,d=>d.id,(d,E)=>{var _=ml(),A=se(_);$e(A,()=>({"--z-index":11})),wi(A.lastChild,{get entity(){return o(E)}}),C(A),S(d,_)});var c=F(l,2);he(c,17,()=>o(t).projectiles,d=>d.id,(d,E)=>{var _=gl(),A=se(_);$e(A,()=>({"--z-index":12})),wi(A.lastChild,{get entity(){return o(E)}}),C(A),S(d,_)});var g=F(c,2);he(g,17,()=>o(t).enemies,d=>d.id,(d,E)=>{wi(d,{get entity(){return o(E)}})});var T=F(g,2);he(T,23,()=>o(t).topTowers,d=>d.id,(d,E,_)=>{var A=vl(),L=x(A),q=B(()=>i(o(E)));$e(L,()=>({"--cursor":te.get("hammer"),"--z-index":10,"--pointer-events":"auto","--margin-left":o(_)===0?"12px":"0","--margin-right":o(_)===1?"12px":"0"})),yi(L.lastChild,{get entity(){return o(E)},get onclick(){return o(q)}}),C(L),C(A),S(d,A)}),C(T);var f=F(T,2),w=x(f);$e(w,()=>({"--cursor":te.get("arrow")})),yi(w.lastChild,{get entity(){return o(t).throne}}),C(w);var p=F(w,2);$e(p,()=>({"--width":`${o(t).throne.width}px`})),hl(p.lastChild,{get entity(){return o(t).throne}}),C(p),C(f);var m=F(f,2);he(m,23,()=>o(t).bottomTowers,d=>d.id,(d,E,_)=>{var A=fl(),L=x(A),q=B(()=>i(o(E)));$e(L,()=>({"--cursor":te.get("hammer"),"--z-index":10,"--pointer-events":"auto","--margin-left":o(_)===0?"12px":"0","--margin-right":o(_)===1?"12px":"0"})),yi(L.lastChild,{get entity(){return o(E)},get onclick(){return o(q)}}),C(L),C(A),S(d,A)}),C(m);var y=F(m,2);al(y,{}),C(a),S(s,a),X()}const yl=(s,e)=>{k!=null&&k.preloaded&&k.play("clickMenu",!0),e.onclick()};var Cl=D('<button class="btn svelte-11ulr"> <div class="tab svelte-11ulr"></div></button>');function Ce(s,e){Y(e,!0);const t=Ee(e,"disabled",3,!1),i=Ee(e,"text",3,"");var a=Cl();a.__click=[yl,e];const r=B(()=>te.get("arrow"));var l=x(a);Ii(),C(a),I(()=>{a.disabled=t(),N(a,"cursor",o(r)),ne(l,`${i()??""} `)}),S(s,a),X()}Ge(["click"]);var Tl=D('<div class="menu-container svelte-n7rxky"><div class="grid-overlay svelte-n7rxky"></div> <div class="scan-line svelte-n7rxky"></div> <div class="menu-content svelte-n7rxky"><!></div></div>');function $i(s,e){Y(e,!0);var t=Tl();const i=B(()=>te.get("arrow"));I(()=>N(t,"cursor",o(i)));var a=F(x(t),4),r=x(a);dr(r,()=>e.children),C(a),C(t),W(1,t,()=>ce,()=>({duration:200})),W(2,t,()=>ce,()=>({duration:200})),S(s,t),X()}var bl=ri('<svg viewBox="0 0 50 50" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="25" cy="25" r="24.5" fill="#FFD700" stroke="white"></circle><circle cx="25" cy="25" r="18" fill="#FFAE00"></circle><path d="M43 25C43 20.2261 41.1036 15.6477 37.7279 12.2721C34.3523 8.89642 29.7739 7 25 7C20.2261 7 15.6477 8.89642 12.2721 12.2721C8.89642 15.6477 7 20.2261 7 25H7.72C7.72 20.4171 9.54057 16.0218 12.7812 12.7812C16.0218 9.54057 20.4171 7.72 25 7.72C29.5829 7.72 33.9782 9.54057 37.2188 12.7812C40.4594 16.0218 42.28 20.4171 42.28 25H43Z" fill="#E17100"></path><path d="M43 25C43 29.7739 41.1036 34.3523 37.7279 37.7279C34.3523 41.1036 29.7739 43 25 43C20.2261 43 15.6477 41.1036 12.2721 37.7279C8.89642 34.3523 7 29.7739 7 25H7.72C7.72 29.5829 9.54057 33.9782 12.7812 37.2188C16.0218 40.4594 20.4171 42.28 25 42.28C29.5829 42.28 33.9782 40.4594 37.2188 37.2188C40.4594 33.9782 42.28 29.5829 42.28 25H43Z" fill="#FFF4BA"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M25.4383 32.712C27.4385 32.7173 29.256 32.7221 30.6708 32.1912C32.8572 34.0388 35.4701 34.3689 36.5404 32.9185C37.6236 31.4507 36.7166 28.7153 34.5147 26.8087C34.237 26.5683 33.9521 26.3526 33.6639 26.1621C33.6294 19.4369 29.6875 14 24.83 14C19.951 14 15.9959 19.4851 15.9959 26.2512C15.9959 26.5311 16.0026 26.7988 16.0159 27.055C13.6344 28.6054 12.4107 31.1356 13.2796 32.7392C14.1577 34.3598 16.8404 34.4205 19.2715 32.8748C19.4834 32.7401 19.6864 32.5977 19.8798 32.4487C21.1345 32.7202 22.6195 32.7163 24.2217 32.712C24.4227 32.7115 24.6255 32.7109 24.83 32.7109C25.0344 32.7109 25.2373 32.7115 25.4383 32.712Z" fill="#E17100"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M25.4383 30.712C27.4385 30.7173 29.256 30.7221 30.6708 30.1912C32.8572 32.0388 35.4701 32.3689 36.5404 30.9185C37.6236 29.4507 36.7166 26.7153 34.5147 24.8087C34.237 24.5683 33.9521 24.3526 33.6639 24.1621C33.6294 17.4369 29.6875 12 24.83 12C19.951 12 15.9959 17.4851 15.9959 24.2512C15.9959 24.5311 16.0026 24.7988 16.0159 25.055C13.6344 26.6054 12.4107 29.1356 13.2796 30.7392C14.1577 32.3598 16.8404 32.4205 19.2715 30.8748C19.4834 30.7401 19.6864 30.5977 19.8798 30.4487C21.1345 30.7202 22.6195 30.7163 24.2217 30.712C24.4227 30.7115 24.6255 30.7109 24.83 30.7109C25.0344 30.7109 25.2373 30.7115 25.4383 30.712Z" fill="#FFF4BA"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M25.4383 31.712C27.4385 31.7173 29.256 31.7221 30.6708 31.1912C32.8572 33.0388 35.4701 33.3689 36.5404 31.9185C37.6236 30.4507 36.7166 27.7153 34.5147 25.8087C34.237 25.5683 33.9521 25.3526 33.6639 25.1621C33.6294 18.4369 29.6875 13 24.83 13C19.951 13 15.9959 18.4851 15.9959 25.2512C15.9959 25.5311 16.0026 25.7988 16.0159 26.055C13.6344 27.6054 12.4107 30.1356 13.2796 31.7392C14.1577 33.3598 16.8404 33.4205 19.2715 31.8748C19.4834 31.7401 19.6864 31.5977 19.8798 31.4487C21.1345 31.7202 22.6195 31.7163 24.2217 31.712C24.4227 31.7115 24.6255 31.7109 24.83 31.7109C25.0344 31.7109 25.2373 31.7115 25.4383 31.712Z" fill="#FFD700"></path><ellipse cx="24.9976" cy="22.982" rx="4.14994" ry="4.14994" fill="#FFF4BA"></ellipse><ellipse cx="25.0038" cy="22.9862" rx="2.62101" ry="2.62102" fill="#E17100"></ellipse><circle cx="25.0068" cy="22.9873" r="1.97166" fill="#FFD700"></circle><circle cx="25.0015" cy="22.9801" r="0.997639" fill="#E17100"></circle><mask id="path-12-inside-1_2401_1913" fill="white"><path d="M29.4521 22.9805C29.7547 22.9805 30.0031 22.7344 29.97 22.4336C29.8463 21.3087 29.3434 20.2528 28.5355 19.4449C27.5979 18.5073 26.3261 17.9805 25 17.9805C23.6739 17.9805 22.4021 18.5073 21.4645 19.4449C20.6566 20.2528 20.1537 21.3087 20.03 22.4336C19.9969 22.7344 20.2453 22.9805 20.5479 22.9805C20.8506 22.9805 21.0919 22.7339 21.1343 22.4343C21.252 21.6007 21.6372 20.822 22.2394 20.2198C22.9715 19.4877 23.9646 19.0764 25 19.0764C26.0354 19.0764 27.0285 19.4877 27.7606 20.2198C28.3628 20.822 28.748 21.6007 28.8657 22.4343C28.9081 22.7339 29.1494 22.9805 29.4521 22.9805Z"></path></mask><path d="M29.4521 22.9805C29.7547 22.9805 30.0031 22.7344 29.97 22.4336C29.8463 21.3087 29.3434 20.2528 28.5355 19.4449C27.5979 18.5073 26.3261 17.9805 25 17.9805C23.6739 17.9805 22.4021 18.5073 21.4645 19.4449C20.6566 20.2528 20.1537 21.3087 20.03 22.4336C19.9969 22.7344 20.2453 22.9805 20.5479 22.9805C20.8506 22.9805 21.0919 22.7339 21.1343 22.4343C21.252 21.6007 21.6372 20.822 22.2394 20.2198C22.9715 19.4877 23.9646 19.0764 25 19.0764C26.0354 19.0764 27.0285 19.4877 27.7606 20.2198C28.3628 20.822 28.748 21.6007 28.8657 22.4343C28.9081 22.7339 29.1494 22.9805 29.4521 22.9805Z" stroke="#E17100" stroke-width="2" mask="url(#path-12-inside-1_2401_1913)"></path><circle cx="24.3913" cy="21.9831" r="0.613932" fill="white"></circle><ellipse cx="26.0021" cy="24.2619" rx="0.283353" ry="0.283353" fill="white"></ellipse></svg>');function Ve(s,e){const t=Ee(e,"width",3,40),i=Ee(e,"height",3,40);var a=bl();I(()=>{K(a,"width",t()),K(a,"height",i())}),S(s,a)}var _l=D('<div class="content svelte-1fxce1q"><h1 class="svelte-1fxce1q"> </h1> <div class="scores"><h2 class="svelte-1fxce1q"> </h2> <h2 class="svelte-1fxce1q"> </h2></div> <div class="hint svelte-1fxce1q"><h2 class="svelte-1fxce1q">Hint:</h2> <p>- Click on an Enemy to kill it</p> <p>- Click on a gray spot to build a Tower</p> <p>- Click on a Tower to upgrade</p> <div class="additional-hint svelte-1fxce1q"><div>Manage your resources carefully if you want to survive until the last wave!</div> <div class="cost svelte-1fxce1q"><div class="cost-item svelte-1fxce1q"><div>Upgrading towers costs 35</div> <div><!></div></div> <div class="cost-item svelte-1fxce1q"><div>Enemy click costs 5</div> <div><!></div></div></div></div></div> <!></div>');function xl(s,e){Y(e,!0);const t=B(()=>j.get("stageManager"));li(()=>{k.reduceBgVolume()}),la(()=>{k.restoreBgVolume()}),$i(s,{children:(i,a)=>{var r=_l(),l=x(r),c=x(l,!0);C(l);var g=F(l,2),T=x(g),f=x(T);C(T);var w=F(T,2),p=x(w);C(w),C(g);var m=F(g,2),y=F(x(m),8),d=F(x(y),2),E=x(d),_=F(x(E),2),A=x(_);Ve(A,{width:13,height:13}),C(_),C(E);var L=F(E,2),q=F(x(L),2),M=x(q);Ve(M,{width:13,height:13}),C(q),C(L),C(d),C(y),C(m);var P=F(m,2);Ce(P,{get onclick(){return e.onRestart},text:"Restart"}),C(r),I(()=>{ne(c,o(t).stageResult==="win"?"You win!":"You lose!"),ne(f,`Enemies killed: ${be.killsEnemy??""}`),ne(p,`Score: ${be.score??""}`)}),W(1,r,()=>va,()=>({duration:500})),W(2,r,()=>ce,()=>({duration:300})),S(i,r)},$$slots:{default:!0}}),X()}function Fl(s){return s}function Bl(s){const e=s-1;return e*e*e+1}function ci(s){return Math.sin(-13*(s+1)*Math.PI/2)*Math.pow(2,-10*s)+1}var El=D(`<div class="overlay svelte-thh9az"><div class="backdrop svelte-thh9az"></div> <div class="hud-container svelte-thh9az"><div class="content svelte-thh9az"><button class="close-btn svelte-thh9az">&times;</button> <div class="header-section svelte-thh9az"><h2 class="modal-header svelte-thh9az">Combat Manual</h2> <div class="decoration-bar svelte-thh9az"></div></div> <div class="scroll-content svelte-thh9az"><section class="svelte-thh9az"><h3 class="svelte-thh9az"><span class="icon svelte-thh9az">üëë</span> Defend the Throne</h3> <p class="svelte-thh9az">Enemies will attack immediately. If your Throne is destroyed, it's Game Over!</p></section> <section class="svelte-thh9az"><h3 class="svelte-thh9az"><span class="icon svelte-thh9az">‚öîÔ∏è</span> Combat Protocol</h3> <p class="svelte-thh9az"><strong class="svelte-thh9az">Click Enemies</strong> to neutralize them directly.</p> <div class="cost-row svelte-thh9az"><span>Cost: 5 <!></span> <span class="separator svelte-thh9az">|</span> <span>Reward: Gold <!></span></div></section> <section class="svelte-thh9az"><h3 class="svelte-thh9az"><span class="icon svelte-thh9az">‚ùì</span> The "Chance" Event</h3> <p class="svelte-thh9az">Time dilates. A query appears. Your knowledge is your weapon.</p> <ul class="svelte-thh9az"><li class="good svelte-thh9az"><strong class="svelte-thh9az">Correct:</strong> +1 Build Point (Construct Defenses).</li> <li class="bad svelte-thh9az"><strong class="svelte-thh9az">Incorrect:</strong> Strike recorded. 3 Strikes = Tower Destruction.</li></ul></section> <section class="svelte-thh9az"><h3 class="svelte-thh9az"><span class="icon svelte-thh9az">üèóÔ∏è</span> Construction</h3> <div class="construction-grid svelte-thh9az"><div class="construction-item svelte-thh9az"><strong class="svelte-thh9az">Build</strong> <span>Click gray nodes.</span> <span class="highlight svelte-thh9az">Unlocks with Build Points</span></div> <div class="construction-item svelte-thh9az"><strong class="svelte-thh9az">Upgrade</strong> <span>Click towers.</span> <span class="highlight svelte-thh9az">Costs Gold + BP</span></div></div></section></div> <div class="footer svelte-thh9az"><!></div></div></div></div>`);function Al(s,e){var t=El(),i=x(t),a=F(i,2),r=x(a),l=x(r);l.__click=function(...E){var _;(_=e.onClose)==null||_.apply(this,E)};var c=F(l,4),g=F(x(c),2),T=F(x(g),4),f=x(T),w=F(x(f));Ve(w,{width:12,height:12}),C(f);var p=F(f,4),m=F(x(p));Ve(m,{width:12,height:12}),C(p),C(T),C(g),Ii(4),C(c);var y=F(c,2),d=x(y);Ce(d,{text:"Initialize",get onclick(){return e.onClose}}),C(y),C(r),C(a),C(t),W(3,i,()=>ce,()=>({duration:500})),W(3,a,()=>Oe,()=>({duration:600,start:.8,easing:ci})),W(3,t,()=>ce,()=>({duration:200})),S(s,t)}Ge(["click"]);var Sl=D('<div class="content svelte-p6vcf4"><img alt="Knowledge Space" style="width: 80%; max-width: 500px;" class="svelte-p6vcf4"> <div class="star-container svelte-p6vcf4"><img alt="Shooting Star" class="shooting-star-art svelte-p6vcf4"></div> <div class="svelte-p6vcf4"><h2 class="svelte-p6vcf4">Hint:</h2> <p class="svelte-p6vcf4">- Click on an Enemy to kill it</p> <p class="svelte-p6vcf4">- Click on a gray spot to build a Tower</p> <p class="svelte-p6vcf4">- Click on a Tower to upgrade</p></div> <div class="buttons-container svelte-p6vcf4"><!> <div style="height: 10px;" class="svelte-p6vcf4"></div> <!></div></div>'),Ml=D("<!> <!>",1);function kl(s,e){Y(e,!0);let t=v(!1);const i=B(()=>k.preloaded?"Start game":`${k.preloadPercent}%`);var a=Ml(),r=se(a);$i(r,{children:(g,T)=>{var f=Sl(),w=x(f);K(w,"src",`${bi??""}/logos/knowledge-space2.png`);var p=F(w,2),m=x(p);K(m,"src",`${bi??""}/enemies/enemies-riding-art.png`),C(p);var y=F(p,4),d=x(y),E=B(()=>!k.preloaded);Ce(d,{get disabled(){return o(E)},get text(){return o(i)},get onclick(){return e.onStart}});var _=F(d,4);Ce(_,{text:"How to Play",onclick:()=>h(t,!0)}),C(y),C(f),W(2,f,()=>ce,()=>({duration:300})),S(g,f)},$$slots:{default:!0}});var l=F(r,2);{var c=g=>{Al(g,{onClose:()=>h(t,!1)})};U(l,g=>{o(t)&&g(c)})}S(s,a),X()}class Dl{constructor(){$(this,"filterEnemiesByBounds",e=>j.get("entityManager").livingEnemies.filter(i=>Ne(i.boundingBox,e)))}update(){const e=j.get("entityManager");this.handleEnemyCollisions(e.livingEnemies,e.livingProjectiles,e.throne),this.handleProjectileCollisions(e.livingProjectiles),this.handleLootCollisions(e.livingLoot,e.throne)}handleEnemyCollisions(e,t,i){for(const a of e){for(const r of t)this.checkCollision(r,a)&&(r.onCollide(a),a.onCollide(r));this.checkCollision(a,i)&&(a.onCollide(i),i.onCollide(a))}}handleProjectileCollisions(e){for(const t of e)if(!this.checkScreenBounds(t)){t.onCollide("OUT_OF_BOUNDS");continue}}handleLootCollisions(e,t){e.forEach(i=>{this.checkCollision(i,t)&&(i.onCollide(t),t.onCollide(i))})}checkCollision(e,t){return Ne(e.boundingBox,t.boundingBox)}checkBounds(e,t){return Ne(e.boundingBox,t)}checkScreenBounds(e){return Ne(e.boundingBox,R.screenBounds)}checkGameBounds(e){return Ne(e.boundingBox,R.gameBoundingBox)}}var Ft,Hs,Vs,Ws,Ys,Xs,Zs,Js,Ks,ei,ti;class Pl{constructor(){u(this,Ft,v([]));u(this,Hs,B(()=>this.entities.filter(e=>e.type==="enemy")));u(this,Vs,B(()=>this.enemies.filter(e=>e.isInteractable)));u(this,Ws,B(()=>this.entities.filter(e=>e.type==="tower")));u(this,Ys,B(()=>this.towers.filter((e,t)=>t<=1)));u(this,Xs,B(()=>this.towers.filter((e,t)=>t>=2)));u(this,Zs,B(()=>this.entities.filter(e=>e.type==="projectile")));u(this,Js,B(()=>this.projectiles.filter(e=>e.isInteractable)));u(this,Ks,B(()=>this.entities.find(e=>e.type==="throne")));u(this,ei,B(()=>this.entities.filter(e=>e.type==="loot")));u(this,ti,B(()=>this.loot.filter(e=>e.isInteractable)));$(this,"update",e=>{this.entities.forEach(t=>t.update(e))});$(this,"reset",()=>{this.entities=[]});$(this,"add",e=>{this.entities=[...this.entities,...Array.isArray(e)?e:[e]]});$(this,"destroy",e=>{this.entities=this.entities.filter(t=>t.id!==e)});$(this,"getByName",e=>this.entities.find(t=>t.name===e));$(this,"getById",e=>this.entities.find(t=>t.id===e))}get entities(){return o(n(this,Ft))}set entities(e){h(n(this,Ft),e)}get enemies(){return o(n(this,Hs))}get livingEnemies(){return o(n(this,Vs))}get towers(){return o(n(this,Ws))}get topTowers(){return o(n(this,Ys))}get bottomTowers(){return o(n(this,Xs))}get projectiles(){return o(n(this,Zs))}get livingProjectiles(){return o(n(this,Js))}get throne(){return o(n(this,Ks))}get loot(){return o(n(this,ei))}get livingLoot(){return o(n(this,ti))}filterByName(e){return this.entities.filter(t=>Array.isArray(e)?e.includes(t.name):t.name===e)}findNearestEntity(e,t){const i=t.filter(c=>c.isInteractable);if(i.length===0)return;const a=i.map(c=>e.position.distance(c.position)),r=Math.min(...a),l=a.indexOf(r);return i[l]}findNearestEntities(e,t,i=3){const a=t.filter(c=>c.isInteractable);if(a.length===0)return;const r=a.map(c=>({target:c,distance:e.position.distance(c.position)}));r.sort((c,g)=>c.distance-g.distance);const l=Math.min(i,r.length);return r.slice(0,l).map(c=>c.target)}findByPosition(e){const t=ji(e,100,100);return this.entities.filter(i=>Ne(i.boundingBox,t))}}Ft=new WeakMap,Hs=new WeakMap,Vs=new WeakMap,Ws=new WeakMap,Ys=new WeakMap,Xs=new WeakMap,Zs=new WeakMap,Js=new WeakMap,Ks=new WeakMap,ei=new WeakMap,ti=new WeakMap;const No=[{commonEnemies:["PurpleCommon","YellowCommon"],time:6e4,eliteEnemies:["RedBlobElite"],spawnDelays:{common:900,elite:1400},statsAmplify:{health:1,speed:1,damage:1}},{commonEnemies:["YellowCommon","BlueCommon"],eliteEnemies:["GreenCircleElite","BlueCircleElite"],time:12e4,spawnDelays:{common:800,elite:1300},statsAmplify:{health:1.2,speed:1.2,damage:1.2}},{commonEnemies:["PurpleCommon","YellowCommon","BlueCommon"],eliteEnemies:["BlueBlobElite","GreenCircleElite","BlueCircleElite"],time:12e4,spawnDelays:{common:600,elite:1100},statsAmplify:{health:1.7,speed:1.4,damage:1.5}},{commonEnemies:["PurpleCommon","YellowCommon","BlueCommon"],eliteEnemies:["BlueCircleElite","GreenCircleElite","BlueBlobElite","RedBlobElite"],time:12e4,spawnDelays:{common:400,elite:800},statsAmplify:{health:2.2,speed:1.6,damage:1.8}}],De=(s,e)=>{s.takeDamage(e.stats.damage)},Ss=(s,e)=>{s.state.setState("Explode")},Il=(s,e)=>{e.type==="loot"?(be.receiveLoot(1),k.play("pickUp")):e.type==="enemy"&&s.takeDamage(e.stats.damage)},Ms=(s,e)=>{e.type==="enemy"&&(s.takeDamage(1),e.takeDamage(999))},Ll=(s,e)=>{s.stopInteractions(),j.get("entityManager").destroy(s.id)},pa={PurpleCommon:{type:"enemy",initialState:"FollowThrone",vfx:[],scale:.6,stateToAnimation:{FollowThrone:"PurpleCommonFollow",Die:"PurpleCommonDie"},stats:{health:20,speed:.03,damage:5},onCollide:De},YellowCommon:{type:"enemy",initialState:"FollowThrone",vfx:[],scale:.8,stateToAnimation:{FollowThrone:"YellowCommonFollow",Die:"YellowCommonDie"},stats:{health:15,speed:.025,damage:4},onCollide:De},BlueCommon:{type:"enemy",initialState:"FollowThrone",vfx:[],scale:.7,stateToAnimation:{FollowThrone:"BlueCommonFollow",Die:"BlueCommonDie"},stats:{health:25,speed:.02,damage:8},onCollide:De},GreenCircleElite:{type:"enemy",initialState:"FollowThrone",vfx:[],scale:1,stateToAnimation:{FollowThrone:"GreenCircleEliteFollow",Die:"GreenCircleEliteDie"},stats:{health:80,speed:.01,damage:15},onCollide:De},RedBlobElite:{type:"enemy",initialState:"FollowThrone",vfx:[],scale:.8,stateToAnimation:{FollowThrone:"RedBlobEliteFollow",Die:"RedBlobEliteDie"},stats:{health:30,speed:.015,damage:10},onCollide:De},BlueBlobElite:{type:"enemy",initialState:"FollowThrone",vfx:[],scale:1,stateToAnimation:{FollowThrone:"BlueBlobEliteFollow",Die:"BlueBlobEliteDie"},stats:{health:60,speed:.04,damage:8},onCollide:De},BlueCircleElite:{type:"enemy",initialState:"FollowThrone",vfx:[],scale:1,stateToAnimation:{FollowThrone:"BlueCircleEliteFollow",Die:"BlueCircleEliteDie"},stats:{health:70,speed:.02,damage:10},onCollide:De}},Rl=[s=>{},s=>{s.stats.attackSpeed-=50,s.stats.projectileNumber+=1},s=>{s.stats.attackSpeed-=50,s.stats.projectileNumber+=1}],jl=[s=>{},s=>{s.stats.attackSpeed-=50,s.stats.projectileNumber+=1},s=>{s.stats.attackSpeed-=50,s.stats.projectileNumber+=1}],$l=[s=>{},s=>{s.stats.attackSpeed-=50,s.stats.projectileNumber+=1},s=>{s.stats.attackSpeed-=50,s.stats.projectileNumber+=1}],ql=[s=>{},s=>{s.stats.attackSpeed-=50,s.stats.projectileNumber+=1},s=>{s.stats.attackSpeed-=30,s.stats.projectileNumber+=1}],ue={questionInterval:15e3,bulletTimeFactor:.05,questionDuration:1e4,maxStrikes:3,mainTowerHP:1e3,subTowerHP:3},ks={health:ue.subTowerHP,maxHealth:ue.subTowerHP,attackSpeed:800,projectileNumber:1},qi={Throne:{type:"throne",stats:{health:ue.mainTowerHP,maxHealth:ue.mainTowerHP,damage:999,speed:0},scale:.6,stateToAnimation:{Idle:"Throne",Die:"ThroneDestroyed"},initialState:"Idle",onCollide:Il},FireTower:{type:"tower",initialState:"NotBuilt",stateToAnimation:{Guard:"FireTowerBase0",Shoot:"FireTowerBase0",NotBuilt:"TowerBase",Upgrade:"FireTowerUpgrade0"},effects:[],stats:{...ks,projectileType:"Fireball"},scale:.8,upgrades:Rl,onCollide:Ms},ThunderTower:{type:"tower",initialState:"NotBuilt",stateToAnimation:{Guard:"ThunderTowerBase0",Shoot:"ThunderTowerBase0",NotBuilt:"TowerBase",Upgrade:"ThunderTowerUpgrade0"},effects:[],stats:{...ks,attackSpeed:750,projectileType:"Thunderbolt"},scale:.8,upgrades:$l,onCollide:Ms},PoisonTower:{type:"tower",initialState:"NotBuilt",stateToAnimation:{Guard:"PoisonTowerBase0",Shoot:"PoisonTowerBase0",NotBuilt:"TowerBase",Upgrade:"PoisonTowerUpgrade0"},effects:[],stats:{...ks,projectileType:"Poisonball"},scale:.8,upgrades:jl,onCollide:Ms},IceTower:{type:"tower",initialState:"NotBuilt",stateToAnimation:{Guard:"IceTowerBase0",Shoot:"IceTowerBase0",NotBuilt:"TowerBase",Upgrade:"IceTowerUpgrade0"},effects:[],stats:{...ks,attackSpeed:850,projectileType:"Icebolt"},scale:.8,upgrades:ql,onCollide:Ms}},wa={Fireball:{type:"projectile",width:20,height:22,vfx:[],initialState:"FollowTarget",stateToAnimation:{FollowTarget:"FireballFollow",FollowAngle:"FireballFollow",Explode:"FireballDie"},scale:2,stats:{health:1,speed:.5,damage:11},onCollide:Ss},Icebolt:{type:"projectile",width:10,height:27,vfx:[],initialState:"FollowTarget",stateToAnimation:{FollowTarget:"IceboltFollow",FollowAngle:"IceboltFollow",Explode:"IceboltDie"},scale:2,stats:{health:1,speed:.3,damage:11},onCollide:Ss},Poisonball:{type:"projectile",width:17,height:16,vfx:[],initialState:"FollowTarget",stateToAnimation:{FollowTarget:"PoisonballFollow",FollowAngle:"PoisonballFollow",Explode:"PoisonballDie"},scale:2,stats:{health:1,speed:.4,damage:11},onCollide:Ss},Thunderbolt:{type:"projectile",width:17,height:31,vfx:[],initialState:"FollowTarget",stateToAnimation:{FollowTarget:"ThunderboltFollow",FollowAngle:"ThunderboltFollow",Explode:"ThunderboltDie"},scale:2,stats:{health:1,speed:.4,damage:11},onCollide:Ss},Loot:{type:"loot",vfx:[],width:14,height:19,initialState:"FollowTarget",stateToAnimation:{FollowTarget:"Loot"},scale:1,stats:{health:1,damage:0,speed:.5},onCollide:Ll},ClickExplode:{type:"projectile",vfx:[],width:30,height:30,initialState:"Explode",stateToAnimation:{Explode:"Click"},scale:1,stats:{health:1,damage:10,speed:.5}}},Bi={...pa,...qi,...wa},Uo=Object.keys(pa).length+Object.keys(qi).length+Object.keys(wa).length,zo=Object.keys(Bi).length;if(Uo!==zo)throw new Error(`Entities defined and exported do not match. Check for duplicated Entity names : Total count: ${Uo} / Exported count ${zo}`);const Nl=s=>{if(!Bi[s])throw new Error(`Entity config not found for: ${s}`);return Bi[s]};var Bt;class me{constructor(e){u(this,Bt,v());this.stateMachine=e}get stateMachine(){return o(n(this,Bt))}set stateMachine(e){h(n(this,Bt),b(e))}update(e,t){}get name(){return this.constructor.name}get entity(){return this.stateMachine.owner}}Bt=new WeakMap;let Ul=class extends me{constructor(e){super(e),e.owner.stopInteractions(),this.entity.removeCollider()}update(){if(this.entity.animation.isComplete){const{entityManager:e,stageManager:t}=j.get(["entityManager","stageManager"]);e.destroy(this.entity.id),t.spawnLoot(this.entity)}}};class zl extends me{constructor(){super(...arguments);$(this,"lastAngle",0)}update(t){this.follow(t)}follow(t){const{throne:i}=this.stateMachine.context;if(!i.width||i.position.x===0&&i.position.y===0)return;const a=i.position;this.entity.rotation=fa(this.entity.position,a);const l=Ri(this.entity.rotation).multiply(this.entity.stats.speed*t);this.entity.position=this.entity.position.add(l)}}const Ol=Object.freeze(Object.defineProperty({__proto__:null,Die:Ul,FollowThrone:zl},Symbol.toStringTag,{value:"Module"}));class Ql extends me{constructor(){super(...arguments);$(this,"isSetup",!1)}update(t,i){this.isSetup||(R.isMobile?this.entity.position.y+=30:this.entity.position.y+=35,this.isSetup=!0)}}const ya=s=>s===1?"1":s===2?"2":"0",Gl=(s,e)=>`${s.name}Upgrade${ya(e)}`,Oo=(s,e)=>`${s.name}Base${ya(e)}`;class Hl extends me{constructor(e){super(e),this.entity.upgradeLevel+=1;const t=this.entity.upgrades[this.entity.upgradeLevel];t(this.entity),this.entity.animation.onFrameChange=i=>{},k.play("towerUpgrade")}update(e){this.entity.animation.isComplete&&(this.entity.stateToAnimation={...this.entity.stateToAnimation,Guard:Oo(this.entity,this.entity.upgradeLevel),Shoot:Oo(this.entity,this.entity.upgradeLevel),Upgrade:Gl(this.entity,this.entity.upgradeLevel+1)},this.entity.state.setState("Guard"),this.entity.animation.onFrameChange=()=>{})}}class Vl extends me{constructor(e){super(e);const t=j.get("gameLoop"),i=this.entity.stats.attackSpeed;this.cdId=t.setCD(i,!0)}update(){const{entityManager:e,gameLoop:t}=j.get(["entityManager","gameLoop"]),i=e.findNearestEntity(this.entity,e.enemies);t.isCDReady(this.cdId)&&i&&this.stateMachine.setState("Shoot",{spawner:this.entity,target:i})}}class Wl extends me{update(){this.shoot(),this.entity.addVFX("TowerShoot"),this.entity.state.setState("Guard")}shoot(){const e=j.get("stageManager"),{spawner:t}=this.stateMachine.context,i=t.stats.projectileType,a=this.entity.stats.projectileNumber,r=t.position.add(new le(t.width/2,0)),l=j.get("entityManager");l.findNearestEntities(t,l.enemies,a).forEach(g=>{e.spawnEntity(i,r,{spawner:t,target:g})}),k.play("towerShoot")}}const Yl=Object.freeze(Object.defineProperty({__proto__:null,Guard:Vl,NotBuilt:Ql,Shoot:Wl,Upgrade:Hl},Symbol.toStringTag,{value:"Module"}));class Xl extends me{update(e){this.follow(e)}follow(e){const{angle:t}=this.stateMachine.context,a=Ri(t).multiply(this.entity.stats.speed*e);this.entity.position=this.entity.position.add(a),this.entity.rotation=t*180/Math.PI+90}}class Zl extends me{constructor(){super(...arguments);$(this,"lastAngle",0);$(this,"rotationOffset",90)}update(t){const{target:i}=this.stateMachine.context;i!=null&&i.isInteractable?this.followTarget(t,i):this.stateMachine.setState("FollowAngle",{angle:this.lastAngle})}getTopMiddlePoint(t){return ji(t.position,t.width,t.height).topMiddle}followTarget(t,i){const a=this.entity.boundingBox.center;this.getTopMiddlePoint(i),this.lastAngle=fa(a,i.boundingBox.center),this.entity.rotation=this.lastAngle*180/Math.PI+this.rotationOffset;const l=Ri(this.lastAngle).multiply(this.entity.stats.speed*t);this.entity.position=this.entity.position.add(l)}}class Jl extends me{constructor(e){super(e),this.entity.removeCollider(),this.entity.width=30,this.entity.height=30,this.entity.animation.onFrameChange=t=>{this.entity.scale+=.5},e.owner.stopInteractions()}update(){(!this.entity.animation||this.entity.animation&&this.entity.animation.isComplete)&&(j.get("entityManager").destroy(this.entity.id),this.entity.animation.onFrameChange=()=>{})}}const Kl=Object.freeze(Object.defineProperty({__proto__:null,Explode:Jl,FollowAngle:Xl,FollowTarget:Zl},Symbol.toStringTag,{value:"Module"}));class ec extends me{constructor(){super(...arguments);$(this,"lastAnimName","")}update(t,i){if(!i||!i.stats)return;const a=i.stats.health/i.stats.maxHealth;let r="Throne";if(a<=0?r="ThroneDestroyed":a<.25?r="ThroneDamaged3":a<.5?r="ThroneDamaged2":a<.75&&(r="ThroneDamaged1"),i.animation&&i.animation.name!==r){this.lastAnimName&&this.lastAnimName!==r&&(i.removeVFX("Smoke"),i.addVFX("Smoke"),k.play("break"));const l=ze(r);i.animation=new Li(l),this.lastAnimName=r}else!this.lastAnimName&&i.animation&&(this.lastAnimName=i.animation.name)}}class tc extends me{constructor(e){super(e),this.entity.stopInteractions(),this.entity.addVFX("Explosion"),k.play("destruction"),setTimeout(()=>{j.get("stageManager").gameOver("lose")},2e3)}}const sc=Object.freeze(Object.defineProperty({__proto__:null,Die:tc,Idle:ec},Symbol.toStringTag,{value:"Module"})),Qo=(s,e,t,i={})=>{let a={};e==="enemy"?a=Ol:e==="tower"?a=Yl:["projectile","loot"].includes(e)?a=Kl:e==="throne"&&(a=sc);const r=a[t];if(!r)throw new Error(`Invalid entity type: ${e} with name ${t}`);return new r(s,i)};var Et,At;class ic{constructor({owner:e,initialState:t,onEnter:i,context:a={}}){u(this,Et,v());u(this,At,v());this.owner=e,this.onEnter=i,this.context=a,this.onEnter(t),this.currentState=Qo(this,e.type,t,a)}get currentState(){return o(n(this,Et))}set currentState(e){h(n(this,Et),b(e))}get context(){return o(n(this,At))}set context(e){h(n(this,At),b(e))}update(e,t){this.currentState.update(e,this.owner,t)}setState(e,t={}){e!==this.currentState.name&&(this.onEnter(e),this.context={...this.context,...t},this.currentState=Qo(this,this.owner.type,e,t))}}Et=new WeakMap,At=new WeakMap;var St,Mt,kt,Dt,Pt,It,Lt,Rt,jt,$t,qt,Nt,Ut,zt,Ot,Qt,Gt,Ht,Vt,si;const ii=class ii{constructor(e,t,{offsetPosition:i,staticSlot:a,width:r,height:l,scale:c,rotation:g,type:T,states:f,initialState:w,onCollide:p,stats:m,upgradeLevel:y,upgrades:d,vfx:E,effects:_,stateToAnimation:A},L){$(this,"id");u(this,St,v(0));u(this,Mt,v(0));u(this,kt,v(""));u(this,Dt,v(""));u(this,Pt,v(0));u(this,It,v(0));u(this,Lt,v([]));u(this,Rt,v([]));u(this,jt,v());u(this,$t,v());u(this,qt,v());u(this,Nt,v(b({})));u(this,Ut,v(0));u(this,zt,v(1));u(this,Ot,v(1));u(this,Qt,v(!0));u(this,Gt,v(b({})));u(this,Ht,v(-1));u(this,Vt,v([]));u(this,si,B(()=>this.upgrades.length&&this.upgradeLevel<this.upgrades.length));$(this,"setPosition",e=>{this.position=e});this.id=ii.lastId++,this.name=e,this.type=T,this.width=r,this.height=l,this.scale=c||1,this.rotation=g||0,this.position=t,this.offsetPosition=i||null,this.staticSlot=a||null,this.stats={...m},this.upgradeLevel=y||-1,this.upgrades=d||[],this.vfx=E||[],this.effects=_||[],this.stateToAnimation=A||{},this.onCollide=M=>p(this,M);const q=M=>{this.stateToAnimation[M]&&this.setAnimation(M)};this.state=new ic({owner:this,states:f,initialState:w,onEnter:q,context:L})}get x(){return o(n(this,St))}set x(e){h(n(this,St),b(e))}get y(){return o(n(this,Mt))}set y(e){h(n(this,Mt),b(e))}get name(){return o(n(this,kt))}set name(e){h(n(this,kt),b(e))}get type(){return o(n(this,Dt))}set type(e){h(n(this,Dt),b(e))}get width(){return o(n(this,Pt))}set width(e){h(n(this,Pt),b(e))}get height(){return o(n(this,It))}set height(e){h(n(this,It),b(e))}get effects(){return o(n(this,Lt))}set effects(e){h(n(this,Lt),e)}get vfx(){return o(n(this,Rt))}set vfx(e){h(n(this,Rt),e)}get animation(){return o(n(this,jt))}set animation(e){h(n(this,jt),e)}get position(){return o(n(this,$t))}set position(e){h(n(this,$t),b(e))}get state(){return o(n(this,qt))}set state(e){h(n(this,qt),b(e))}get stats(){return o(n(this,Nt))}set stats(e){h(n(this,Nt),b(e))}get rotation(){return o(n(this,Ut))}set rotation(e){h(n(this,Ut),b(e))}get scale(){return o(n(this,zt))}set scale(e){h(n(this,zt),b(e))}get opacity(){return o(n(this,Ot))}set opacity(e){h(n(this,Ot),b(e))}get isInteractable(){return o(n(this,Qt))}set isInteractable(e){h(n(this,Qt),b(e))}get stateToAnimation(){return o(n(this,Gt))}set stateToAnimation(e){h(n(this,Gt),b(e))}get upgradeLevel(){return o(n(this,Ht))}set upgradeLevel(e){h(n(this,Ht),b(e))}get upgrades(){return o(n(this,Vt))}set upgrades(e){h(n(this,Vt),e)}get isUpgradable(){return o(n(this,si))}get boundingBox(){const e=this.position.x,t=this.position.y,i=this.position.x+this.width,a=this.position.y+this.height;return{x1:e,y1:t,x2:i,y2:a,center:new le(e+this.width/2,t+this.height/2),topMiddle:new le(e+this.width/2,a)}}update(e){this.isDestroyed||(this.state.update(e),this.effects.forEach(t=>{t(this)}),this.animation&&this.animation.update(e))}setAnimation(e){const t=this.stateToAnimation[e],i=ze(t);this.animation=new Li({...i,name:t})}addEffect(e){this.effects.includes(e)||(this.effects=[...this.effects,e])}removeEffect(e){this.effects=this.effects.filter(t=>t!==e)}cleanEffects(){this.effects=[]}addVFX(e){this.vfx.includes(e)||(this.vfx=[...this.vfx,e])}removeVFX(e){this.vfx=this.vfx.filter(t=>t!==e)}cleanVFX(){this.vfx=[]}takeDamage(e){this.stats.health-=e,this.stats.health<=0&&this.state.setState("Die")}stopInteractions(){this.isInteractable=!1}removeCollider(){this.onCollide=()=>{}}};St=new WeakMap,Mt=new WeakMap,kt=new WeakMap,Dt=new WeakMap,Pt=new WeakMap,It=new WeakMap,Lt=new WeakMap,Rt=new WeakMap,jt=new WeakMap,$t=new WeakMap,qt=new WeakMap,Nt=new WeakMap,Ut=new WeakMap,zt=new WeakMap,Ot=new WeakMap,Qt=new WeakMap,Gt=new WeakMap,Ht=new WeakMap,Vt=new WeakMap,si=new WeakMap,$(ii,"lastId",0);let Ei=ii;const oc=(s,e,t={})=>{const{context:i={},...a}=Nl(s),{initialState:r,...l}=t;return r&&(a.initialState=r),new Ei(s,e.clone(),a,{...i,...l})},ac=B(()=>({top:[{x:R.width*.1,y:20},{x:R.width*.3,y:20},{x:R.width*.5,y:20},{x:R.width*.7,y:20},{x:R.width*.9,y:20}],bottom:[{x:R.width*.1,y:R.height-20},{x:R.width*.3,y:R.height-20},{x:R.width*.5,y:R.height-20},{x:R.width*.7,y:R.height-20},{x:R.width*.9,y:R.height-20}],left:[{x:20,y:R.height*.1},{x:20,y:R.height*.3},{x:20,y:R.height*.5},{x:20,y:R.height*.7},{x:20,y:R.height*.9}],right:[{x:R.width-20,y:R.height*.1},{x:R.width-20,y:R.height*.3},{x:R.width-20,y:R.height*.5},{x:R.width-20,y:R.height*.7},{x:R.width-20,y:R.height*.9}]})),rc=()=>{const s=R.isMobile?["top","bottom"]:["top","bottom","left","right"],e=s[Math.floor(Math.random()*s.length)],t=o(ac)[e];return t[Math.floor(Math.random()*t.length)]},nc=s=>s[Math.floor(Math.random()*s.length)];var Wt,oi,Yt,Xt;class lc{constructor(){u(this,Wt,v(0));u(this,oi,B(()=>No[this.stageNumber]));u(this,Yt,v(0));$(this,"commonSpawnCd");$(this,"eliteSpawnCd");u(this,Xt,v(""));$(this,"init",()=>{const e=j.get("gameLoop");this.commonSpawnCd=e.setCD(this.stageConfig.spawnDelays.common,!0),this.eliteSpawnCd=e.setCD(this.stageConfig.spawnDelays.elite,!0),this.spawnTowers(),this.spawnEntity("Throne",new le(0,0))});$(this,"update",e=>{const t=j.get("gameLoop");t.isCDReady(this.commonSpawnCd)&&this.spawnEnemy("common"),t.isCDReady(this.eliteSpawnCd)&&this.spawnEnemy("elite"),this.checkStageTime()});$(this,"spawnEntity",(e,t,i={})=>{const a=j.get("entityManager"),r=oc(e,t,i);return a.add(r),r})}get stageNumber(){return o(n(this,Wt))}set stageNumber(e){h(n(this,Wt),b(e))}get stageConfig(){return o(n(this,oi))}get stageStartTime(){return o(n(this,Yt))}set stageStartTime(e){h(n(this,Yt),b(e))}get stageResult(){return o(n(this,Xt))}set stageResult(e){h(n(this,Xt),b(e))}reset(){this.commonSpawnCd=null,this.eliteSpawnCd=null,this.stageNumber=0,this.stageResult="",this.init()}spawnTowers(){["IceTower","FireTower","PoisonTower","ThunderTower"].forEach((e,t)=>{this.spawnEntity(e,new le(0,0))})}apllyAmlify(e){const{statsAmplify:t}=this.stageConfig;e.stats.health*=t.health,e.stats.damage*=t.damage,e.stats.speed*=t.speed}spawnEnemy(e){const t=j.get("entityManager"),i=e==="common"?this.stageConfig.commonEnemies:this.stageConfig.eliteEnemies,a=nc(i),r=rc(),l=new le(r.x,r.y),c=this.spawnEntity(a,l,{throne:t.throne});return this.apllyAmlify(c),c}spawnLoot(e){const i=j.get("entityManager").throne;this.spawnEntity("Loot",e.boundingBox.center,{target:i})}gameOver(e){this.stageResult=e,j.get("gameLoop").pause()}checkStageTime(){const e=j.get("gameLoop");this.stageStartTime+this.stageConfig.time<e.elapsedTime&&this.nextStage()}nextStage(){if(this.stageNumber<No.length-1){const e=j.get("gameLoop");this.stageNumber++,this.stageStartTime=e.elapsedTime,this.commonSpawnCd=e.setCD(this.stageConfig.spawnDelays.common,!0),this.eliteSpawnCd=e.setCD(this.stageConfig.spawnDelays.elite,!0)}else this.gameOver("win")}}Wt=new WeakMap,oi=new WeakMap,Yt=new WeakMap,Xt=new WeakMap;const Ti=16.666;var Zt,Jt,Kt,es,ts,ss;const ai=class ai{constructor(){u(this,Zt,v(b(performance.now())));u(this,Jt,v(0));u(this,Kt,v(0));u(this,es,v(1));u(this,ts,v(null));$(this,"isStopped",!1);u(this,ss,v(b({})));this.loop=this.loop.bind(this),this.previousTime=0,this.elapsedTime=0,this.accumulator=0}get previousTime(){return o(n(this,Zt))}set previousTime(e){h(n(this,Zt),b(e))}get accumulator(){return o(n(this,Jt))}set accumulator(e){h(n(this,Jt),b(e))}get elapsedTime(){return o(n(this,Kt))}set elapsedTime(e){h(n(this,Kt),b(e))}get timeScale(){return o(n(this,es))}set timeScale(e){h(n(this,es),b(e))}get pauseState(){return o(n(this,ts))}set pauseState(e){h(n(this,ts),b(e))}get cooldowns(){return o(n(this,ss))}set cooldowns(e){h(n(this,ss),b(e))}get elapsedInSeconds(){return this.elapsedTime/1e3}start(e){this.isStopped=!1,this.pauseState=null,this.timeScale=1,this.update=e,this.previousTime=performance.now(),requestAnimationFrame(this.loop)}stop(){this.isStopped=!0,this.pauseState=null}reset(){this.previousTime=0,this.elapsedTime=0,this.accumulator=0}loop(e){if(this.isStopped)return;if(this.pauseState){this.previousTime=e,requestAnimationFrame(this.loop);return}let t=e-this.previousTime;for(t>250&&(t=250),this.previousTime=e,this.accumulator+=t*this.timeScale,this.elapsedTime+=t*this.timeScale;this.accumulator>=Ti;)this.update(Ti),this.accumulator-=Ti;requestAnimationFrame(this.loop)}setCD(e,t=!1){const i=ai.lastCDId++;return this.cooldowns[i]={waitTime:e,isInfinite:t,startTime:this.elapsedTime},i}isCDReady(e){const t=this.cooldowns[e];return!t||this.pauseState||this.elapsedTime-t.startTime<=t.waitTime?!1:t.isInfinite?(this.cooldowns[e]={...t,startTime:this.elapsedTime},!0):(delete this.cooldowns[e],!0)}pause(){this.pauseState?this.resume():this.pauseState={pausedTime:this.elapsedTime}}resume(){if(!this.pauseState)return;const e=performance.now();this.previousTime=e,this.pauseState=null}};Zt=new WeakMap,Jt=new WeakMap,Kt=new WeakMap,es=new WeakMap,ts=new WeakMap,ss=new WeakMap,$(ai,"lastCDId",0);let Ai=ai;const cc=[{id:"q1",question:"What is the capital of France?",options:["London","Berlin","Paris","Madrid"],correctIndex:2,meta:{subject:"Geography",level:"Easy"}},{id:"q2",question:"What is 12 * 12?",options:["122","144","124","148"],correctIndex:1,meta:{subject:"Math",level:"Medium"}},{id:"q3",question:"Which planet is known as the Red Planet?",options:["Earth","Mars","Jupiter","Venus"],correctIndex:1,meta:{subject:"Astronomy",level:"Easy"}},{id:"q4",question:"What is the chemical symbol for Gold?",options:["Au","Ag","Fe","Cu"],correctIndex:0,meta:{subject:"Chemistry",level:"Medium"}},{id:"q5",question:"Who wrote 'Romeo and Juliet'?",options:["Charles Dickens","William Shakespeare","Mark Twain","Jane Austen"],correctIndex:1,meta:{subject:"Literature",level:"Easy"}},{id:"q6",question:"What is the square root of 64?",options:["6","7","8","9"],correctIndex:2,meta:{subject:"Math",level:"Easy"}},{id:"q7",question:"Physics: What is the unit of force?",options:["Joule","Watt","Newton","Pascal"],correctIndex:2,meta:{subject:"Physics",level:"Medium"}},{id:"q8",question:"Which element has the atomic number 1?",options:["Helium","Hydrogen","Lithium","Carbon"],correctIndex:1,meta:{subject:"Chemistry",level:"Easy"}},{id:"q9",question:"What year did World War II end?",options:["1942","1945","1948","1950"],correctIndex:1,meta:{subject:"History",level:"Hard"}},{id:"q10",question:"What is the largest ocean on Earth?",options:["Atlantic","Indian","Arctic","Pacific"],correctIndex:3,meta:{subject:"Geography",level:"Medium"}}];function Go(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(s){var e=Math.random()*16|0,t=s=="x"?e:e&3|8;return t.toString(16)})}class dc{constructor(){this.pendingRequests=new Map,this.eventListeners=new Map,this.isReactNative=!!window.ReactNativeWebView,this._handleMessage=this._handleMessage.bind(this),this._setupMessageListener()}_postMessage(e,t,i={},a=null){const r={type:e,action:t,payload:i,requestId:a||Go()};return this.isReactNative?window.ReactNativeWebView.postMessage(JSON.stringify(r)):window.parent.postMessage(r,"*"),r.requestId}_sendRequest(e,t={}){return new Promise((i,a)=>{const r=Go();this.pendingRequests.set(r,{resolve:i,reject:a}),this._postMessage("IGNITE_GAME_EVENT",e,t,r),setTimeout(()=>{this.pendingRequests.has(r)&&(this.pendingRequests.delete(r),a(new Error(`Request timeout for action: ${e}`)))},1e4)})}_sendEvent(e,t={}){this._postMessage("IGNITE_GAME_EVENT",e,t)}_setupMessageListener(){window.addEventListener("message",this._handleMessage),document.addEventListener("message",this._handleMessage)}_handleMessage(e){let t=e.data;if(typeof t=="string")try{t=JSON.parse(t)}catch{return}if(!t||t.type!=="IGNITE_CLIENT_RESPONSE"&&t.type!=="IGNITE_CLIENT_EVENT")return;const{action:i,payload:a,requestId:r,error:l}=t;if(r&&this.pendingRequests.has(r)){const{resolve:c,reject:g}=this.pendingRequests.get(r);l?g(new Error(l)):c(a),this.pendingRequests.delete(r);return}this.eventListeners.has(i)&&this.eventListeners.get(i).forEach(c=>c(a))}on(e,t){this.eventListeners.has(e)||this.eventListeners.set(e,[]),this.eventListeners.get(e).push(t)}off(e,t){if(!this.eventListeners.has(e))return;const i=this.eventListeners.get(e),a=i.indexOf(t);a>-1&&i.splice(a,1)}init(){return this._sendRequest("INIT_GAME",{})}getQuestions(e=10){return this._sendRequest("GET_QUESTION_BATCH",{limit:e})}submitAnswer(e,t,i){return this._sendRequest("SUBMIT_ANSWER",{questionUuid:e,isCorrect:t,timeTaken:i})}levelComplete(e,t){this._sendEvent("LEVEL_COMPLETE",{score:e,stars:t})}}const He=new dc;typeof window<"u"&&(window.GameBridge=He);var is,os,as,rs,ns,ls,cs,ds,us,hs,ms,gs,vs;class Ca{constructor(){u(this,is,v(b(cc)));u(this,os,v(b([])));u(this,as,v(!1));u(this,rs,v(null));u(this,ns,v(!1));u(this,ls,v(1));u(this,cs,v(0));u(this,ds,v(0));u(this,us,v(0));u(this,hs,v(0));u(this,ms,v(0));u(this,gs,v(0));u(this,vs,v(!1));this.reset(),this.init()}get questions(){return o(n(this,is))}set questions(e){h(n(this,is),b(e))}get questionQueue(){return o(n(this,os))}set questionQueue(e){h(n(this,os),b(e))}get isLoadingQuestions(){return o(n(this,as))}set isLoadingQuestions(e){h(n(this,as),b(e))}get currentQuestion(){return o(n(this,rs))}set currentQuestion(e){h(n(this,rs),b(e))}get isActive(){return o(n(this,ns))}set isActive(e){h(n(this,ns),b(e))}get timeScale(){return o(n(this,ls))}set timeScale(e){h(n(this,ls),b(e))}get timer(){return o(n(this,cs))}set timer(e){h(n(this,cs),b(e))}get initialTimer(){return o(n(this,ds))}set initialTimer(e){h(n(this,ds),b(e))}get strikes(){return o(n(this,us))}set strikes(e){h(n(this,us),b(e))}get gameTimeSinceLastQuestion(){return o(n(this,hs))}set gameTimeSinceLastQuestion(e){h(n(this,hs),b(e))}get buildPoints(){return o(n(this,ms))}set buildPoints(e){h(n(this,ms),b(e))}get wrongAnswerTrigger(){return o(n(this,gs))}set wrongAnswerTrigger(e){h(n(this,gs),b(e))}get distortedAudio(){return o(n(this,vs))}set distortedAudio(e){h(n(this,vs),b(e))}async init(){try{console.log("[QuestionManager] Initializing Bridge..."),He.init().then(e=>{console.log("[QuestionManager] Bridge Config:",e),this.fetchQuestions()}).catch(e=>{console.warn("[QuestionManager] Bridge init failed (dev mode?):",e)})}catch(e){console.warn("[QuestionManager] Bridge init failed, using mock mode.",e)}}async fetchQuestions(){if(!this.isLoadingQuestions){this.isLoadingQuestions=!0;try{console.log("[QuestionManager] Fetching questions...");const e=await He.getQuestions(5);if(e&&e.questions){const t=e.questions.map(i=>this.adaptBridgeQuestion(i));this.questionQueue.push(...t),console.log(`[QuestionManager] Fetched ${t.length} questions. Queue size: ${this.questionQueue.length}`)}}catch(e){console.warn("[QuestionManager] Failed to fetch questions (using mocks)",e)}finally{this.isLoadingQuestions=!1}}}adaptBridgeQuestion(e){const t=e.content||{},i=t.options||[];let a=[],r=-1;if(i.length>0){if(a=i.map(l=>({text:l.text||l.value||"",image:l.image||null,label:l.label||"",id:l.mysql_id})),r=i.findIndex(l=>l.is_correct===!0||l.isCorrect===!0),r===-1&&t.answer){const l=t.answer.mysql_id||t.answer.id;l&&(r=a.findIndex(c=>c.id===l))}r===-1&&(r=0)}return{id:e.uuid||e._id||e.id,question:t.text||t.question||"Unknown Question?",image:t.image||null,hint:t.hint||null,hintImage:t.hint_image||null,options:a,correctIndex:r,meta:e.meta}}reset(){this.isActive=!1,this.timeScale=1,this.strikes=0,this.buildPoints=0,this.gameTimeSinceLastQuestion=ue.questionInterval*.75,this.currentQuestion=null,this.questionQueue=[]}update(e){if(!this.isActive)this.gameTimeSinceLastQuestion+=e,this.gameTimeSinceLastQuestion>=ue.questionInterval&&this.triggerQuestion();else{const t=e/this.timeScale;this.timer-=t,this.timer<=0&&this.handleTimeout()}}triggerQuestion(){let e=null;if(this.questionQueue.length>0)e=this.questionQueue.shift(),this.questionQueue.length<3&&this.fetchQuestions();else{const t=Math.floor(Math.random()*this.questions.length);e=this.questions[t],this.fetchQuestions()}this.currentQuestion=e,this.currentQuestion.meta&&typeof this.currentQuestion.meta.time_needed=="number"?this.initialTimer=this.currentQuestion.meta.time_needed*1e3:this.initialTimer=ue.questionDuration,this.timer=this.initialTimer,this.gameTimeSinceLastQuestion=0,this.isActive=!0,this.timeScale=ue.bulletTimeFactor,j.get("gameLoop").timeScale=this.timeScale,this.distortedAudio=!0,k.setDistortion(!0)}answer(e){if(!this.currentQuestion)return;const t=e===this.currentQuestion.correctIndex,i=Math.max(0,(this.initialTimer-this.timer)/1e3);this.currentQuestion.id&&this.currentQuestion.id.length>5&&He.submitAnswer(this.currentQuestion.id,t,i).catch(a=>console.error(a)),t?this.handleCorrect():this.handleIncorrect(),this.closeQuestion()}handleCorrect(){if(this.buildPoints>=8){console.log("Correct! Max Points Reached -> +10 Gold");const e=j.get("lootTracker");e&&e.receiveLoot(10),k.play("towerUpgrade")}else console.log("Correct! +1 Build Point"),this.buildPoints++,k.play("towerUpgrade")}handleIncorrect(){console.log("Wrong!"),this.wrongAnswerTrigger++,k.play("lowResourse"),this.strikes++,this.strikes>=ue.maxStrikes&&(this.punishPlayer(),this.strikes=0)}handleTimeout(){this.currentQuestion&&this.currentQuestion.id&&this.currentQuestion.id.length>5&&He.submitAnswer(this.currentQuestion.id,!1,ue.questionDuration).catch(e=>console.error(e)),this.handleIncorrect(),this.closeQuestion()}punishPlayer(){var a,r;console.log("PUNISHMENT: Destroying Tower");const{entityManager:e}=j.get(["entityManager"]),i=e.towers.filter(l=>l.state.currentState!=="NotBuilt"&&l.type!=="throne");if(i.length>0){const l=i[0];console.log(`Destroying tower: ${l.name}`);const c=qi[l.name];c&&(l.stats={...c.stats},l.stateToAnimation={...c.stateToAnimation}),l.upgradeLevel=-1,l.state.setState("NotBuilt");const g=j.get("particleManager"),T=((a=l.position)==null?void 0:a.x)??l.x,f=((r=l.position)==null?void 0:r.y)??l.y;g&&g.spawnExplosion(T+l.width/2,f+l.height/2,"#ff0000",30)}}closeQuestion(){this.isActive=!1,this.timeScale=1,j.get("gameLoop").timeScale=1,this.currentQuestion=null,this.distortedAudio=!1,k.setDistortion(!1)}}is=new WeakMap,os=new WeakMap,as=new WeakMap,rs=new WeakMap,ns=new WeakMap,ls=new WeakMap,cs=new WeakMap,ds=new WeakMap,us=new WeakMap,hs=new WeakMap,ms=new WeakMap,gs=new WeakMap,vs=new WeakMap;new Ca;var fs,ps,ws,ys,Cs,Ts,bs;class uc{constructor(e,t,i){u(this,fs,v(0));u(this,ps,v(0));u(this,ws,v(0));u(this,ys,v(0));u(this,Cs,v(1));u(this,Ts,v("#ff0000"));u(this,bs,v(5));$(this,"decay",.05);this.x=e,this.y=t,this.color=i;const a=Math.random()*Math.PI*2,r=Math.random()*5+2;this.vx=Math.cos(a)*r,this.vy=Math.sin(a)*r,this.size=Math.random()*6+4,this.decay=Math.random()*.03+.02}get x(){return o(n(this,fs))}set x(e){h(n(this,fs),b(e))}get y(){return o(n(this,ps))}set y(e){h(n(this,ps),b(e))}get vx(){return o(n(this,ws))}set vx(e){h(n(this,ws),b(e))}get vy(){return o(n(this,ys))}set vy(e){h(n(this,ys),b(e))}get life(){return o(n(this,Cs))}set life(e){h(n(this,Cs),b(e))}get color(){return o(n(this,Ts))}set color(e){h(n(this,Ts),b(e))}get size(){return o(n(this,bs))}set size(e){h(n(this,bs),b(e))}update(e){this.x+=this.vx,this.y+=this.vy,this.life-=this.decay,this.size*=.95}}fs=new WeakMap,ps=new WeakMap,ws=new WeakMap,ys=new WeakMap,Cs=new WeakMap,Ts=new WeakMap,bs=new WeakMap;var _s;class hc{constructor(){u(this,_s,v(b([])))}get particles(){return o(n(this,_s))}set particles(e){h(n(this,_s),b(e))}update(e){this.particles=this.particles.filter(t=>t.life>0);for(const t of this.particles)t.update(e)}spawnExplosion(e,t,i="#ff4400",a=10){for(let r=0;r<a;r++)this.particles.push(new uc(e,t,i))}}_s=new WeakMap;var xs;class mc{constructor(){u(this,xs,v(!1));$(this,"update",async e=>{j.update(e),te.update(e)});$(this,"start",async()=>{j.setup(gc());const{gameLoop:e,stageManager:t,questionManager:i}=j.get(["gameLoop","stageManager","questionManager"]);t.init(),i.reset(),e.start(this.update),k.play("bgSound"),this.isStarted=!0});$(this,"restart",()=>{const{entityManager:e,gameLoop:t,stageManager:i,questionManager:a}=j.get(["entityManager","gameLoop","stageManager","questionManager"]);t.reset(),e.reset(),i.reset(),k.reset(),be.reset(),a.reset(),t.resume()});$(this,"cleanup",async()=>{if(this.isStarted){k.pause("bgSound");try{const e=j.get("gameLoop");e&&e.stop()}catch{}this.isStarted=!1}})}get isStarted(){return o(n(this,xs))}set isStarted(e){h(n(this,xs),b(e))}}xs=new WeakMap;const gc=()=>({collisionManager:new Dl,entityManager:new Pl,gameLoop:new Ai,stageManager:new lc,questionManager:new Ca,particleManager:new hc}),de=new mc,vc=()=>{k.toggleMute()};var fc=ri('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="24" height="24"><path d="M14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77zm-4 0h-2.5l-5 5H1.5v7.5h5l5 5v-17.5zM16.5 12c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02z"></path></svg>'),pc=ri('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="24" height="24"><path d="M16.5 12c0-1.77-1.02-3.29-2.5-4.03v2.21l2.45 2.45c.03-.2.05-.41.05-.63zm2.5 0c0 .94-.2 1.82-.54 2.64l1.51 1.51C20.63 14.91 21 13.5 21 12c0-4.28-2.99-7.86-7-8.77v2.06c2.89.86 5 3.54 5 6.71zM4.27 3L3 4.27 7.73 9H3v6h4l5 5v-6.73l4.25 4.25c-.67.52-1.42.93-2.25 1.18v2.06c1.38-.31 2.63-.95 3.69-1.81L19.73 21 21 19.73l-9-9L4.27 3zM12 4L9.91 6.09 12 8.18V4z"></path></svg>'),wc=D('<div class="content svelte-2dge9i"><div class="title svelte-2dge9i"><h1 class="svelte-2dge9i">Paused</h1></div> <div class="buttons-container svelte-2dge9i"><!> <!> <!></div></div>'),yc=D('<div class="confirm-overlay svelte-2dge9i"><div class="backdrop svelte-2dge9i"></div> <div class="confirm-box svelte-2dge9i"><div class="confirm-headers svelte-2dge9i"><h2 class="confirm-title svelte-2dge9i">Exit Protocol</h2> <div class="decoration-bar svelte-2dge9i"></div></div> <div class="confirm-body svelte-2dge9i"><p>Are you sure you want to abort mission?</p> <p class="warning svelte-2dge9i">Current progress will be lost.</p></div> <div class="confirm-actions svelte-2dge9i"><!> <!></div></div></div>'),Cc=D('<div class="pause-overlay svelte-2dge9i"><button class="sound-toggle svelte-2dge9i"><!></button> <!> <!></div>');function Tc(s,e){Y(e,!0);let t=v(!1);const i=async()=>{de.cleanup?await de.cleanup():de.isStarted=!1,h(t,!1)};li(()=>{k.reduceBgVolume()}),la(()=>{k.restoreBgVolume()});var a=Cc(),r=x(a);r.__click=[vc];var l=x(r);{var c=p=>{var m=fc();S(p,m)},g=p=>{var m=pc();S(p,m)};U(l,p=>{k.isMuted?p(g,!1):p(c)})}C(r);var T=F(r,2);$i(T,{children:(p,m)=>{var y=wc(),d=F(x(y),2),E=x(d);Ce(E,{text:"Resume Game",get onclick(){return e.onResume}});var _=F(E,2);Ce(_,{text:"Restart Game",get onclick(){return e.onRestart}});var A=F(_,2);Ce(A,{text:"Exit to Menu",onclick:()=>h(t,!0)}),C(d),C(y),S(p,y)},$$slots:{default:!0}});var f=F(T,2);{var w=p=>{var m=yc(),y=F(x(m),2),d=F(x(y),4),E=x(d);Ce(E,{text:"Yes",onclick:i});var _=F(E,2);Ce(_,{text:"No",onclick:()=>h(t,!1)}),C(d),C(y),C(m),W(3,y,()=>Oe,()=>({duration:400,start:.8,easing:ci})),W(3,m,()=>ce,()=>({duration:200})),S(p,m)};U(f,p=>{o(t)&&p(w)})}C(a),I(()=>{K(r,"aria-label",k.isMuted?"Unmute":"Mute"),K(r,"title",k.isMuted?"Unmute":"Mute")}),S(s,a),X()}Ge(["click"]);var bc=D('<div class="bg-container svelte-11qp6pd"><div class="gradient-bg svelte-11qp6pd">‚Ä¶</div> <div class="stars svelte-11qp6pd"></div></div>');function Ho(s){var e=bc();S(s,e)}var _c=D('<div class="bg-container svelte-1hdxkm"><div class="gradient-bg svelte-1hdxkm"></div> <div class="aurora svelte-1hdxkm"></div> <div class="stars svelte-1hdxkm"></div></div>');function xc(s){var e=_c();S(s,e)}var Fc=D('<div class="bg-container svelte-7703io"><div class="gradient-bg svelte-7703io"></div> <div class="stars svelte-7703io"></div></div>');function Bc(s){var e=Fc();S(s,e)}var Ec=D('<div class="bg-container svelte-10mh7j2"><div class="quantum-base svelte-10mh7j2"></div> <div class="energy-fields svelte-10mh7j2"></div> <div class="quantum-grid svelte-10mh7j2"></div> <div class="stars svelte-10mh7j2"></div></div>');function Ac(s){var e=Ec();S(s,e)}var Sc=D('<div class="background-container svelte-5o0ex9"><!></div>');function Mc(s,e){const t=[Ho,xc,Bc,Ac];let i=B(()=>t[e.stageNumber]||Ho);var a=ve(),r=se(a);_i(r,()=>e.stageNumber,l=>{var c=Sc(),g=x(c);sr(g,()=>o(i),(T,f)=>{f(T,{})}),C(c),W(1,c,()=>ce,()=>({duration:400})),W(2,c,()=>ce,()=>({duration:300})),S(l,c)}),S(s,a)}var kc=D('<div class="loot svelte-bipu4"><!> <span class="svelte-bipu4"> </span></div>');function Dc(s,e){Y(e,!0);let t=B(()=>be.playLowLootAnimation);var i=kc();const a=B(()=>te.get("arrow"));I(()=>N(i,"cursor",o(a)));var r=x(i);Ve(r,{});var l=F(r,2);const c=B(()=>te.get("arrow"));I(()=>N(l,"cursor",o(c)));var g=x(l,!0);C(l),C(i),I(()=>{Te(i,"isAnimated",o(t)),ne(g,be.collectedLoot)}),Qe("animationend",i,T=>{be.unsetAnimation("LowLoot")}),S(s,i),X()}var Pc=ri('<svg width="54" height="54" viewBox="0 0 54 54" fill="none" xmlns="http://www.w3.org/2000/svg"><mask id="path-1-outside-1_0_1" maskUnits="userSpaceOnUse" x="0" y="0" width="54" height="54" fill="black"><rect fill="white" width="54" height="54"></rect><path d="M50.0898 37.7747C50.35 37.8961 50.66 37.7837 50.7762 37.5211C53.2068 32.0286 53.6627 25.8578 52.0564 20.0591C50.4038 14.0933 46.6768 8.91281 41.5457 5.44952C36.4146 1.98623 30.2161 0.467392 24.0651 1.16617C17.9142 1.86495 12.2144 4.7355 7.99089 9.26151C3.76741 13.7875 1.29741 19.672 1.02516 25.8565C0.7529 32.0411 2.69625 38.1198 6.50568 42.9995C10.3151 47.8791 15.7406 51.2394 21.8064 52.476C27.7021 53.6779 33.8267 52.7968 39.1382 49.9927C39.3922 49.8586 39.4829 49.5416 39.3438 49.2904C39.2047 49.0392 38.8884 48.9488 38.6343 49.0827C33.5395 51.767 27.6672 52.6094 22.0141 51.457C16.191 50.2698 10.9825 47.0439 7.32545 42.3595C3.6684 37.675 1.80279 31.8394 2.06415 25.9023C2.32552 19.9651 4.69671 14.316 8.75126 9.97105C12.8058 5.62608 18.2776 2.87036 24.1825 2.19953C30.0875 1.5287 36.038 2.98679 40.9639 6.31154C45.8897 9.6363 49.4677 14.6095 51.0542 20.3368C52.5943 25.8968 52.1595 31.8132 49.8335 37.0813C49.7175 37.344 49.8295 37.6532 50.0898 37.7747Z"></path></mask><path d="M50.0898 37.7747C50.35 37.8961 50.66 37.7837 50.7762 37.5211C53.2068 32.0286 53.6627 25.8578 52.0564 20.0591C50.4038 14.0933 46.6768 8.91281 41.5457 5.44952C36.4146 1.98623 30.2161 0.467392 24.0651 1.16617C17.9142 1.86495 12.2144 4.7355 7.99089 9.26151C3.76741 13.7875 1.29741 19.672 1.02516 25.8565C0.7529 32.0411 2.69625 38.1198 6.50568 42.9995C10.3151 47.8791 15.7406 51.2394 21.8064 52.476C27.7021 53.6779 33.8267 52.7968 39.1382 49.9927C39.3922 49.8586 39.4829 49.5416 39.3438 49.2904C39.2047 49.0392 38.8884 48.9488 38.6343 49.0827C33.5395 51.767 27.6672 52.6094 22.0141 51.457C16.191 50.2698 10.9825 47.0439 7.32545 42.3595C3.6684 37.675 1.80279 31.8394 2.06415 25.9023C2.32552 19.9651 4.69671 14.316 8.75126 9.97105C12.8058 5.62608 18.2776 2.87036 24.1825 2.19953C30.0875 1.5287 36.038 2.98679 40.9639 6.31154C45.8897 9.6363 49.4677 14.6095 51.0542 20.3368C52.5943 25.8968 52.1595 31.8132 49.8335 37.0813C49.7175 37.344 49.8295 37.6532 50.0898 37.7747Z" fill="#D685DA"></path><path d="M50.0898 37.7747C50.35 37.8961 50.66 37.7837 50.7762 37.5211C53.2068 32.0286 53.6627 25.8578 52.0564 20.0591C50.4038 14.0933 46.6768 8.91281 41.5457 5.44952C36.4146 1.98623 30.2161 0.467392 24.0651 1.16617C17.9142 1.86495 12.2144 4.7355 7.99089 9.26151C3.76741 13.7875 1.29741 19.672 1.02516 25.8565C0.7529 32.0411 2.69625 38.1198 6.50568 42.9995C10.3151 47.8791 15.7406 51.2394 21.8064 52.476C27.7021 53.6779 33.8267 52.7968 39.1382 49.9927C39.3922 49.8586 39.4829 49.5416 39.3438 49.2904C39.2047 49.0392 38.8884 48.9488 38.6343 49.0827C33.5395 51.767 27.6672 52.6094 22.0141 51.457C16.191 50.2698 10.9825 47.0439 7.32545 42.3595C3.6684 37.675 1.80279 31.8394 2.06415 25.9023C2.32552 19.9651 4.69671 14.316 8.75126 9.97105C12.8058 5.62608 18.2776 2.87036 24.1825 2.19953C30.0875 1.5287 36.038 2.98679 40.9639 6.31154C45.8897 9.6363 49.4677 14.6095 51.0542 20.3368C52.5943 25.8968 52.1595 31.8132 49.8335 37.0813C49.7175 37.344 49.8295 37.6532 50.0898 37.7747Z" stroke="white" stroke-width="2" mask="url(#path-1-outside-1_0_1)"></path><circle cx="27" cy="27" r="16.5" fill="#D685DA" stroke="white"></circle><circle cx="45" cy="44" r="4.5" fill="#D685DA" stroke="white"></circle><rect x="20.5" y="20.5" width="5" height="13" rx="2.5" fill="#FFDFFC" stroke="white"></rect><rect x="28.5" y="20.5" width="5" height="13" rx="2.5" fill="#FFDFFC" stroke="white"></rect></svg>');function Ic(s){var e=Pc();S(s,e)}function Vo(s){return Object.prototype.toString.call(s)==="[object Date]"}function Si(s,e){if(s===e||s!==s)return()=>s;const t=typeof s;if(t!==typeof e||Array.isArray(s)!==Array.isArray(e))throw new Error("Cannot interpolate values of different type");if(Array.isArray(s)){const i=e.map((a,r)=>Si(s[r],a));return a=>i.map(r=>r(a))}if(t==="object"){if(!s||!e)throw new Error("Object cannot be null");if(Vo(s)&&Vo(e)){const r=s.getTime(),c=e.getTime()-r;return g=>new Date(r+g*c)}const i=Object.keys(e),a={};return i.forEach(r=>{a[r]=Si(s[r],e[r])}),r=>{const l={};return i.forEach(c=>{l[c]=a[c](r)}),l}}if(t==="number"){const i=e-s;return a=>s+a*i}throw new Error(`Cannot interpolate ${t} values`)}function Lc(s,e={}){const t=ar(s);let i,a=s;function r(l,c){if(a=l,s==null)return t.set(s=l),Promise.resolve();let g=i,T=!1,{delay:f=0,duration:w=400,easing:p=Fl,interpolate:m=Si}={...e,...c};if(w===0)return g&&(g.abort(),g=null),t.set(s=a),Promise.resolve();const y=ge.now()+f;let d;return i=ha(E=>{if(E<y)return!0;T||(d=m(s,l),typeof w=="function"&&(w=w(s,l)),T=!0),g&&(g.abort(),g=null);const _=E-y;return _>w?(t.set(s=l),!1):(t.set(s=d(p(_/w))),!0)}),i.promise}return{set:r,update:(l,c)=>r(l(a,s),c),subscribe:t.subscribe}}function Rc(s,e){k!=null&&k.preloaded&&k.play("clickMenu",!0),h(e,!o(e))}var jc=D('<div class="video-container svelte-8id4c4"><video autoplay playsinline="" class="star-video svelte-8id4c4"><track kind="captions" class="svelte-8id4c4"></video></div>',2),$c=D('<p class="question-text svelte-8id4c4"> </p>'),qc=D('<div class="question-image-container svelte-8id4c4"><img alt="Question Visual" class="question-img svelte-8id4c4"></div>'),Nc=D('<div class="meta-tag svelte-8id4c4"><span class="meta-label svelte-8id4c4">Subject:</span> <span class="meta-separator svelte-8id4c4">|</span> <span class="meta-label svelte-8id4c4">Level:</span> </div>'),Uc=D('<p class="hint-text svelte-8id4c4"> </p>'),zc=D('<div class="hint-image-container svelte-8id4c4"><img alt="Hint Visual" class="hint-img svelte-8id4c4"></div>'),Oc=D('<div class="hint-content svelte-8id4c4"><!> <!></div>'),Qc=D('<div class="hint-section svelte-8id4c4"><button class="hint-toggle-btn svelte-8id4c4"><span class="hint-icon svelte-8id4c4">?</span> </button> <!></div>'),Gc=D('<img class="option-img svelte-8id4c4">'),Hc=D('<span class="btn-text svelte-8id4c4"> </span>'),Vc=D('<button class="sci-fi-btn svelte-8id4c4"><div class="option-content svelte-8id4c4"><!> <!></div></button>'),Wc=D("<div></div>"),Yc=D('<div class="hud-container svelte-8id4c4"><div class="content svelte-8id4c4"><div class="header-section svelte-8id4c4"><h2 class="question-header svelte-8id4c4">Incoming Transmission</h2> <div class="timer-container svelte-8id4c4"><div class="timer-bar svelte-8id4c4"></div></div></div> <div class="question-scroll-area svelte-8id4c4"><div class="question-box svelte-8id4c4"><!> <!> <!> <!></div> <div class="options-grid svelte-8id4c4"></div></div> <div class="footer-section svelte-8id4c4"><div class="status-indicator svelte-8id4c4"><span class="status-label svelte-8id4c4">Strikes</span> <div class="strikes-container svelte-8id4c4"></div></div></div></div></div>'),Xc=D('<div class="overlay svelte-8id4c4"><div class="backdrop svelte-8id4c4"></div> <!> <!></div>');function Zc(s,e){Y(e,!0);const t=ir(),i=()=>or(l,"$progress",t),a=B(()=>j.get("questionManager")),r=B(()=>{var d;return(d=o(a))==null?void 0:d.currentQuestion}),l=Lc(100,{duration:400,easing:Bl});let c=v("idle"),g=v(!1),T=v(!1);Ie(()=>{if(o(a)&&o(a).isActive){const d=o(a).initialTimer>0?o(a).initialTimer:1e4;if(l.set(o(a).timer/d*100),o(c)==="idle"){h(c,"incoming"),h(g,!1),h(T,!1),k!=null&&k.preloaded&&k.play("shine");const E=1600,_=1900;setTimeout(()=>{h(c,"impact"),k!=null&&k.preloaded&&k.play("magicBurst")},E),setTimeout(()=>{h(c,"active")},_)}}else l.set(100,{duration:0}),h(c,"idle"),h(T,!1)});const f=B(()=>i()<30?"#ff3333":"#d685da");function w(d){k!=null&&k.preloaded&&k.play("clickMenu",!0),o(a).answer(d)}var p=ve(),m=se(p);{var y=d=>{var E=Xc(),_=x(E),A=F(_,2);{var L=P=>{var H=ve(),O=se(H);{var Z=z=>{var ae=jc(),Q=x(ae);I(()=>K(Q,"src",J("/videos/star-video.mp4"))),Q.muted=!0,C(ae),I(()=>Te(Q,"visible",o(g))),Qe("canplay",Q,()=>h(g,!0)),W(2,ae,()=>ce,()=>({duration:500})),S(z,ae)};U(O,z=>{z(Z)})}S(P,H)};U(A,P=>{(o(c)==="incoming"||o(c)==="impact")&&P(L)})}var q=F(A,2);{var M=P=>{var H=Yc(),O=x(H),Z=x(O),z=F(x(Z),2),ae=x(z);C(z),C(Z);var Q=F(Z,2),ie=x(Q),_e=x(ie);{var Ae=V=>{var G=$c(),ee=x(G,!0);C(G),I(()=>ne(ee,o(r).question)),S(V,G)};U(_e,V=>{o(r).question&&V(Ae)})}var Se=F(_e,2);{var Le=V=>{var G=qc(),ee=x(G);C(G),I(()=>K(ee,"src",o(r).image)),S(V,G)};U(Se,V=>{o(r).image&&V(Le)})}var Me=F(Se,2);{var xe=V=>{var G=Nc(),ee=F(x(G)),re=F(ee,4);C(G),I(()=>{ne(ee,` ${(o(r).meta.subject||"Unknown")??""} `),ne(re,` ${(o(r).meta.level||"1")??""}`)}),S(V,G)};U(Me,V=>{o(r).meta&&V(xe)})}var di=F(Me,2);{var Ta=V=>{var G=Qc(),ee=x(G);ee.__click=[Rc,T];var re=F(x(ee));C(ee);var hi=F(ee,2);{var Fs=Re=>{var je=Oc(),Bs=x(je);{var mi=we=>{var ke=Uc(),gi=x(ke,!0);C(ke),I(()=>ne(gi,o(r).hint)),S(we,ke)};U(Bs,we=>{o(r).hint&&we(mi)})}var fe=F(Bs,2);{var pe=we=>{var ke=zc(),gi=x(ke);C(ke),I(()=>K(gi,"src",o(r).hintImage)),S(we,ke)};U(fe,we=>{o(r).hintImage&&we(pe)})}C(je),W(3,je,()=>va,()=>({axis:"y",duration:300})),S(Re,je)};U(hi,Re=>{o(T)&&Re(Fs)})}C(G),I(()=>ne(re,` ${(o(T)?"Hide Data Fragment":"Decrypt Data Fragment (Hint)")??""}`)),S(V,G)};U(di,V=>{(o(r).hint||o(r).hintImage)&&V(Ta)})}C(ie);var ui=F(ie,2);const ba=B(()=>o(r).options.some(V=>V.image));I(()=>Te(ui,"has-images",o(ba))),he(ui,21,()=>o(r).options,Ls,(V,G,ee)=>{var re=Vc();re.__click=()=>w(ee);const hi=B(()=>te.get("arrow"));I(()=>N(re,"cursor",o(hi)));var Fs=x(re),Re=x(Fs);{var je=fe=>{var pe=Gc();K(pe,"alt",`Option ${ee+1}`),I(()=>K(pe,"src",o(G).image)),S(fe,pe)};U(Re,fe=>{o(G).image&&fe(je)})}var Bs=F(Re,2);{var mi=fe=>{var pe=Hc(),we=x(pe,!0);C(pe),I(()=>ne(we,o(G).text)),S(fe,pe)};U(Bs,fe=>{o(G).text&&fe(mi)})}C(Fs),C(re),I(()=>Te(re,"image-btn",!!o(G).image)),S(V,re)}),C(ui),C(Q);var Ni=F(Q,2),Ui=x(Ni),zi=F(x(Ui),2);he(zi,20,()=>Array(3),Ls,(V,G,ee)=>{var re=Wc();I(()=>da(re,`strike-dot ${(ee<o(a).strikes?"active":"")??""} svelte-8id4c4`)),S(V,re)}),C(zi),C(Ui),C(Ni),C(O),C(H),I(()=>K(ae,"style",`width: ${i()??""}%; background: ${o(f)??""}; box-shadow: 0 0 10px ${o(f)??""}`)),W(1,H,()=>Oe,()=>({duration:600,start:0,easing:ci})),S(P,H)};U(q,P=>{o(c)==="active"&&P(M)})}C(E),W(3,_,()=>ce,()=>({duration:500})),S(d,E)};U(m,d=>{o(a)&&o(a).isActive&&o(r)&&d(y)})}S(s,p),X()}Ge(["click"]);var Jc=D('<div class="star-container svelte-1w5pxei"><div class="star-core svelte-1w5pxei"></div> <div class="star-rays svelte-1w5pxei"></div> <div class="star-glow svelte-1w5pxei"></div></div>');function Kc(s,e){Y(e,!0);const t=Ee(e,"x",3,50),i=Ee(e,"y",3,50);li(()=>{k!=null&&k.preloaded&&k.play("chime")});var a=Jc();I(()=>K(a,"style",`left: ${t()??""}%; top: ${i()??""}%;`)),W(1,a,()=>Oe,()=>({duration:600,start:0,easing:ci})),W(2,a,()=>ce,()=>({duration:300})),S(s,a),X()}var ed=D('<div class="floating-text svelte-ut1t50">+1 BP</div>'),td=D('<div class="points-badge svelte-ut1t50"><div class="badge-content svelte-ut1t50"><span class="icon svelte-ut1t50">üõ†Ô∏è</span> <span class="count svelte-ut1t50"> </span> <div class="text svelte-ut1t50"><span class="svelte-ut1t50">Builds</span> <small class="svelte-ut1t50">Available</small></div></div> <!></div>'),sd=D('<!> <div class="indicator-container svelte-ut1t50"><div class="timer-section svelte-ut1t50"><div class="label-row svelte-ut1t50"><span class="label svelte-ut1t50">Star Transmit</span> <span class="status-text svelte-ut1t50"> </span></div> <div class="progress-bar-bg svelte-ut1t50"><div class="progress-bar-fill svelte-ut1t50"></div></div></div> <!></div>',1);function id(s,e){Y(e,!0);const t=B(()=>j.get("questionManager")),i=B(()=>j.get("stageManager")),a=B(()=>o(t)?Math.min(100,o(t).gameTimeSinceLastQuestion/ue.questionInterval*100):0),r=B(()=>{var d;return((d=o(t))==null?void 0:d.buildPoints)||0}),l=B(()=>{var d;return(d=o(i))==null?void 0:d.stageResult});let c=0,g=v(!1),T=v(!1),f=v(b({x:50,y:50})),w=v(!1);Ie(()=>{o(t)&&o(a)&&(o(a)>=92&&!o(w)&&!o(t).isActive&&(h(w,!0),h(T,!0),h(f,b({x:15+Math.random()*70,y:15+Math.random()*70}))),o(a)<50&&(h(w,!1),h(T,!1)),o(t).buildPoints>c&&(h(g,!0),setTimeout(()=>h(g,!1),1500)),c=o(t).buildPoints)});var p=ve(),m=se(p);{var y=d=>{var E=sd(),_=se(E);{var A=Q=>{Kc(Q,{get x(){return o(f).x},get y(){return o(f).y}})};U(_,Q=>{o(T)&&Q(A)})}var L=F(_,2),q=x(L),M=x(q),P=F(x(M),2),H=x(P);I(()=>ne(H,`${Math.floor(o(a))??""}%`)),C(P),C(M);var O=F(M,2),Z=x(O);C(O),C(q);var z=F(q,2);{var ae=Q=>{var ie=td(),_e=x(ie),Ae=F(x(_e),2),Se=x(Ae,!0);C(Ae),Ii(2),C(_e);var Le=F(_e,2);{var Me=xe=>{var di=ed();S(xe,di)};U(Le,xe=>{o(g)&&xe(Me)})}C(ie),I(()=>{Te(ie,"has-points",o(r)>0),ne(Se,o(r))}),W(1,ie,()=>Oe,()=>({duration:300,start:.5,opacity:0})),W(2,ie,()=>Oe,()=>({duration:200,start:.8,opacity:0})),S(Q,ie)};U(z,Q=>{o(r)>0&&Q(ae)})}C(L),I(()=>K(Z,"style",`width: ${o(a)??""}%`)),S(d,E)};U(m,d=>{o(t)&&!o(t).isActive&&!o(l)&&d(y)})}S(s,p),X()}var od=D("<div><!> <!></div>");function ad(s,e){Y(e,!0);let t=v(0),i=0,a=-1;Ie(()=>{const c=j.get("questionManager");c&&c.wrongAnswerTrigger!==a&&(a!==-1&&Pi(t),a=c.wrongAnswerTrigger);const g=j.get("entityManager");g&&g.throne});var r=ve(),l=se(r);_i(l,()=>o(t),c=>{var g=od(),T=x(g);rr(T,e,"default",{});var f=F(T,2);_i(f,()=>i,w=>{var p=ve(),m=se(p);U(m,y=>{}),S(w,p)}),C(g),I(()=>da(g,`feedback-layer ${(o(t)>0?"shake-effect":"")??""} svelte-10dqr7b`)),S(c,g)}),S(s,r),X()}const rd=["/projectiles/Click/0.svg","/projectiles/Click/1.svg","/projectiles/Click/2.svg","/projectiles/Click/3.svg","/projectiles/Fireball/Die/0.svg","/projectiles/Fireball/Die/1.svg","/projectiles/Fireball/Die/2.svg","/projectiles/Fireball/Follow/0.svg","/projectiles/Fireball/Follow/1.svg","/projectiles/Fireball/Follow/2.svg","/projectiles/Fireball/Follow/3.svg","/projectiles/Icebolt/Die/0.svg","/projectiles/Icebolt/Die/1.svg","/projectiles/Icebolt/Die/2.svg","/projectiles/Icebolt/Follow/0.svg","/projectiles/Icebolt/Follow/1.svg","/projectiles/Poisonball/Die/0.svg","/projectiles/Poisonball/Die/1.svg","/projectiles/Poisonball/Die/2.svg","/projectiles/Poisonball/Follow/0.svg","/projectiles/Poisonball/Follow/1.svg","/projectiles/Poisonball/Follow/2.svg","/projectiles/Poisonball/Follow/3.svg","/projectiles/Thunderbolt/Die/0.svg","/projectiles/Thunderbolt/Die/1.svg","/projectiles/Thunderbolt/Die/2.svg","/projectiles/Thunderbolt/Follow/0.svg","/projectiles/Thunderbolt/Follow/1.svg","/projectiles/Thunderbolt/Follow/2.svg","/projectiles/Thunderbolt/Follow/3.svg","/enemies/BlueCommon/Follow/0.svg","/enemies/BlueCommon/Follow/1.svg","/enemies/BlueCommon/Follow/2.svg","/enemies/BlueCommon/Die/0.svg","/enemies/BlueCommon/Die/1.svg","/enemies/BlueCommon/Die/2.svg","/enemies/BlueCommon/Follow/0.svg","/enemies/BlueCommon/Follow/1.svg","/enemies/BlueCommon/Follow/2.svg","/enemies/BlueCommon/Die/0.svg","/enemies/BlueCommon/Die/1.svg","/enemies/BlueCommon/Die/2.svg","/towers/FireTower/Base0.svg","/towers/FireTower/Base1.svg","/towers/FireTower/Base2.svg","/towers/FireTower/Upgrade1.svg","/towers/FireTower/Upgrade2.svg","/towers/IceTower/Base0.svg","/towers/IceTower/Base1.svg","/towers/IceTower/Base2.svg","/towers/IceTower/Upgrade1.svg","/towers/IceTower/Upgrade2.svg","/towers/PoisonTower/Base0.svg","/towers/PoisonTower/Base1.svg","/towers/PoisonTower/Base2.svg","/towers/PoisonTower/Upgrade1.svg","/towers/PoisonTower/Upgrade2.svg","/towers/ThunderTower/Base0.svg","/towers/ThunderTower/Base1.svg","/towers/ThunderTower/Base2.svg","/towers/ThunderTower/Upgrade1.svg","/towers/ThunderTower/Upgrade2.svg","/towers/Base.svg","/towers/Upgrade0.svg","/castle/castle.png","/castle/castle-broken.png","/castle/castle-broken2.png","/castle/castle-broken3.png","/castle/castle-destroyed.png","/logos/knowledge-space2.png","/cursors/cursor-hammer.svg","/cursors/cursor-arrow.svg","/cursors/build0.svg","/cursors/build1.svg","/cursors/build2.svg"].map(J),nd=s=>{be.spendLoot({type:"click",payload:{offset:new le(s.clientX,s.clientY)}})},ld=(s,e)=>{var t;k.play("clickMenu",!0),(t=o(e))==null||t.pause()};var cd=D('<link rel="preload" as="image">'),dd=D('<div class="window-wrapper"><div class="wrapper svelte-dz30ag"><!> <!> <!> <button tabindex="-1" class="btn-pause svelte-dz30ag"><!></button> <div class="game-container svelte-dz30ag"><!></div></div></div>'),ud=D("<!> <!> <!>",1);function bd(s,e){Y(e,!0);const t=B(()=>de.isStarted?j.get("questionManager"):void 0),i=B(()=>de.isStarted?j.get("gameLoop"):void 0),a=B(()=>de.isStarted?j.get("stageManager"):void 0),r=m=>{var y,d;m.key==="Escape"&&((y=o(i))!=null&&y.pauseState?o(i).resume():(d=o(i))==null||d.pause())};li(()=>{k.preload()});var l=ud();Qe("keydown",Za,r),tr(m=>{var y=ve(),d=se(y);he(d,17,()=>rd,Ls,(E,_)=>{var A=cd();I(()=>K(A,"href",o(_))),S(E,A)}),S(m,y)});var c=se(l);{var g=m=>{kl(m,{onStart:()=>de.start()})},T=m=>{var y=ve(),d=se(y);{var E=A=>{xl(A,{onRestart:()=>de.restart()})},_=A=>{var L=ve(),q=se(L);{var M=P=>{Tc(P,{onResume:()=>{var H;return(H=o(i))==null?void 0:H.resume()},onRestart:()=>de.restart()})};U(q,P=>{var H;(H=o(i))!=null&&H.pauseState&&P(M)},!0)}S(A,L)};U(d,A=>{o(a).stageResult?A(E):A(_,!1)},!0)}S(m,y)};U(c,m=>{de.isStarted?m(T,!1):m(g)})}var f=F(c,2);{var w=m=>{var y=dd();y.__click=[nd];const d=B(()=>te.get("arrow"));I(()=>N(y,"cursor",o(d)));var E=x(y),_=x(E);{var A=z=>{Mc(z,{get stageNumber(){return o(a).stageNumber}})};U(_,z=>{o(a)&&z(A)})}var L=F(_,2);Dc(L,{});var q=F(L,2);id(q,{});var M=F(q,2);M.__click=[ld,i];const P=B(()=>te.get("arrow"));I(()=>N(M,"cursor",o(P)));var H=x(M);Ic(H),C(M);var O=F(M,2);N(O,"transform-origin","center");var Z=x(O);ad(Z,{children:(z,ae)=>{wl(z,{})},$$slots:{default:!0}}),C(O),C(E),C(y),I(()=>{var z;return Te(E,"bullet-time",(z=o(t))==null?void 0:z.isActive)}),Ki(O,"offsetHeight",z=>R.gameAreaHeight=z),Ki(O,"offsetWidth",z=>R.gameAreaWidth=z),S(m,y)};U(f,m=>{de.isStarted&&k.preloaded&&m(w)})}var p=F(f,2);Zc(p,{}),eo("innerWidth",m=>R.width=m),eo("innerHeight",m=>R.height=m),S(s,l),X()}Ge(["click"]);export{bd as component};
